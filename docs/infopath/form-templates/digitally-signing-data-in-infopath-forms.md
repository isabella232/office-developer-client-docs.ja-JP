---
title: InfoPath フォームのデータにデジタル署名する
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7b396d9f-9a47-3170-367f-5d1f0144f927
description: デジタル署名は、マクロまたはドキュメント上にあり、電子的で暗号化ベースの、セキュリティで保護された認証のスタンプです。有効なデジタル署名では、そのデータが署名者からのものであり、署名されてから変更されていないことを確認できます。ドキュメントまたはドキュメント内の特定のデータに署名すると、署名が計算されてドキュメントに追加されます。このようにして、署名は常に署名済みデータと共に移動します。
ms.openlocfilehash: dc839d0751d2e7aeb6f9eaccc3a86ce95e5228e2
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799094"
---
# <a name="digitally-signing-data-in-infopath-forms"></a>InfoPath フォームのデータにデジタル署名する

デジタル署名は、マクロまたはドキュメント上にあり、電子的で暗号化ベースの、セキュリティで保護された認証のスタンプです。有効なデジタル署名では、そのデータが署名者からのものであり、署名されてから変更されていないことを確認できます。ドキュメントまたはドキュメント内の特定のデータに署名すると、署名が計算されてドキュメントに追加されます。このようにして、署名は常に署名済みデータと共に移動します。
  
データに署名するには、ユーザーは証明機関に証明書を要求し、その証明書を使用してデジタル署名を作成する必要があります。証明機関は証明書の有効期間と、データの暗号化と署名の作成に必要なキー (公開キーまたは秘密キー) を管理します。
  
それ以降にドキュメントを使用するユーザーは、既存の署名を検証する必要があり、検証の結果に応じて、ドキュメントを編集して署名することができます。正しい検証結果を得るには、検証者は、ドキュメントの元の署名に使用された証明書を発行した証明機関を信頼する必要があります。
  
XML デジタル署名は、XML ドキュメントおよびデータが関連するトランザクション用に設計されています。XML 署名の威力は、XML ドキュメントの特定のデータのみに署名できる機能にあります。
  
## <a name="types-of-digital-signatures-in-infopath-forms"></a>InfoPath フォームのデジタル署名の種類

Microsoft InfoPath は、デジタル署名を実装して、InfoPath フォームのデータをセキュリティで保護します。InfoPath に用意されているデジタル署名は次の 2 種類です。
  
- フォーム テンプレート (.xsn ファイル) のデータの整合性と信頼性を確実にするデジタル署名
    
- XML フォームのデータに関連する整合性、信頼性、および否認防止のサポートを確実にするデジタル署名
    
署名の最初のカテゴリは、フォーム テンプレート (.xsn ファイル) が対象であり、2 番目のカテゴリは、InfoPath フォーム ファイル (.xml ファイル) で実際にユーザーが入力したデータが対象です。ここでは、フォーム デザイナーはユーザーがフォーム全体またはフォームの一部のみに対してデジタル署名を作成するようにできます。署名されたテンプレートと署名されたフォームには基本的な違いがあります。このドキュメントでは、署名されたテンプレートについて (完全に信頼できるものとして実行されるフォームを作成するための別の方法として) いくらか説明しますが、この種類の署名の詳細については説明しません。フォーム テンプレートの署名方法の詳細については、「[署名済み InfoPath フォーム テンプレートを展開する](deploying-signed-infopath-form-templates.md)」を参照してください。このトピックでは、署名された InfoPath XML フォームの使用について主に説明します。XML フォームのデータに署名するために InfoPath で作成されるデジタル署名は、W3C の XML デジタル署名の仕様に準拠しています。 
  
## <a name="digital-signatures-features"></a>デジタル署名の機能

InfoPath では、拡張デジタル署名機能が用意されていて、テンプレート開発者はフォーム全体またはフォームの特定のデータに対してデジタル署名を有効にする、柔軟性のあるフォームをデザインできます。フォーム全体にデジタル署名すると、常にフォームに対する連署がエンティティとして作成され、InfoPath フォームの一部に署名すると、データの同じセットに追加された署名の関係の種類 (副署名、連署、または 1 つの署名のみを許可) を選択する柔軟性が得られます。
  
InfoPath では、署名により、ユーザーが現在のビューで表示したデータを確認するための否認防止情報が既定で追加されると共に、署名が作成されたときに設定された時間およびその他の環境設定が追加されます。否認防止情報はカスタマイズできますが、否認防止のダイアログ ボックスには、否認防止の既定のノードのデータのみが表示されます。
  
署名を追加するには、ユーザーは署名するデータのセットを選択する必要があります。署名できるデータのセットはフォーム テンプレート デザイナーによって定義され、フォームの入力時にデータに署名するために使用されます。ユーザーは、署名ごとに、デジタル署名ウィザードに従って、署名可能なデータのセットの選択、証明書の選択、コメントの追加、およびフォームへの署名の承認とコミットを行う必要があります。
  
ユーザーが、署名済みデータを含むコントロールの上にマウス ポインターを移動すると、そのデータが署名済みで変更できないことが視覚的に示されます。フォーム テンプレート デザイナーは、署名済みデータが含まれている状態で署名がビューに表示されるようにすることで、ユーザーが否認防止情報に簡単にアクセスできるようにすることができます。
  
## <a name="programmatic-support-for-digital-signatures"></a>デジタル署名のプログラム的なサポート

InfoPath オブジェクト モデルにはデジタル署名のサポートが含まれています。これにより、開発者は、[SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) クラスを通じて、フォームに定義されている署名可能なデータのセットにプログラム的にアクセスし、 [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) クラスを通じて、署名済みデータの各セットに割り当てられている署名にプログラム的にアクセスし、 [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) クラスを通じて、署名を作成するために使用されている証明書にプログラム的にアクセスできます。さらに、 [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) イベント ハンドラーは完全に信頼できるフォームでカスタマイズ可能であり、InfoPath フォームのデジタル署名の高度な処理のサポートが提供されます。 
  
## <a name="interoperability"></a>相互運用性

InfoPath のデジタル署名のインフラストラクチャは、MSXML5 のデジタル署名のサポートを使用して設計されているため、InfoPath デジタル署名は、MSXML5 デジタル署名と完全な相互運用性があります。
  
署名された InfoPath フォームおよび InfoPath で作成されたデジタル署名は、Microsoft .NET Framework (バージョン 1.1 から始まる) を使用して作成されたデジタル署名とも完全な相互運用性があります。InfoPath で作成されたデジタル署名は, .NET Framework 署名の検証クラスを使用するアプリケーションによって検証できます。.NET Framework デジタル署名のクラスを使用して設計されたアプリケーションによって InfoPath フォームでホストされたデータ用に作成された署名は、InfoPath のデジタル署名メカニズムで正しく検証されます。
  
## <a name="see-also"></a>関連項目



[デジタル署名を使用します。](how-to-work-with-digital-signatures.md)

