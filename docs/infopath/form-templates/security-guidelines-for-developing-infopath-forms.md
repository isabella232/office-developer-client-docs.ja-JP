---
title: InfoPath フォーム開発のためのセキュリティ ガイドライン
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 4690028e-20ac-297b-4651-801f5159c747
description: このトピックを読む前に、「InfoPath フォームの追加のセキュリティ概念」を参照し、InfoPath のセキュリティ モデルの概要を理解しておいてください。
ms.openlocfilehash: 3a72421882e655f34abd1eda30fe7e4fb42c45c0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799228"
---
# <a name="security-guidelines-for-developing-infopath-forms"></a>InfoPath フォーム開発のためのセキュリティ ガイドライン

このトピックを読む前に、「[InfoPath フォームの追加のセキュリティ概念](additional-infopath-form-security-concepts.md)」を参照し、InfoPath のセキュリティ モデルの概要を理解しておいてください。 
  
## <a name="security-issues-for-users-of-infopath-forms"></a>InfoPath フォームのユーザーにとってのセキュリティ問題

Microsoft InfoPath のユーザーにとっての主要なセキュリティ問題は、Internet Explorer で実行している Web アプリケーションのセキュリティ問題に似ています。ただし、フォームに適用されるセキュリティ レベルは、フォーム テンプレートの場所にのみ依存し、作成された XML ドキュメントをユーザーが格納する場所や開く場所には依存しないことに注意してください。ユーザーは InfoPath のステータス バーを見て、現在作業中のフォーム テンプレートの場所を確認できます。
  
InfoPath には、悪意を持って作成されたフォーム テンプレートがもたらす次のような潜在的な脅威からユーザーを保護するしくみがあります。
  
- ローカル コンピューターまたはリモート データ ソースから機密情報が漏えいする可能性
    
- ActiveX コントロールの悪用
    
- InfoPath オブジェクト モデルのプロパティとメソッドの悪用
    
## <a name="disclosure-of-sensitive-information"></a>機密情報の漏えい

機密情報の漏えいの最も一般的なシナリオとしては、悪意のあるフォーム作成者が、現在のユーザーのセキュリティ資格情報を使用するフォームを作成し、フォーム自体が展開されているドメイン以外のドメイン上にあるデータ ソースにアクセスするケースが考えられます。 たとえば、悪意のあるユーザーは、フォームを電子メールで送信するか、プライベート共有または Web サーバー上のフォームへの URL を使用して送信します。 このフォームには、現在のユーザーの資格情報を使用してデータ アクセス要求を実行するスクリプトが含まれており、このスクリプトは、給与のデータベースやその他の機密情報など、悪意のあるユーザーが本来アクセスできない別のドメイン上にあるデータ ソースからデータを取得します。 この種のセキュリティ リスクのシナリオは、"ドメイン間のデータ アクセス" と呼ばれます。
  
InfoPath の基盤になっている Internet Explorer のセキュリティ モデルには、[ **ドメイン間でのデータ ソースのアクセス**] という設定が用意されています。既定では、[ **インターネット**] および [ **制限付きサイト**] セキュリティ ゾーンにある InfoPath フォームのドメイン間アクセスは無効になっています。[ **ローカル イントラネット**] セキュリティ ゾーンにある InfoPath フォームのドメイン間アクセスでは、有効にするか無効にするかユーザーに確認を求めるメッセージが表示されます。[ **信頼済みサイト**] または [ **ローカル コンピューター**] ゾーンにある InfoPath フォームでは、ドメイン間アクセスは有効になっています。 
  
## <a name="malicious-use-of-activex-controls"></a>ActiveX コントロールの悪用

ActiveX コントロールの悪用の最も一般的なシナリオとしては、悪意のあるフォーム作成者が、ファイル システムにアクセスする ActiveX コントロールを操作するコードを記述して、個人ファイルやパスワード リストを取得したり、ファイルを削除したり、ユーザーのシステムを使用不能にするというケースが考えられます。InfoPath フォームは、ビジネス ロジックから、または作業ウィンドウ内のスクリプトからしか ActiveX コントロールを操作するコードを実行できません。InfoPath のビュー内のスクリプトから ActiveX コントロールを実行することはできません。
  
InfoPath の基盤になっている Internet Explorer のセキュリティ モデルには、[ **スクリプトを実行しても安全だとマークされていない ActiveX コントロールの初期化とスクリプトの実行**] という設定が用意されています。既定では、[ **ローカル イントラネット**]、[ **インターネット**]、および [ **制限付きサイト**] セキュリティ ゾーンにある InfoPath フォームの場合には、安全だとマークされていない ActiveX コントロールの初期化とスクリプトの実行は無効です。[ **信頼済みサイト**] または [ **ローカル コンピューター**] セキュリティ ゾーンにある InfoPath フォームの場合には、安全だとマークされていない ActiveX コントロールのスクリプトを実行するかどうかを確認するメッセージが表示されます。完全信頼済み InfoPath フォームの場合には、安全だとマークされていない ActiveX コントロールのスクリプトは実行されます。 
  
さらに、現在のセキュリティ ゾーンやフォームの信頼レベルに関わらず、デザイン モードで、初期化およびスクリプトを実行しても安全だとマークされていない ActiveX コントロールを [コントロール] 作業ウィンドウに挿入できません。
  
## <a name="malicious-use-of-infopath-object-model-code"></a>InfoPath オブジェクト モデル コードの悪用

同様に、コードから呼び出される InfoPath のメソッドとプロパティも、さまざまなレベルのリスクをもたらします。たとえば、[SaveAs(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) クラスの [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) メソッドを使用すると、ファイル システム内の任意の場所にデータを書き込むことができます。これらのオブジェクト モデルのメンバーの悪用を防ぐために、InfoPath オブジェクト モデルには、特定のオブジェクト モデルのメンバーを使用できる方法と場所を規定する 3 つのレベルのセキュリティが実装されています。この機能の詳細については、「 [コードを含むフォーム テンプレートのセキュリティ モデルについて](about-the-security-model-for-form-templates-with-code.md)」を参照してください。
  
## <a name="best-practices-for-developers-of-infopath-forms"></a>InfoPath フォームの開発者のためのベスト プラクティス

InfoPath フォームを作成する開発者は、セキュリティに関する次のベスト プラクティスの実装方法を知っておく必要があります。
  
- フォームに関連付けられた XML ファイルの潜在的なセキュリティ問題の認識方法
    
- フォームのユーザーを混乱させたり迷惑となるようなエラー メッセージを表示しないようにする方法
    
- ActiveX コントロールの CAB ファイルに署名する方法。
    
- 電子メール メッセージの添付ファイルとして送信されるフォーム テンプレートに署名する方法。
    
## <a name="best-practices-for-xml-data-associated-with-a-form"></a>フォームに関連付けられている XML データのベスト プラクティス

InfoPath フォームには、ユーザーが必ずしも信頼または管理していないソースを含む、あらゆるソースからの XML データを取り込むことができることに注意してください。 たとえば InfoPath では、Web ページへのリンクや、ユーザーに電子メールで送られた XML の添付ファイルから XML データを取得できます。 このようなリスクを軽減するには、次のベスト プラクティスを参照してください。
  
- XML から読み込んだ信頼されていないデータを Microsoft JScript の **eval()** 関数や作業ウィンドウの **innerHTML** プロパティに渡さないようにします。どちらの呼び出しも、悪意のあるスクリプトの実行に利用される可能性があります。作業ウィンドウでは、代わりに **innerText** プロパティを使用します。InfoPath のビューではスクリプトを実行できないことに注意してください。 
    
- XML ファイルからデータベースに送信されたデータが送信前に検証されていない場合は、データベースにセキュリティ リスクが生じる可能性があります。
    
データ ソースに送信する前に検証されていないデータは、データ ソースのデータの整合性を損なう可能性があり、極端な場合はバッファー オーバーランを引き起こす原因になります。また、信頼されていないデータをサーバーで直接使用しようとすると、スクリプトの挿入や SQL の挿入を招く可能性もあります。
  
## <a name="best-practices-to-avoid-presenting-confusing-error-messages"></a>混乱を招くエラー メッセージを表示しないためのベスト プラクティス

 **フォームとデータ ソースを同じドメインに展開する**
  
ドメイン間のデータ アクセスのセキュリティ リスクを明確に理解しているユーザーはほとんどいません。ドメイン間のデータ アクセスを許可することについてユーザーに継続的に警告を発して確認を求めるフォームを展開すると、多くのユーザーはセキュリティ リスクを真剣に考えずに、すべてのドメイン間のアクセス要求を許可したり、要求元のドメインを [ **信頼済みサイト**] のリストに加えたりする習慣を身に付けてしまいます。このような状況を避けるには、InfoPath フォームを、フォームが依存するすべてのデータ ソースと同じサーバーに展開します。 
  
 **スクリプトを実行しても安全だとマークされていない ActiveX コントロールの使用を避ける**
  
ActiveX コントロールは、コンピューターのファイル システムにアクセスするメソッドなど、ユーザーのシステムを侵害するために利用される可能性のあるプロパティとメソッドを公開する危険があります。可能な限り、スクリプトを実行しても安全だとマークされた ActiveX コントロールのみを使用するようにします。これらのコントロールは、メソッドとプロパティが Web ページのスクリプトによってどのように操作されようと、ユーザーのシステムを破壊したりユーザーのセキュリティを侵害したりしないことがテストによって確認されています。同様に、InfoPath で使用する ActiveX コントロールを作成する場合にも、厳密にコードを検査し、ActiveX コントロールをテストしてから、スクリプトを実行しても安全だとマークするようにします。
  
InfoPath では Internet Explorer のセキュリティ ゾーンをベースにしたセキュリティ モデルを使用しているため、InfoPath フォームは Internet Explorer と同じアクセス許可を使用します。既定では、スクリプトを実行しても安全だとマークされた ActiveX コントロールへのスクリプト呼び出しは、ユーザーに確認を求めることなく有効になります。
  
## <a name="best-practices-for-managing-the-cab-files-of-activex-controls"></a>ActiveX コントロールの CAB ファイルを管理するためのベスト プラクティス

ActiveX コントロールは、InfoPath エディター用にデザインされたフォーム テンプレートでホストできます。まだユーザーのコンピューターに存在していない ActiveX コントロールの CAB ファイルを、フォーム テンプレート (.xsn) ファイルに含める必要があります。フォーム テンプレートに含まれた CAB ファイルは、インストールできるようにするためにデジタル署名されている必要があります。InfoPath は、信頼レベルやセキュリティ ゾーンがどうであれ、署名されていない CAB ファイルをインストールしません。
  
CAB ファイルのデジタル署名を検証できるようにするために、ファイルは、信頼済みの証明書ルートへの信頼チェーンのある証明書を使用して署名する必要があります。それ以外の場合は、署名は認証できず、署名の検証に失敗し、CAB ファイルはインストールされません。
  
## <a name="best-practices-for-form-templates-sent-as-an-attachment-to-an-email-message"></a>電子メール メッセージの添付ファイルとして送信されるフォーム テンプレートのベスト プラクティス

InfoPath では、電子メール メッセージの添付ファイルとしてフォーム テンプレートを展開でき、フォーム テンプレートをある場所から別の場所に移動できます。 デザインしたフォーム テンプレートを電子メール メッセージの添付ファイルとして展開する場合は、セキュリティを強化するために、そのフォーム テンプレートにデジタル署名するようにします。 電子メール メッセージで展開されたフォーム テンプレートのデジタル署名は、単にテンプレートの信頼性を確かなものにするだけではありません。 フォーム テンプレーの自動更新を有効にできるというメリットもあります。
  
フォーム テンプレートは、信頼済みの証明書ルートへの信頼チェーンのある証明書を使用して署名する必要があります。こうした証明書を使用して署名していない場合、署名が認証できないので、署名の検証に失敗します。
  
> [!NOTE]
> 署名されたフォーム テンプレートがドメインへのアクセスや制限付きのアクセスを要求すると、自動的にテンプレートを更新できるかどうかを判断する場合を除いて、InfoPath は署名のチェックや検証を行いません。 
  
電子メールによる展開の詳細については、「[セキュリティ レベル、電子メール配信、リモート フォーム テンプレート](security-levels-email-deployment-and-remote-form-templates.md)」を参照してください。
  

