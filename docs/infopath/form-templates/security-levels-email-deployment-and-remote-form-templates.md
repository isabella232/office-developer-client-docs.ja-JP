---
title: セキュリティ レベル、メール展開、リモート フォーム テンプレート
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.localizationpriority: medium
ms.assetid: 7fc438ad-ae26-3632-3444-371537eaecb3
description: Microsoft InfoPath では、フォーム テンプレートをある場所から別の場所に移動し、添付ファイルとして電子メール メッセージに送信し、デジタル署名またはインストールされた完全信頼フォーム テンプレートを作成できます。
ms.openlocfilehash: 3980563547796ff22942fba7177e051221535199
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59614599"
---
# <a name="security-levels-email-deployment-and-remote-form-templates"></a>セキュリティ レベル、メール展開、リモート フォーム テンプレート

Microsoft InfoPath では、フォーム テンプレートをある場所から別の場所に移動し、添付ファイルとして電子メール メッセージに送信し、デジタル署名またはインストールされた完全信頼フォーム テンプレートを作成できます。
  
## <a name="security-levels"></a>セキュリティ レベル

フォーム テンプレートには、フォームの場所に応じて、3 つのセキュリティ レベルのいずれかが適用されます。以降では、これらの 3 つのセキュリティ レベルについて説明します。 
  
### <a name="restricted"></a>Restricted

制限ありのセキュリティ レベルでは、フォーム テンプレートの外部との通信はできません。このセキュリティ レベルは、有害なフォームによって、コンピューターから悪意を持ったユーザーにデータが送信される事態を防ぐことを狙いとしています。このセキュリティ モードでの実行中は、次の機能は正しく動作しません。
  
- HTML 作業ウィンドウ  
- SharePoint クエリ
- SharePoint への送信
- XML ファイル クエリ
- データベース クエリ
- データベースへの送信
- Web サービス クエリ
- Web サービスへの送信
- カスタム コードによる送信
- ホスティング環境への送信
- ActiveX コントロール
- ロール
- SharePoint ワークフロー
- 新規ドキュメントを開く操作に関する規則
- マネージ コード
- 外部の印刷表示
- リンクされた画像
    
### <a name="domain"></a>ドメイン

ドメインのセキュリティ レベルでは、フォームが特定のインターネット ドメインに限定され、フォームからのアクセス先は、そのドメインが位置するゾーンに対する Internet Explorer の設定によって制限されます。フォームは所定のドメイン内の他のデータ ソースとは通信できますが、通常、ゾーンでドメイン間通信が有効になっていない限り、他のドメインからデータを受信することはできません。このレベルは、ブラウザー互換のフォーム テンプレートに適用できる一番低いセキュリティ レベルです。
  
### <a name="full-trust"></a>完全信頼

完全信頼のセキュリティ レベルでは、フォームが実際に使用されるコンピューター上で、フォームを完全に信頼して実行できます。このセキュリティ レベルは、クライアント コンピューターに格納されている信頼されたルート発行元に一致する署名が付いているフォームをサーバー上で操作する場合か、フォームをクライアント コンピューターにインストールする場合に限り使用できます。どちらの場合も、 **requireFullTrust** 属性を "yes" に設定する必要があります。この値を設定すると、フォームからオブジェクト モデルの呼び出し (ファイルの保存など) が可能になり、これよりも制限が厳しいセキュリティ レベルでの実行時に表示される特定のセキュリティ関連ダイアログ ボックスが表示されなくなります。 
  
> [!NOTE]
> [!メモ] InfoPath のデザイン モードで生成したフォームには必ずセキュリティ レベルが関連付けられます。InfoPath では、フォームは関連付けられているセキュリティ レベルで開きます。フォームに関連付けられているセキュリティ レベルが、そのフォームに実際に適用可能なセキュリティ レベルよりも高い場合、そのフォームは開きません。 
  
完全信頼のセキュリティ レベルは、インストールされているフォーム テンプレートまたは署名済みのフォーム テンプレートにのみ設定できます。それ以外のテンプレートの場合、適用できる信頼レベルは最高でドメイン レベルになります。完全信頼のセキュリティ レベルが自動的に設定されることはありません。
  
開いたフォームには、そのフォームが保存されている場所に応じて、セキュリティ レベルが割り当てられます。
  
## <a name="trust-levels"></a>信頼レベル

フォーム テンプレートに割り当てることのできる信頼レベルの上限は、次の表で示すように、[開かれたフォーム] の場所とその他の確認コードに基づいて決まります。 表にリストされている属性 (HTTP、UNC、requireFullTrustなど) は、フォームに付与できる信頼レベルを決定し、InfoPath クライアントで開いたフォームに適用するエントリです。 
  
|割り当て可能な最高の信頼レベル|完全信頼|クライアント コンピューター (サンドボックス内)|イントラネット (サンドボックス内)|インターネット (サンドボックス内)|Restricted|
|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|
|**ファイル: アクセス パス=開かれたフォームの場所** <br/> |||X  <br/> |||
|**ファイル: アクセス パス\<\>開かれたフォームの場所、またはアクセス パス未指定 (フォームの保存場所は不問)** <br/> |||||X  <br/> |
|**開かれたフォームの場所: イントラネット HTTP または HTTPS** <br/> |||X  <br/> |||
|**開かれたフォームの場所: インターネット HTTP または HTTPS** <br/> ||||X  <br/> ||
|**開かれたフォームの場所: UNC** <br/> |||X  <br/> |||
|**インストールされているテンプレート (requireFullTrust="yes")** <br/> |X  <br/> |||||
|**インストールされているテンプレート (requireFullTrust="no")** <br/> ||X  <br/> ||||
|**信頼された発行元の証明書で署名済みのテンプレート** <br/> |X  <br/> |||||
|**エクスポートしたフォーム ファイル** <br/> |||X  <br/> |||
   
## <a name="form-open-behavior"></a>フォームを開く動作

InfoPath エディターでフォーム ファイルを開く際には、一連の条件に従って、そのフォームを開くときに適用するセキュリティ レベルと、フォームを開くかどうかが判定されます。InfoPath フォームをエディターで開いた場合、フォームは適切なセキュリティ レベルで開くか、または読み込まれないかのどちらかになります。フォームが適用可能なレベルよりも高いセキュリティ レベルを要求している場合 (フォームは **trustLevel** 属性または **requireFullTrust** 属性を使用して特定のセキュリティ レベルを要求できます)、そのフォームの読み込みは許可されません。要求レベルが妥当な場合は、要求したセキュリティ レベルでフォームが読み込まれます。フォーム テンプレートが要求したセキュリティ レベルで開くことを許可されない場合、ユーザー側でフォームを開くことができず、エラー メッセージが表示されます。 
  
次の表は、各セキュリティ レベルでフォームを開くために必要な条件と、ユーザーがフォームを開こうとした場合に起こる動作を示しています。
  
|エディターが開くかどうか|完全信頼 (requireFullTrust="yes")|ドメイン信頼 (trustLevel="Domain" または空白)|制限あり (trustLevel="Restricted")|
|:-----|:-----|:-----|:-----|
|**信頼済み (インストール済みまたは信頼された証明書で署名済み)** <br/> |完全信頼レベルで開く  <br/> |該当なし  <br/> |該当なし  <br/> |
|**ドメイン信頼: クライアント コンピューター** <br/> |開けない  <br/> |ドメイン レベルで開く  <br/> |制限ありレベルで開く  <br/> |
|**ドメイン信頼: イントラネット** <br/> |開けない  <br/> |ドメイン レベルで開く  <br/> |制限ありレベルで開く  <br/> |
|**ドメイン信頼: インターネット** <br/> |開けない  <br/> |ドメイン レベルで開く  <br/> |制限ありレベルで開く  <br/> |
|**制限あり** <br/> |開けない  <br/> |開けない  <br/> |制限ありレベルで開く  <br/> |
   
## <a name="specifying-a-security-level"></a>セキュリティ レベルの指定

InfoPath のフォーム デザイン ウィンドウでは、フォームで使用されている機能に基づいて適切なセキュリティ レベル (制限ありまたはドメイン) が自動的に選択されます。選択されるセキュリティ設定は、ユーザーとデータを確実に保護できるように、まず制限ありレベルから検討され、可能な限り制限の強い設定になります。自動選択された設定は、次の手順に従って手動で上書きし、フォームにより適したセキュリティ レベルを選択できます。
  
1. [ **ファイル**] タブをクリックし、[ **情報**] タブの [ **フォームのオプション**] をクリックします。 
    
2. [ **カテゴリ**] ボックスの一覧で [ **セキュリティと信頼**] をクリックします。
    
3. [ **自動的にセキュリティ レベルを設定する (推奨)**] チェック ボックスをオフにします。 
    
4. 必要なセキュリティ レベルを選択します。
    
## <a name="mail-deployment-and-browser-enabled-form-templates"></a>メールの展開とブラウザーが有効なフォーム テンプレート

InfoPath を使用すると、フォーム テンプレートを添付ファイルとして電子メール メッセージに送信し、ある場所から別の場所に移動できます。 社内用のフォームを配布する場合や、リモート ユーザーにフォームを配布する場合は、メールによる配信が簡単で効率的です。
  
また、InfoPath Forms Services を搭載した Microsoft SharePoint Server 2010 が実装されている場合は、ユーザーが InfoPath をコンピューターにインストールしていなくても Web ブラウザーでフォームに記入できるようなフォーム テンプレートを作成できます。
  
## <a name="understanding-form-identity"></a>フォーム ID について

InfoPath のデザイン モードで作成するフォームには ID が割り当てられます。InfoPath では、この ID 情報に基づいて、フォームをキャッシュ内のフォーム テンプレートに関連付け、フォームの更新情報が共有の場所に公開された場合に更新データを取得できます。既定の設定では、InfoPath のフォーム テンプレートにはフォーム ID とアクセス パスの 2 種類の ID が作成されます。 
  
### <a name="form-id"></a>フォーム ID

フォーム ID は、プレフィックス、フォーム名、フォームの名前空間に基づいた一意の識別子です。この ID は、フォーム ファイルをクライアント コンピューターのキャッシュ内にある関連フォーム テンプレートに正しく対応付けられるように、一意の名前であることが必要です。フォーム ID は、フォーム定義ファイル (.xsf) で name 属性で指定されます (例:  `name="urn:MyForm:MyCompany:Template1:myXSD-1583-78-G3V94-23-47"`)。 
  
### <a name="access-path"></a>アクセス パス

アクセス パスは、フォーム テンプレートの正しい場所や更新データの受信場所の判断材料となる、場所の識別子です。フォーム テンプレートの保存時または発行時に、保存先または発行先が既定のアクセス パスになります。フォームがクライアント コンピューター上で開かれるたびに、そのフォームと、キャッシュに保存されているフォーム テンプレートとの関連付けが行われます。この関連付け処理は、次の順序で進められます。
  
1. フォーム ID が一致する完全信頼のフォーム テンプレートが検索されます。
    
2. アクセス パスが一致するフォーム テンプレートがキャッシュ内で検索されます。
    
3. フォーム ID が一致するフォーム テンプレートがキャッシュ内で検索されます。
    
一致するテンプレートが見つかると、その関連フォーム テンプレートを使用してフォームが開きます。アクセス パスが一致した場合は、そのアクセス パスを使用してフォーム テンプレートの更新データが取得されます。この方法により、フォームの社内管理、メンテナンス、更新処理を効率化できます。一致するテンプレートが見つからなかった場合、信頼レベルがドメイン レベルのときは、フォームは開きません。アクセス パスは、フォーム定義ファイル (.xsf) で **publishUrl** 属性で指定されます。 
  
各フォーム テンプレートに ID プロパティが 2 つあるのと同様に、フォーム テンプレートの状態 (アクセス パス、フォーム ID のどちらか、またはその両方が割り当てられているかどうか) やネットワーク接続の状態に基づいて、キャッシュ内で一致するエントリを特定するためのヒューリスティックも一式あります。
  
## <a name="designing-a-form-to-send-as-an-attachment-to-an-email-message"></a>電子メール メッセージへの添付ファイルとして送信するフォームを設計する

InfoPath デザイナーで作成されたフォームはすべて、電子メール メッセージの添付ファイルとしてユーザーに送信できます。 メールの展開は、オフィス間で使用するフォームを配布したり、リモート ユーザーにフォームを展開したりするための簡単で効果的な方法です。
  
### <a name="to-mail-a-form-template-to-other-users"></a>フォーム テンプレートを他のユーザーにメールで送信するには

1. [ファイル] **タブを** クリックし、[発行] **を** クリックし、[メール] ボタン **をクリック** します。 
    
2. **発行ウィザード** で続いて表示される 2 ページに必要事項を記入し、各ページの記入が済んだら [ **次へ**] をクリックして、最後に [ **発行**] をクリックします。
    
3. 電子メール メッセージが表示され、受信者の一覧と、その他の手順を入力できます。
    
4. 記入が済んだら、[ **送信**] をクリックします。フォームとフォーム テンプレートがメッセージに添付されます。
    
## <a name="email-deployment-restricted-domain-and-full-trust-form-templates"></a>メールの展開: 制限付き、ドメイン、および完全信頼フォーム テンプレート

制限付きフォーム テンプレートを電子メールで展開すると、データ接続のない動的フォームをどこからでも開くことができる。 受信者は、電子メールの添付ファイルとして送信されたフォーム テンプレートを、Microsoft Outlook 2010または受信者が添付ファイルを保存した場所から直接開きます。 また、Outlook 2010 を使用して、フォームをメッセージ内で直接編集できます。
  
ドメイン信頼レベルを持つフォーム テンプレートは、発行された場所から開く必要がありますが、発行ウィザードで電子メール受信者の一覧に発行することで、電子メール メッセージへの添付ファイルとして送信できます。 この添付ファイルを開くと、該当するテンプレートの実際の発行先へのリンクとして機能します。 InfoPath エディターで実際に開かれるのは、発行先にあるフォーム テンプレートです。
  
電子メール添付ファイルとして送信されるドメイン レベルのフォーム テンプレートを使用すると、他の種類のドキュメントを使用した場合と似たものになります。たとえば、ブックMicrosoft ExcelドキュメントMicrosoft Wordします。 ユーザーはフォームをクリックするだけで開いて使用できます。 また、ドメイン レベルで更新がある場合、ユーザーがそのメリットを余すことなく活用できます。
  
完全信頼アクセスを要求するフォーム テンプレートを電子メールで送信できますが、これらのテンプレートに署名するか、開くことができません。 ドメインまたは制限付きアクセスを要求するフォーム テンプレートは、電子メールの添付ファイルとして送信するために署名する必要があります。 これらのテンプレートについては、署名されている場合でも、自動更新が可能かどうかを確認する目的以外では署名が確認または検証されることはありません。 ただし、ドメイン レベルまたは制限ありレベルのフォーム テンプレートにデジタル署名をすると、自動更新機能を利用できます。 その場合は、デジタル署名があることで、キャッシュ競合のメッセージが表示されなくなります。
  
## <a name="sharing-forms-by-email-message-or-from-a-common-shared-location"></a>電子メール メッセージまたは共通の共有場所からフォームを共有する

電子メール メッセージによって展開されるフォームを作成する場合は、特定の質問を考慮する必要があります。
  
- **フォームを定期的に更新するかどうか**。作成したフォームを定期的に更新する必要がある場合は、フォームを他のユーザーに送信する前に、共有の場所に発行しておきます。これにより、共有の場所にフォームの新しいバージョンを発行するだけでフォームを更新できますが、その場所にアクセスできないユーザーには即座にフォーム テンプレートを配布できます。 
    
   フォームが更新され、電子メール メッセージによって配布された場合、ユーザーは、コンピューターに古いバージョンが保存され、アクセス パスが変更されている場合、新しいフォームを開く際にキャッシュ競合メッセージを取得します。 受信者は、どちらのバージョンを使用するかを選択する必要があります。 更新済みのフォームが、受信者のコンピューター上のフォームと同じ場合でも、使用するコピーの選択を求めるキャッシュ競合のメッセージは依然として表示されます。 後者の場合のベスト プラクティスは、メール配信の代わりに共有の場所を利用してフォームを共有することです。
    
- **フォームでデータ接続の必要があるか、または制限ありのセキュリティ レベルでは使用できないその他の機能をフォームで使用するかどうか**。 ドメイン レベルのセキュリティを必要とするフォームを作成する場合は、フォームをユーザーが開けるように共有の場所に発行する必要があります。 フォーム テンプレートは要求するセキュリティ レベルでのみ開くので、InfoPath がドメイン レベルのセキュリティを付与できない場合、電子メール メッセージから直接開いたフォームは開かれません。 
    
## <a name="benefits-of-using-signed-form-templates"></a>署名付きフォーム テンプレートを使用する利点

- フォーム テンプレートを完全信頼のセキュリティ レベルで開くことができます。
    
- フォームが新しい場所に移動した場合でも、キャッシュ競合のメッセージが表示されなくなります。
    
さらに、フォーム テンプレートが署名されていると、自動更新機能という別のメリットもあります。詳細については、「[署名済み InfoPath フォーム テンプレートを展開する](deploying-signed-infopath-form-templates.md)」を参照してください。
  
### <a name="example-updating-domain-or-restricted-templates"></a>例: ドメインまたは制限付きテンプレートの更新

次の例は、ドメイン または制限付きアクセスを要求する更新された署名済みフォーム テンプレートが古いコピーを上書きする方法を示しています。 
  
1. "A" が署名済みのフォーム テンプレートを "B" に送信します。
    
2. "B" がフォーム テンプレートを開きます。
    
3. "A" がフィールドを追加するなどしてフォーム テンプレートを更新します。
    
4. "A" が更新後のフォーム テンプレートを "B" に送信します。
    
5. "B" が更新後のフォーム テンプレートを開きます。
    
### <a name="example-deploying-restricted-form-templates-on-an-extranet"></a>例: エクストラネットへの制限付きフォーム テンプレートの展開
  
1. ドメイン フォーム テンプレートを、ドメイン フォーム テンプレートを実行している web サイトにMicrosoft SharePoint Foundation 2010。
    
2. フォーム テンプレートのセキュリティ レベルを [制限あり] に変更します。
    
3. フォーム テンプレートをコンピューターのデスクトップに保存します。
    
4. URL を削除します (URL はユーザーがフォームの発行先にアクセスできる場合にのみ必要です)。
    
5. フォームをエクストラネット上のユーザーに送信します。
    
6. ユーザーにフォームをインストールするように指示します。
    
7. ユーザーに記入済みのフォームを返信するように指示します。
    
8. SharePoint Foundation 2010 を実行している Web サイトにフォームを保存し、フォーム ライブラリ 設定ページの [このライブラリにドキュメントを再リンク] オプションを使用してフォーム **を再リンク** します。 
    
## <a name="signature-verification-failure"></a>署名検証の失敗

完全信頼レベルのアクセスを要求する署名済みのフォーム テンプレートに対して署名が認証されない場合、このフォーム テンプレートは開きません。署名の検証がエラーになる原因としては、次のような理由が考えられます。
  
- ルート証明書が、信頼されたルート証明書ストアに存在しない。
    
- フォーム テンプレートの署名に使用された証明書の有効期限が切れている。
    
- フォーム テンプレートの署名に使用された証明書が失効した。
    
- フォーム テンプレートの署名が破損している (フォーム テンプレートが署名後に変更された可能性があります)。
    
署名済みのフォーム テンプレートが要求するアクセス レベルがドメインまたは制限ありの場合は、テンプレートの自動更新が可能かどうかを確認する場合以外には、署名が確認または検証されることはありません。
  
## <a name="infrastructure-registry-keys-for-form-migration-open-behavior"></a>フォーム移行オープン動作のインフラストラクチャ レジストリ キー

ユーザーが開こうとしたフォームとフォーム ID が一致するフォーム テンプレートが見つかった場合に、このフォーム テンプレートの信頼レベルがドメイン レベルで、該当ドメインがフォームの  *href*  属性と一致しないときは、エラー メッセージが表示されます。これにより、見つかったフォーム テンプレートを使用して作成されたことが明らかではないフォームが開かれる事態を阻止できます。 
  
InfoPath では、フォーム ID が同じ複数のフォーム テンプレートは共存できません。システム管理者は 4 つのレジストリ キーを別途指定することで、フォーム テンプレートに照らして XML ファイルを開くかどうかをユーザーが選択できるようにすることができます。このモデルを利用して、管理者はフォームが開かれるときの動作も設定できます。
  
次の表は、前述のレジストリ キーの既定の設定を示しています。これらのレジストリ キーがない場合は、表に記載されている既定値が適用されます。
  
[名前] の値は、Internet Explorer のドメイン設定に対応しています。これらの値によって、対応するセキュリティ ゾーンでフォームが開かれるときの動作として、フォームを開く操作をブロックするか許可するか、またはフォームを開くかどうかをユーザーが選択できるようにするかを指定できます。
  
|**[名前] 値**|**Block**|**User Interface**|**Allow**|
|:-----|:-----|:-----|:-----|
|**Internet** <br/> |X  <br/> |||
|**Intranet** <br/> ||X  <br/> ||
|**Client Computer** <br/> |||X  <br/> |
|**Trusted Site** <br/> |||X  <br/> |
   
レジストリ キーのパスはです `HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\InfoPath\Open Behaviors` 。

フォームが開かれるときの動作 (Open Behaviors) は次のように定義されます。
  
- `Block [REG_DWORD = 0]`- [ヘルプ] ボタンの付いたエラー ダイアログ ボックスが表示されます。フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合は、XML ファイルを開けません。 
    
- `User Interface [REG_DWORD = 1]`- [はい]/[いいえ] 型のダイアログ ボックスが表示されます。フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合は、見つかったフォーム テンプレートに照らして XML ファイルを開くかどうかの選択をユーザーに求めます。 
    
- `Allow [REG_DWORD = 2]`- エラーや警告のダイアログ ボックスが表示されることなく XML ファイルが開きます。 フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合でも、XML ファイルを開くことができます。 
    
ドメイン セキュリティ レベルで実行しているフォーム テンプレートに照らしてフォームが開かれた場合に、このテンプレートの「キャッシュ元」の場所 (キャッシュされたフォームの実際の保存場所) のセキュリティ ドメインがフォームの **href** 属性と一致しないときは、前述のレジストリがチェックされ、フォームを開くときの動作が判定されます。許容される動作は、テンプレートが位置するセキュリティ ゾーン (  *CachedFromLocation*  値) に基づいて決まります。 
  
たとえば、フォームとフォーム ID が一致するフォーム テンプレートが見つかったものの、アクセス パスは一致していない場合、このフォーム テンプレートのキャッシュ元がインターネット上の場所のときは、[ヘルプ] ボタンの付いたエラー ダイアログ ボックスが表示されます。
  
> [!NOTE]
> [!メモ] InfoPath のフォームは、ドメインが Internet Explorer の制限されたドメインである場合は開きません。このため、Internet Explorer の制限付きサイトに対応するレジストリ キーはありません。 
  

