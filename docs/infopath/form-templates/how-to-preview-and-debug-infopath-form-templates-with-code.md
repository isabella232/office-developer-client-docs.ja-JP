---
title: コードを含む InfoPath フォーム テンプレートをプレビューおよびデバッグする
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- previewing form templates [infopath 2007],debugging form templates [InfoPath 2007],form templates [InfoPath 2007], previewing,debugging [InfoPath 2007], managed-code form templates,form templates [InfoPath 2007], debugging,InfoPath 2007, debugging form templates,InfoPath 2007, previewing form templates
ms.localizationpriority: medium
ms.assetid: c8387f1c-b34c-490e-8bf9-d824bf98d826
description: Microsoft InfoPath (Visual Studio 2012 インストール済み) では、フォーム コードをプレビュー モードで実行してデバッグすることができます。フォーム コードのデバッグを開始すると、プロジェクトがコンパイルされて、InfoPath の [プレビュー] ウィンドウにフォームが表示されます。ブレークポイントが設定されたコード行が見つかるとコード エディターにフォーカスが移動し、ブレークポイントを過ぎると [プレビュー] ウィンドウにフォーカスが戻ります。[プレビュー] ウィンドウを閉じるとデバッグが停止します。
ms.openlocfilehash: 186d4db9bad84788cceeb7d0d8c2b677a0d09414
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59584886"
---
# <a name="preview-and-debug-infopath-form-templates-with-code"></a>コードを含む InfoPath フォーム テンプレートをプレビューおよびデバッグする

Microsoft InfoPath (Visual Studio 2012 インストール済み) では、フォーム コードをプレビュー モードで実行してデバッグすることができます。フォーム コードのデバッグを開始すると、プロジェクトがコンパイルされて、InfoPath の [プレビュー] ウィンドウにフォームが表示されます。ブレークポイントが設定されたコード行が見つかるとコード エディターにフォーカスが移動し、ブレークポイントを過ぎると [プレビュー] ウィンドウにフォーカスが戻ります。[プレビュー] ウィンドウを閉じるとデバッグが停止します。
  
フォーム テンプレートのフォーム オプションを変更して、プレビューやデバッグの際に特定のユーザー ロールやサンプル データ ファイルを使用したり、フォームの発行先となるドメインを指定したりすることもできます。 
  
> [!NOTE]
> フォーム テンプレートを展開後、Visual Studio 2012 での実行時にデバッグすることはできません。 これは、InfoPath のみと互換性があるフォーム テンプレートについても、InfoPath および InfoPath Forms Services を使用する Web ブラウザーと互換性があるフォーム テンプレートについても同様です。 ただし、実行時に、コードからフィールドに値のログを記録すると、フォーム テンプレートのビジネス ロジックのデバッグに有効です。 この方法については、「[デバッグのために値のログをフィールドに記録する方法](how-to-log-values-to-a-field-for-debugging.md)」を参照してください。 
  
## <a name="debugging-in-preview-mode"></a>プレビュー モードでデバッグする

### <a name="to-debug-an-infopath-project-in-preview-mode"></a>InfoPath プロジェクトをプレビュー モードでデバッグするには

1. Visual Studio 2012 で、InfoPath マネージ コード フォーム テンプレートを作成するか開きます。
    
2. コード エディターでフォーム コードにブレークポイントを 1 つ以上設定します。ブレークポイントを設定するには、ブレークポイントを挿入するコード行の左にあるグレーのバーをクリックします。
    
    赤い円が表示され、コード行が強調表示されます。これは、ランタイムがフォーム コードのこのブレークポイントで一時停止することを表しています。
    
3. [ **デバッグ**] メニューの [ **デバッグ開始**] をクリックします (または F5 キーを押します)。
    
    プロジェクトがコンパイルされて、フォームが [プレビュー] ウィンドウに表示されます。
    
4. ブレークポイントを含むコード行が見つかるまでフォームを操作します。
    
    コード エディターにフォーカスが戻ります。
    
5. [ **デバッグ**] メニューの [ **続行**] をクリックします (または F5 キーを押します)。
    
6. デバッグが完了したら、プレビュー ウィンドウを閉じるか、**[デバッグ]** メニューで **[デバッグの停止]** をクリックします。
    
> [!NOTE]
> 完全な信頼が必要なオブジェクト モデル メンバーを使用している場合に InfoPath マネージ コード フォーム テンプレートをデバッグするには、「[完全信頼が必要なフォーム テンプレートをプレビューおよびデバッグする方法](how-to-preview-and-debug-form-templates-that-require-full-trust.md)」の説明に従ってフォーム テンプレートを構成する必要があります。 
  
## <a name="using-a-sample-data-file"></a>サンプル データ ファイルを使用する

既定では、フォーム テンプレートの作成時に作成される template.xml ファイルがデバッグやプレビューの際に使用されますが、独自のデータ ファイルを作成して、そのファイルを使用するように指定することもできます。そのためには、次のいずれかの手順を使用します。 
  
### <a name="to-specify-a-sample-data-file-to-use-while-debugging-or-previewing-in-visual-studio-tools-for-applications"></a>Visual Studio Tools for Applications でのデバッグやプレビューの際に使用するサンプル データ ファイルを指定するには

1. template.xml を表示するために、フォーム テンプレートを InfoPath のデザイン モードで開きます。
    
2. [ **ファイル**] タブをクリックし、[ **保存**]、[ **フォーム テンプレートに名前を付けて保存**]、[ **ソース ファイル**] の順にクリックします。
    
3. フォーム テンプレート ファイルをフォルダーに保存してから、template.xml ファイルをテキスト エディターで開きます。
    
4. 使用するサンプル データを使って template.xml と同じ構造のファイルを作成し、そのファイルを保存します。
    
5. [ **ファイル**] タブをクリックして、[ **情報**] タブの [ **フォームのオプション**] をクリックします。 
    
6. [ **フォームのオプション**] ダイアログ ボックスの [ **プレビュー**] カテゴリをクリックし、[ **サンプル データ**] の下の [ **ファイルの場所**] ボックスに作成したサンプル データ ファイルを指定します。 
    
## <a name="specifying-a-user-role-to-use-while-debugging-or-previewing"></a>デバッグやプレビューの際に使用するユーザー ロールを指定する

使用しているフォームにユーザー ロールが定義されている場合は、フォームのデバッグやプレビューの際に使用するユーザー ロールを指定することができます。ユーザー ロールを定義する方法については、InfoPath ヘルプで "ユーザー ロール" を検索してください。
  
> [!NOTE]
> フォーム テンプレートの互換性設定が [ **Web ブラウザー フォーム**] に設定されている場合、ユーザー ロールを指定するオプションは使用できません。InfoPath Forms Services からブラウザーで開かれたフォーム テンプレートでは、ユーザー ロールはサポートされていません。 
  
### <a name="to-specify-a-role-to-use-while-debugging-or-previewing"></a>デバッグやプレビューの際に使用するロールを指定するには

1. Visual Studio 2012 で作業している場合は、InfoPath に切り替えます。
    
2. [ **ファイル**] タブをクリックして、[ **情報**] タブの [ **フォームのオプション**] をクリックします。 
    
3. [ **フォームのオプション**] ダイアログ ボックスの [ **プレビュー**] カテゴリをクリックし、[ **プレビューのロール**] ボックスの一覧で、使用するユーザー ロールを指定します。 
    
## <a name="specifying-a-domain-to-use-while-debugging-or-previewing"></a>デバッグやプレビューの際に使用するドメインを指定する

特定のドメインに発行された場合のフォームの表示状態を、発行前にプレビューすることができます。この設定は、フォームのセキュリティ レベルが [ **ドメイン**] に明示的に設定されている場合にのみ適用されます。
  
### <a name="to-specify-a-domain-to-use-while-debugging-or-previewing"></a>デバッグやプレビューの際に使用するドメインを指定するには

1. Visual Studio 2012 で作業している場合は、InfoPath に切り替えます。
    
2. [ **ファイル**] タブをクリックして、[ **情報**] タブの [ **フォームのオプション**] をクリックします。 
    
3. [ **フォームのオプション**] ダイアログ ボックスの [ **プレビュー**] カテゴリをクリックし、プレビューやデバッグの際に使用するドメインを [ **ドメイン**] ボックスで指定します。 
    
4. [ **フォームのオプション**] ダイアログ ボックスの [ **セキュリティと信頼**] カテゴリをクリックし、[ **自動的にセキュリティ レベルを設定する**] チェック ボックスをオフにして、[ **ドメイン**] をクリックします。
    

