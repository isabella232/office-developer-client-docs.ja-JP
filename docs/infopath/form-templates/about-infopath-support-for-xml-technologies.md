---
title: InfoPath の XML テクノロジのサポートについて
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 074181a2-3a75-824c-049d-549aabff0f9f
description: Microsoft InfoPath は、ワープロや電子メールのアプリケーションなどの従来のドキュメント編集環境の最高のものと、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッドなツールです。 この記事では、InfoPath を使用して取り組むべき問題について説明し、問題の解決に使用される設計方針および XML の業界標準について説明します。
ms.openlocfilehash: 20831635fba8d76b9d6b45f42a5308ab7236db20
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407229"
---
# <a name="about-infopath-support-for-xml-technologies"></a>XML テクノロジのための InfoPath サポートについて

Microsoft InfoPath は、ワープロや電子メールのアプリケーションなどの従来のドキュメント編集環境の最高のものと、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッドなツールです。 この記事では、InfoPath を使用して取り組むべき問題について説明し、問題の解決に使用される設計方針および XML の業界標準について説明します。
  
## <a name="introduction"></a>概要

InfoPath はハイレベルな XML オーサリング ツールで、これを使用することで、一般的なエンドユーザーが、カスタム定義された XML スキーマに属する XML ドキュメントを作成できます。ユーザーが XML ドキュメントを編集する際に、ドキュメントへの変更は XML スキーマによって制御されます。
  
ユーザーは、ドキュメントに XSLT スタイル シートを適用することで表示される、リッチで形式化されたビューを通じて、XML ドキュメントを扱うことができます。XML ドキュメントのリーフ ノードや属性値は、テキスト ボックスやチェック ボックスなどのフィールドとして表示され、ノードの階層構造はフィールドのグループとしてレンダリングされます。
  
InfoPath は、選択中のフィールドやフィールド グループに有効な編集操作を表示することで、XML データの、有効で、構造化された編集を可能にします。この構造化された編集によって、ユーザーは、リッチで動的なビューで表示されるフィールドのグループを使用して作業することで、要素および属性を確認せずに、有効な XML 要素および属性の追加や削除ができます。
  
InfoPath は、XML が登場する前は解決できなかったデータ収集の領域の問題を解決します。InfoPath は、XML の階層構造のデータ モデルを使用するフィールドのグループを追加することによって拡張できるフォームを提供して、フォーム アプリケーションの厳密な検証機能を活かしながらワープロのドキュメントの柔軟性を組み込みます。複雑な XSLT 変換は、XML データの動的で使用しやすいビューを提供する、このソリューションの不可欠な部分です。
  
## <a name="limitations-of-traditional-forms-and-documents-for-gathering-data"></a>データ収集に関しての従来のフォームやドキュメントの制限事項

ユーザーが企業のデータを収集するときに、静的なフォームよりも優れた柔軟性が必要になる一方で、ワープロのドキュメントよりも構造化された編集と検証が必要なことが頻繁にあります。
  
従来のフォームは静的で、長さが限られていました。繰り返し行の数が固定されていて、フォームへの記入中は拡張できません。従来のフォームは、リッチな編集機能がないので、使用しにくく、ユーザーがすべての情報を 1 回のパスで提供する必要があることがよくあります。
  
一方で、ワープロを使用して作成された従来のドキュメントでは、ユーザーはコンテンツの追加と削除を自由にできますが、完全で、構造化された、有効な情報を入力する方法についてのガイダンスはほとんど提供されません。ドキュメント内で定義されたフィールドでは、データの値およびデータの型の検証は、行われないか、または、最小限です。自動的に再利用したり、簡単に参照できるように、フィールド内のデータが適切に分類されていません。データは、構造化されておらず、形式が自由です。"地区"、"都市"、および "州" フィールドのグループへの "住所" ラベルの適用など、情報のグループ化ができません。
  
このように、柔軟性がある一方で構造化された編集の必要性がありますが、XML が登場する前はこういったテクノロジは利用できなかったので、開発者は、大掛かりなコーディングが必要なカスタム アプリケーションを作成する必要がありました。カスタム アプリケーションはコストが高く、変更が困難で、検証のためにカスタムのコーディングが必要です。カスタム アプリケーションには、エンドユーザーのトレーニングが必要なことが多く、結果のデータを他のビジネス プロセスに再利用することは困難です。
  
## <a name="providing-structured-editing-by-displaying-xml-data-as-field-groups"></a>XML データをフィールド グループとして表示することによる、構造化された編集の実現

要素および属性を表示せず、DOM ツリーをカスタム定義された XML スキーマに従って有効な状態に保ったままで、XML 要素および属性の追加と削除のための簡単なユーザー インターフェイスをどのように実現するかという、技術的な設計上の重要な問題を解決する必要がありました。ユーザー インターフェイスでは、オプションのサブツリーの挿入、サブツリーの選択肢の置換、既存のサブツリーの拡張などの、DOM ツリーの編集を自然に行うことができるようにする必要がありました。
  
このような簡単なユーザー インターフェイスを実現するために、DOM サブツリーは、フィールド グループ、または、セクションとして表示されます。フィールド グループとは、テキスト ボックスやドロップダウン リストなどの UI コントロールのグループで、ユーザーが階層構造の XML データを視覚的に表示させて編集できる簡単なユーザー インターフェイスとして使用されます。DOM サブツリーが他のサブツリーを含むことや、選択肢や繰り返しになることができるのと同様に、フィールド グループは、他のフィールド グループを含むことや、選択肢や繰り返しになることができます。サブツリーは、ユーザーがフィールド グループにマウス ポインターを置き、フィールド グループ上に表示されるドロップダウン メニューをクリックして、[ **\<フィールド グループ名\> の挿入**] を選択したときに、DOM ツリーに追加されます。
  
InfoPath は、編集の制約とガイドを行う特定の XML スキーマを使用して、このような XML データの構造化された編集を実現します。スキーマによって、フィールド グループのドロップダウン メニューに [ **挿入**] および [ **削除**] のコマンドが表示されるかどうかが制御されます。スキーマは検証にも使用されます。InfoPath は、XML スキーマがない XML ドキュメントの編集を可能にするために、XML ドキュメントからスキーマを生成できます。 
  
## <a name="providing-easy-to-use-views-of-xml-data-by-using-xslt-transformations"></a>XSLT 変換の使用による、XML データの使いやすいビューの実現

技術的な設計上の課題として、どのように UI のビューのコンテンツを XML データの構造とは大きく異なった形で構成できるようにするかという課題を解決する必要もありました。ユーザーが最も理解しやすく、簡単にデータの読み取りや編集ができる方法でデータを提示するには、設計者が、DOM データ ツリー内とは異なる順序でデータを表示でき、一部のデータはビューから省略でき、隣接したデータ ツリーのノードを別々のビューに再構成でき、データ ツリーのさまざまな部分から 1 つのビューへデータを集められる必要があります。
  
そのため、ビューのコンテンツの順序と構造は、DOM ツリーのノードの順序と構造に依存しない必要があります。このように、表示とデータに構造上の依存関係がないため、ビュー内のグループ化されたフィールドと DOM ツリー内のノードとの間での、複雑で動的なバインドやマッピングが必要です。
  
InfoPath では、ビューとデータの間のこういった複雑なマッピングを実現するために、XSL 変換 (XSLT) を拡張して使用します。XSLT は、複雑な XSLT 変換をサポートし、動的で柔軟性のあるコンテンツの表示を行うリッチなビューをサポートする、強力なスタイル シート 言語です。ビューごとに 1 つの XSLT ファイルが使用されます。スタイル シートの利用は、SGML および XML のオーサリング ツールでの一般的で定着しているデザイン手法で、XSLT は、こういった複雑な変換に使用されるスタイルシートの W3C 標準です。
  
ユーザーが DOM 内のサブツリーの構造を変更するたびに全体の XSLT 変換を実行するのを避けるために、アルゴリズムを使用して、ビューのどの部分を更新する必要があるかを特定します。そのため、XSLT スタイル シートの関連する部分のみが適用され、ビューの影響がある部分が更新されます。
  
## <a name="how-xml-standards-are-used-when-editing-a-form"></a>フォームの編集時に XML 標準が使用されるしくみ

InfoPath は、次のような XML 標準を基にして構築されています。
  
- 拡張マークアップ言語 (XML) 1.0 Second Edition
    
- XML の名前空間
    
- XML パス言語 (XPath) 1.0
    
- XML スキーマ (XSD) 1.0 パート 1: 構造、および、パート 2: データ型
    
- 拡張スタイルシート言語変換 (XSLT) 1.0
    
- 拡張ハイパーテキスト マークアップ言語 (XHTML) 1.0
    
- カスケード スタイル シート (CSS)
    
- ドキュメント オブジェクト モデル (DOM) 1.0
    
- XML デジタル署名 (XML DSig)
    
- 簡易オブジェクト アクセス プロトコル (SOAP) 1.1
    
- Web サービス記述言語 (WSDL) 1.1
    
- Universal Description, Discovery, and Integration (UDDI) 1.0
    
たとえば、InfoPath は、さまざまなビジネス プロセスで再利用できる標準的な XML、XSLT、および XSD ファイルを使用し、生成します。InfoPath では、MSXML、SOAP Toolkit、および .NET System.XML 名前空間を使用してこれらの標準をサポートし、XML Web サービスの完全に統合されたサポートを提供します。
  
図 1 は、 **customer** フィールド グループ用の状況依存のドロップダウン メニューを示しています。ユーザーは、別の **customer** フィールド グループを追加したり、この **customer** フィールド グループを削除したり、このフィールド グループ内の購入アイテムの表に **item** 行を追加したり、このフィールド グループ内にオプションの **actions** フィールド グループを挿入したりすることができます。[ **ここをクリックしてください**] のリンクを使用して、別の方法で **actions** フィールド グループを挿入できます。購入アイテムの各行に、短いドロップダウン メニューが表示されます。 
  
1. InfoPath では、ユーザーは、InfoPath フォーム テンプレートを基にして新しい XML ドキュメントを作成したり、フォーム テンプレートが基になっている既存の XML ドキュメントを開いたりします。XML ドキュメントは、フォーム テンプレートへの参照を含む XML データ ファイルで、XML 名前空間を使用できます。 
    
    フォーム テンプレートは、特別なカスタム定義の XML スキーマに準拠した XML ドキュメントの構造化された編集を可能にするファイルのセットです。フォーム テンプレートを構成するファイルは、一般的なフォルダー内に個別のファイルとしてパッケージされている場合と、キャビネット フォルダー内に存在するファイルとしてパッケージされている場合があります。どちらの場合も、ファイルは、標準的な XML ファイルと、マネージ コード アセンブリなどのオプションのサポート ファイルです。
    
2. XML 署名を使用して XML ドキュメントにデジタル署名が行われている場合は、InfoPath は、XML ファイルを開く前に、XML ファイルの一貫性を確認します。
    
3. InfoPath は、XML ドキュメントの DOM データ ツリーをインメモリで作成します。
    
4. DOM ツリーに XSLT 変換が適用され、ユーザーにドキュメントを適切に表示するビューが生成されます。XML ドキュメントの先頭の要素をビューの下部に表示でき、異なる表示方法で別のビューに表示することもできます。ビューは、テキスト ボックス、リッチ テキスト ボックス、日付の選択、ドロップダウン リストなどの、テキストおよびコントロールを含むセクションなどの UI コンテナーで構成されます。コンテナーは、他のコンテナーを含むこともできます。
    
5. XSLT 変換によって、出力結果として XHTML が生成されて、XHTML の表示を制御するために CSS が使用されます。
    
6. XML スキーマで、データ ツリーのノードへのノードの追加が許可されている場合は、ノードにマッピングされたフィールドまたはフィールド グループには、ユーザーがフィールド グループの追加や削除を行うことができるドロップダウン メニューがあります。ユーザーは、繰り返しまたはオプションのフィールド グループの追加、値の入力、オプションの選択、あるいは、リッチ テキストの入力を行って、ドキュメントを編集します。XML スキーマのノードが XHTML のスキーマに関連付けられている場合は、InfoPath によってリッチ テキストを作成するための UI が表示されます。ユーザーがリッチ テキストを入力すると、XHTML コンテンツが DOM 内のサブツリーとして作成されます。
    
7. DOM ツリーは、常に有効な状態に維持されます。ユーザーが XML ドキュメントを編集すると、関連付けられた XML スキーマに対しての編集内容の検証が行われます。DOM 構造およびリーフ ノードの値に対して試行された変更は、データ型および値が有効であることを確認するために、XML スキーマに対して検証が行われます。試行された変更が無効な場合は、検証のダイアログ ボックスが開き、変更は DOM ツリーに適用されません。変更が有効な場合は、DOM ツリーが更新されます。
    
8. XSLT スタイル シートの必要な部分のみを DOM ツリーに適用することで、ビューの変更された部分が更新されます。
    
9. ユーザーは、単純な HTTP または SOAP を使用して、XML ドキュメントの保存や XML ドキュメントの送信ができます。XML スキーマに照らして有効でない場合は、ユーザーは、ドキュメントの送信が許可されません。
    
## <a name="how-xml-standards-are-used-when-designing-a-form"></a>フォームの設計時に XML 標準が使用されるしくみ

既存の XML スキーマを利用したり、XML Web サービスやデータベースに接続して XML スキーマを取得したり、新しいフォームや XML データ ファイルからスキーマを自動的に生成したりすることによって、フォームを設計できます。こういったシナリオを、以下の手順で説明します。図 3 は、フォーム テンプレートの設計のための基本的なユーザー インターフェイスを示しています。
  
1. [ **XML/スキーマ**] フォーム テンプレートを選択して、InfoPath Designer で新しいフォームを作成し、既存の XML スキーマ ファイルをデータ ソースとして選択します。XML スキーマが作業ウィンドウに読み込まれ、ツリー コントロールとして表示されます。 
    
2. デザイン レイアウト ツールを使用して、1 つのビューまたは複数のビューで、行や背景デザインなどの UI コントロールのレイアウトを行います。これによって、一部の XSLT 要素が生成されます。XSLT ビューおよび XML スキーマは、自動的にフォーム テンプレートと関連付けられます。
    
3. ドラッグアンドドロップを使用して、ビュー内で UI コントロールに XML スキーマの要素をマッピングします。InfoPath は、スキーマの要素の種類を基にして、XML スキーマの要素に合った適切なコントロールの選択を支援します。たとえば、XML データ型が DATE の場合、InfoPath は、日付の選択のコントロールを勧めます。InfoPath で、XML スキーマでの選択肢を基に、オプションまたは繰り返しのフィールドのグループを挿入できます。XML スキーマの要素を UI コントロールにマッピングすると、XSLT 構造が生成されます。
    
4. フォーム テンプレートを保存します。通常のフォルダー内の個別のファイルとして、または、キャビネット フォルダー内のファイルとして、フォーム テンプレートを構成するファイルを保存できます。どちらの場合でも、ファイルは標準的な XML ファイルです。これで、ユーザーが使用できるように、フォーム テンプレートの準備ができます。
    
フォーム テンプレートには、InfoPath でフォームが開かれたときに構造化された編集を可能にするのに必要な、すべてのセマンティック情報が含まれます。フォーム テンプレートには、マニフェスト ファイル、ビューを定義する XSLT ファイル、データを検証するのに必要な情報、および XML Web サービス用のオプションのリソース識別子が含まれます。
  
マニフェストまたはフォーム定義ファイルは、フォーム テンプレートに必要なすべてのファイルのための共通のハブであり、エントリ ポイントです。マニフェストには、フォーム テンプレート内の他のファイルへの参照が含まれ、データの検証および構造化された編集の実現に必要な情報が含まれます。XML スキーマの検証情報は、最終的なユーザー インターフェイスのためにカスタマイズされ、マニフェスト ファイルに追加されます。たとえば、スキーマで、特定のサブツリー内で複数のオプションの要素の挿入が許可されている場合は、ユーザーが 1 つの UI 操作を実行したときに複数のオプションの要素が追加されるように UI を設計できます。このカスタマイズは、一般的なユーザーに優れたユーザー エクスペリエンスを提供するために重要です。 
  
既存の XML Web サービスを使用して XML スキーマを提供して、フォームを設計することもできます。その場合は、次の手順を実行します。
  
1. UDDI を使用して、関連する Web サービスを探します。
    
2. 使用する Web サービスを選択します。InfoPath は、Web サービスに関連付けられた WSDL ファイルを読み取り、使用される XML スキーマを特定します。
    
3. XML スキーマを開いて、読み込みます。
    
4. UI コントロールのレイアウトを行い、XML スキーマの要素および属性と関連付けます。
    
5. SOAP を使用する Web サービスへの XML ドキュメントの送信方法を定義します。
    
フォームを最初から設計して、XML スキーマを自動的に生成する必要がある場合は、次の手順を実行します。
  
1. [ **ファイル**] タブで、[ **空白のフォーム**] または [ **空白のフォーム (InfoPath Filler)**] フォーム テンプレートのどちらかを選択し、[ **フォームのデザイン**] をクリックします。
    
2. [ **ホーム**] タブで、[ **コントロール**] グループの右下隅の矢印をクリックして、[ **コントロール**] 作業ウィンドウを表示し、[ **自動的にデータ ソースを作成する**] チェック ボックスがオンになっていることを確認します。このチェック ボックスは、既定でオンになっています。 
    
3. UI コントロールのレイアウトを行います。レイアウトを行うと、InfoPath によって自動的に XML スキーマが作成され 、要素および属性が UI コントロールにマッピングされます。
    
整形式の XML データ ファイルを利用してフォームを設計するには、次の手順を実行します。
  
1. [ **File**] タブで、[ **XML/スキーマ**] フォーム テンプレートを選択し、[ **フォームのデザイン**] をクリックします。
    
2. **データ ソース ウィザード**で、データ ソースとして使用する XML ファイルを選択します。XML データ ファイルを基にして、自動的に XML スキーマが作成されます。
    
3. このセクションで前述したとおりに、UI コントロールのレイアウトを行います。
    
## <a name="designed-as-an-ideal-client-for-web-services"></a>Web サービスのための理想的なクライアントとしての設計

幅広い業界全体での Web サービスのサポートが可能になりつつあります。SOAP、UDDI、WSDL などの Web サービスの標準を使用することにより、多数のバックエンドおよび中間層のシステムを構成して通信できます。このような Web サービスに対応したシステムには、データベース、ワークフロー システム、エンタープライズ リソース プラニング (ERP)、カスタマー リレーションシップ マネジメント (CRM) などのシステムが含まれます。InfoPath は、Web サービスを使用して送信されている XML データの表示と編集のための理想的な UI を提供します。図 4 は、XML Web サービスのための統合されたサポートを示しています。
  
InfoPath は、データがコンピューター間で完全な XML ドキュメントとして送信される、Web サービスのゆるやかな結合モデルに適しています。この粒度の粗い通信モデルは、Web の非同期な性質に適しています。InfoPath は、XML ドキュメント用のハイレベルなオーサリング ツールとして、リモート プロシージャ コール (RPC) の SOAP エンコードではなく、ドキュメント/リテラル形式の SOAP エンコードをサポートしています。InfoPath は、SOAP メッセージ内で指定された XML スキーマをネイティブで読み取って、ユーザーが XML ドキュメント (対応する Web サービスで生成されるか、または受信される) の表示と編集を簡単にできる UI をスキーマに基づいて作成できるので、Web サービスの理想的なクライアントです。InfoPath は、変更の追跡を含む ADO.NET データセットのサポートも提供します。
  
## <a name="terminology"></a>用語集

|||
|:-----|:-----|
|**フィールド グループ:** <br/> |セクション、繰り返しセクション、オプションのセクション、または繰り返しテーブル。セクションおよび繰り返しテーブルは、他のコントロールを含み、必要に応じて繰り返されるフォーム上のコントロールです。ユーザーは、フォームに記入する際に、複数のセクションや行を挿入できます。  <br/> |
|**DOM ツリー:** <br/> |フォームのデータ ソースの構造。特に、InfoPath フォームのためのデータの定義と格納を行うフィールドおよびグループの集まり。  <br/> |
   
## <a name="conclusion"></a>終わりに

InfoPath では、Open XML 標準を使用して、ユーザーが、データ収集のための、柔軟性がある一方で構造化された XML 編集をできるようにします。階層構造の XML データを視覚的に表示させて編集するための、簡単なユーザー インターフェイスを提供するために、UI コントロールを含む入れ子構造のフィールド グループが DOM ツリーにマッピングされます。XSLT 変換によって、XML データの構造とは異なる形で、UI ビューのコンテンツを構成できます。
  
InfoPath は、静的なフォームよりも優れた柔軟性を提供し、ワープロのドキュメントよりも構造化された編集および検証を行うことができます。従来のドキュメント編集環境の高機能な部分と、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッド ツールで、これを使用することで、一般的なユーザーが、カスタム定義された XML スキーマに属する有効な XML ドキュメントを作成できます。Web サービスの統合されたサポートにより、Web サービスのスキーマに準拠した XML ドキュメントを編集するためのビューを簡単に定義できます。
  

