---
title: Excel ã§ã® C API ã‚’ä½¿ç”¨ã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- c api [excel 2007],programming interfaces [Excel 2007],C API [Excel 2007], when to use,C API [Excel 2007], relation to XLM,Excel programming interfaces
ms.assetid: 142bc0ce-7d16-4b69-9799-ce6558da2def
description: 'é©ç”¨å¯¾è±¡: Excel 2013 | Office 2013 | Visual Studio'
localization_priority: Priority
ms.openlocfilehash: d07217fe410fedb18da4600ab07078d1aaf5d083
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/17/2019
ms.locfileid: "28704813"
---
# <a name="programming-with-the-c-api-in-excel"></a><span data-ttu-id="b32de-104">Excel ã§ã® C API ã‚’ä½¿ç”¨ã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</span><span class="sxs-lookup"><span data-stu-id="b32de-104">Programming with the C API in Excel</span></span>

 <span data-ttu-id="b32de-105">**é©ç”¨å¯¾è±¡**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b32de-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="b32de-p101">Microsoft Excel 2013 XLL ï¿½\ï¿½tï¿½gï¿½Eï¿½Fï¿½Aï¿½Jï¿½ï¿½ï¿½Lï¿½bï¿½gï¿½ï¿½ C API ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ÄAExcel 2013 ï¿½Ìï¿½ï¿½pï¿½tï¿½Hï¿½[ï¿½}ï¿½ï¿½ï¿½Xï¿½Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½ì¬ï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½BExcel 2013 ï¿½ï¿½ C API ï¿½Ö‚ÌƒAï¿½bï¿½vï¿½Oï¿½ï¿½ï¿½[ï¿½hï¿½ÍAï¿½Tï¿½[ï¿½h ï¿½pï¿½[ï¿½eï¿½Bï¿½ï¿½ï¿½@ï¿½\ï¿½Ü‚ï¿½ï¿½Í“ï¿½ï¿½ï¿½@ï¿½\ï¿½Ìƒpï¿½tï¿½Hï¿½[ï¿½}ï¿½ï¿½ï¿½Xï¿½ï¿½ï¿½dï¿½vï¿½ÈˆÓ–ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½[ï¿½Uï¿½[ï¿½É‘ï¿½ï¿½ÄŒpï¿½ï¿½ï¿½ï¿½ï¿½Äsï¿½ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½Tï¿½|ï¿½[ï¿½gï¿½ğ”½‰fï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p101">You can use the Microsoft Excel 2013 XLL Software Development Kit and the C API to create high-performance worksheet functions for Excel 2013. The upgrades to the Excel 2013 C API reflect ongoing support for users for whom the performance of third-party or in-house functionality is critical.</span></span>
  
## <a name="excel-programming-interfaces"></a><span data-ttu-id="b32de-108">Excel ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</span><span class="sxs-lookup"><span data-stu-id="b32de-108">Excel Programming Interfaces</span></span>

<span data-ttu-id="b32de-p102">Excel ã«ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä½¿ç”¨ã—ã¦ Excel ã¨æ¥ç¶šã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚Excel ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¯ã€æ¬¡ã®é †åºã§ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p102">Excel provides several options for developing applications that interface with it. The Excel programming interfaces were added to earlier versions in the following order:</span></span>
  
- <span data-ttu-id="b32de-p103">**XLM ï¿½}ï¿½Nï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:** Excel ï¿½ÌŠgï¿½ï¿½ï¿½@ï¿½\ï¿½Ì‚ï¿½ï¿½ß‚Éƒï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½ï¿½gï¿½pï¿½Å‚ï¿½ï¿½ï¿½Åï¿½ï¿½ÌŒï¿½ï¿½ï¿½ÅAC API ï¿½ÌŠï¿½bï¿½É‚È‚ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½BXLM ï¿½ÍAExcel 2010 ï¿½Å‚ï¿½Tï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½È‚ï¿½È‘Oï¿½ï¿½ Visual Basic for Applications (VBA) ï¿½É’uï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p103">**XLM macro language:** The first user-accessible language for the extension of Excel and the basis of the C API. Although still supported in Excel 2010, XLM has long been superseded by Visual Basic for Applications (VBA).</span></span> 
    
- <span data-ttu-id="b32de-p104">**C API ï¿½ï¿½ XLL:** Excel ï¿½É“ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ DLL ï¿½Å‚ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ DLL ï¿½ÍAï¿½ï¿½ï¿½pï¿½tï¿½Hï¿½[ï¿½}ï¿½ï¿½ï¿½Xï¿½Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½Ç‰ï¿½ï¿½ï¿½ï¿½ï¿½Å‚ï¿½ï¿½ï¿½Ú“Iï¿½ÅÅ‘ï¿½ï¿½ÌƒCï¿½ï¿½ï¿½^ï¿½[ï¿½tï¿½Fï¿½Cï¿½Xï¿½ï¿½ñ‹Ÿ‚ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½È~ï¿½Ì‹Zï¿½pï¿½Æ”ï¿½rï¿½ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ç‚©ï¿½ï¿½ï¿½Gï¿½Å‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p104">**C API and XLLs:** DLLs that are integrated with Excel. These DLLs provide the most direct and fastest interface for the addition of high-performance worksheet functions, although at the cost of some complexity compared with later technologies.</span></span> 
    
- <span data-ttu-id="b32de-p105">**VBA:** Excel ï¿½uï¿½bï¿½N ï¿½Iï¿½uï¿½Wï¿½Fï¿½Nï¿½gï¿½ÉŠÖ˜Aï¿½tï¿½ï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ Visual Basic ï¿½Rï¿½[ï¿½h ï¿½Iï¿½uï¿½Wï¿½Fï¿½Nï¿½gï¿½Å‚ï¿½ï¿½BVBA ï¿½ÍAï¿½Cï¿½xï¿½ï¿½ï¿½g ï¿½gï¿½ï¿½ï¿½bï¿½vï¿½Aï¿½Jï¿½Xï¿½^ï¿½}ï¿½Cï¿½Yï¿½Aï¿½ï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½\`ï¿½ï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½Ì’Ç‰ï¿½ï¿½ï¿½\ï¿½É‚ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½BVBA ï¿½ÍAï¿½Å‚ï¿½ï¿½Ê“Iï¿½Égï¿½pï¿½ï¿½ï¿½ï¿½Aï¿½Å‚ï¿½eï¿½Õ‚É—ï¿½ï¿½pï¿½Å‚ï¿½ï¿½ï¿½gï¿½ï¿½ï¿½Iï¿½vï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½Å‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p105">**VBA:** Visual Basic code objects that are associated with Excel workbook objects. VBA allows event trapping, customization, and the addition of user-defined functions and commands. VBA is the most commonly used and most easily available of the extensibility options.</span></span> 
    
- <span data-ttu-id="b32de-p106">**COM:** Windows ï¿½xï¿½[ï¿½Xï¿½ÌƒAï¿½vï¿½ï¿½ï¿½Pï¿½[ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ì‘ï¿½ï¿½İ‰^ï¿½pï¿½ï¿½ï¿½Ì•Wï¿½ï¿½ï¿½Å‚ï¿½ï¿½BExcel ï¿½ÍAï¿½ï¿½ï¿½ï¿½ï¿½î‚µï¿½ÄƒCï¿½xï¿½ï¿½ï¿½gï¿½ï¿½Iï¿½uï¿½Wï¿½Fï¿½Nï¿½gï¿½ï¿½ï¿½ï¿½Jï¿½ï¿½ï¿½Ü‚ï¿½ï¿½BVBA ï¿½ÍACOM ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ï¿½ Excel ï¿½Æ‘Î˜bï¿½ï¿½ï¿½Ü‚ï¿½ï¿½BExcel ï¿½ÍAï¿½Oï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ Excel ï¿½ğ§Œä‚·ï¿½ï¿½ C++ COM ï¿½Rï¿½[ï¿½hï¿½Ìƒï¿½ï¿½\ï¿½[ï¿½Xï¿½ï¿½Aï¿½vï¿½ï¿½ï¿½Pï¿½[ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ì¬ï¿½ï¿½ï¿½ï¿½Ì‚É–ğ—§‚ï¿½ COM ï¿½^ï¿½Cï¿½v ï¿½ï¿½ï¿½Cï¿½uï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Gï¿½Nï¿½Xï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p106">**COM:** The interoperability standard for Windows-based applications, through which Excel exposes its events and objects. VBA uses COM to interact with Excel. Excel exports COM type libraries that can help you create C++ COM code resources and applications that can control Excel externally.</span></span> 
    
- <span data-ttu-id="b32de-p107">**Microsoft .NET Framework:** ï¿½ï¿½ï¿½Uï¿½ï¿½ï¿½Ìvï¿½ï¿½ï¿½ÈƒAï¿½vï¿½ï¿½ï¿½Pï¿½[ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½Jï¿½ï¿½ï¿½pï¿½Évï¿½ï¿½ï¿½ê‚½ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½}ï¿½lï¿½[ï¿½W ï¿½Rï¿½[ï¿½hï¿½ï¿½ï¿½Å‚ï¿½ï¿½B.NET Framework ï¿½ï¿½ï¿½ï¿½ï¿½ÌƒRï¿½[ï¿½hï¿½Ìï¿½vï¿½Èƒvï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½ï¿½ï¿½ C# ï¿½Å‚ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½ÌŒï¿½ï¿½ï¿½ï¿½ Microsoft ï¿½ï¿½ï¿½ÔŒï¿½ï¿½ï¿½ (MSIL) ï¿½ÉƒRï¿½ï¿½ï¿½pï¿½Cï¿½ï¿½ï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½BExcel 2013 ï¿½Å‚ï¿½, .NET Framework ï¿½Aï¿½Zï¿½ï¿½ï¿½uï¿½ï¿½ï¿½ÉŠÜ‚Ü‚ï¿½ï¿½Rï¿½[ï¿½h ï¿½ï¿½ï¿½\ï¿½[ï¿½Xï¿½ÉƒAï¿½Nï¿½Zï¿½Xï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p107">**The Microsoft .NET Framework:** The multi-language managed code environment designed for rapid application development for distributed environments. The primary programming language for code that is based on the .NET Framework is C#, although many languages can be compiled to the Microsoft intermediate language (MSIL). Excel 2013 can access code resources contained within .NET Framework assemblies.</span></span> 
    
## <a name="when-to-use-the-c-api"></a><span data-ttu-id="b32de-124">C API ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ</span><span class="sxs-lookup"><span data-stu-id="b32de-124">When to Use the C API</span></span>

<span data-ttu-id="b32de-125">XLL ã‚’è¨˜è¿°ã—ã€C API ã‚’ä½¿ç”¨ã™ã‚‹ä¸»ãªç†ç”±ã¯ã€é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãªãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆé–¢æ•°ã‚’ä½œæˆã™ã‚‹ãŸã‚ã§ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-125">The primary reason for writing XLLs and using the C API is to create high-performance worksheet functions.</span></span> <span data-ttu-id="b32de-126">XLL é–¢æ•°ã¯ã€ã‚ˆã "ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©" é–¢æ•°ã¨å‘¼ã°ã‚Œã¾ã™ãŒã€ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ XLL ã¯æ™‚é–“ã‚’ã‹ã‘ã¦è¨˜è¿°ã«å¿…è¦ãªç†è§£ã¨ã‚¹ã‚­ãƒ«ã‚’å¾—ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€å®Ÿç”¨çš„ã¨ã¯ã„ãˆãªã„æŠ€è¡“ã«ãªã£ã¦ã„ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-126">Although XLL functions are frequently referred to as user-defined functions, the investment in time to obtain the understanding and skills that are required to write XLLs make this a technology impractical for most users.</span></span> <span data-ttu-id="b32de-127">ãã‚Œã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é–¢æ•°ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (Excel 2013 ã§ã¯å¼·åŠ›ãªã‚µãƒ¼ãƒãƒ¼ ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ãƒãƒ«ãƒ ã‚¹ãƒ¬ãƒƒãƒ‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’è¨˜è¿°ã™ã‚‹æ©Ÿèƒ½) ã‚’è€ƒãˆã‚‹ã¨ã€XLL ã¯ Excel ã®æ©Ÿèƒ½æ‹¡å¼µã®éå¸¸ã«é‡è¦ãªéƒ¨åˆ†ã§ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-127">Nevertheless, the applications of high-performance functionsâ€”and, in Excel 2013, the ability to write multithreaded interfaces to powerful server resourcesâ€”make this a very important part of Excel extensibility.</span></span> 
  
<span data-ttu-id="b32de-128">Excel 2007 ã§å°å…¥ã•ã‚ŒãŸ C API ã®æ”¹è¨‚ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ãªã©ã®æ©Ÿèƒ½ã§ã¯ãªãã€ä¸»ã«é«˜æ€§èƒ½ãªè¨ˆç®—ã«é–¢é€£ã™ã‚‹å´é¢ã«é–¢ä¿‚ã—ã¦ã„ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-128">The revision of the C API that was introduced in Excel 2007 is mainly concerned with the aspects relating to high-performance calculations, rather than features such as the user interface.</span></span>
  
### <a name="writing-high-performance-user-defined-worksheet-functions"></a><span data-ttu-id="b32de-129">é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆé–¢æ•°ã®ä½œæˆ</span><span class="sxs-lookup"><span data-stu-id="b32de-129">Writing High-Performance User-Defined Worksheet Functions</span></span>

<span data-ttu-id="b32de-p109">XLL ï¿½Aï¿½hï¿½Cï¿½ï¿½ï¿½ï¿½ì¬ï¿½ï¿½ï¿½ÄAï¿½ï¿½ï¿½pï¿½tï¿½Hï¿½[ï¿½}ï¿½ï¿½ï¿½Xï¿½Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½ì¬ï¿½ï¿½ï¿½ï¿½ê‡ï¿½AExcel ï¿½ï¿½ C API ï¿½Í—ï¿½ï¿½zï¿½Iï¿½È‘Iï¿½ï¿½ï¿½ï¿½Å‚ï¿½ï¿½BC API ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ï¿½ÆAï¿½ï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½Ìƒfï¿½[ï¿½^ï¿½ÖÅ‚ï¿½ï¿½ï¿½Ú“Iï¿½ÉƒAï¿½Nï¿½Zï¿½Xï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½BXLL ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ï¿½ÆAExcel ï¿½ï¿½ DLL ï¿½ï¿½ï¿½\ï¿½[ï¿½Xï¿½ÖÅ‚ï¿½ï¿½ï¿½Ú“Iï¿½ÉƒAï¿½Nï¿½Zï¿½Xï¿½Å‚ï¿½ï¿½ï¿½æ‚¤ï¿½É‚È‚ï¿½Ü‚ï¿½ï¿½BExcel 2013 ï¿½Å‚ÍAï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½fï¿½[ï¿½^ï¿½^ï¿½ï¿½ï¿½Ç‰ï¿½ï¿½ï¿½ï¿½ï¿½é‚±ï¿½Æ‚É‚ï¿½ï¿½ï¿½ÄAï¿½Ü‚ï¿½ï¿½Å‚ï¿½dï¿½vï¿½È‚ï¿½ï¿½Æ‚Æ‚ï¿½ï¿½ÄAï¿½Nï¿½ï¿½ï¿½Xï¿½^ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½ê‚½ï¿½Tï¿½[ï¿½oï¿½[ï¿½Å‚Ìƒï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½\`ï¿½ï¿½ï¿½Ìï¿½ï¿½sï¿½ï¿½ï¿½Tï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½é‚±ï¿½Æ‚É‚ï¿½ï¿½ï¿½ÄAXLL ï¿½Ìƒpï¿½tï¿½Hï¿½[ï¿½}ï¿½ï¿½ï¿½Xï¿½Í‚ï¿½ï¿½ï¿½ÉŒï¿½ï¿½ã‚µï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p109">The Excel C API is the ideal choice when you want to create high-performance worksheet functions by creating XLL add-ins. The C API provides you with the most direct access to worksheet data. XLLs provide Excel with the most direct access to the DLL resources. The performance of XLLs is further enhanced in Excel 2013 by the addition of new data types and, most importantly, support for running user-defined functions on clustered servers.</span></span>
  
<span data-ttu-id="b32de-p110">XLL ã®ä½¿ç”¨ã«ã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã™ã€‚C API ã«ã¯ã€VBAã€COMã€.NET Framework ã«ã‚ã‚‹ã€ã‹ãªã‚Šé«˜ãƒ¬ãƒ™ãƒ«ã®è¿…é€Ÿãªé–‹ç™ºæ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ¡ãƒ¢ãƒªç®¡ç†ã¯ä½ãƒ¬ãƒ™ãƒ«ã§è¡Œã‚ã‚Œã‚‹ã®ã§ã€é–‹ç™ºè€…ã«ã‚ˆã‚Šå¤§ããªè²¬ä»»ã‚’è² ã‚ã›ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚COM çµŒç”±ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹å¤šãã® Excel æ©Ÿèƒ½ã¯ã€VBA ã¨.NET Framework ã‚’ä»‹ã—ã¦åˆ©ç”¨ã§ãã¾ã™ãŒã€C API ã«ã¯å…¬é–‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p110">Working with XLLs comes at a cost: The C API has none of the higher-level rapid development features of VBA, COM, or the .NET Framework. Memory management is low level and, therefore, puts greater responsibility on the developer. Many Excel features that are exposed via COM, making them available through VBA and the .NET Framework, are not exposed to the C API.</span></span>
  
### <a name="accessing-multithreaded-servers-by-using-xll-worksheet-functions"></a><span data-ttu-id="b32de-136">XLL ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆé–¢æ•°ã‚’ä½¿ç”¨ã—ãŸãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ ã‚µãƒ¼ãƒãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹</span><span class="sxs-lookup"><span data-stu-id="b32de-136">Accessing Multithreaded Servers by Using XLL Worksheet Functions</span></span>

<span data-ttu-id="b32de-p111">Excel 2007 ã§å°å…¥ã•ã‚ŒãŸã€ãƒãƒ«ãƒ ã‚¹ãƒ¬ãƒƒãƒ‰å†è¨ˆç®— (MTR) ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¹ãƒ¬ãƒƒãƒ‰ ã‚»ãƒ¼ãƒ•ãª XLL ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆé–¢æ•°ã‚’ä½œæˆã§ãã¾ã™ã€‚ãƒãƒ«ãƒ ã‚¹ãƒ¬ãƒƒãƒ‰ ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ã«ã€ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦³å¯Ÿã™ã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã©ã®ã‚ˆã†ã«å¤§å¹…ã«å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚’è©³ç´°ã«èª¬æ˜ã—ã¾ã™ã€‚å‡¦ç†èƒ½åŠ›ã‚’å¤§é‡ã«æ¶ˆè²»ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ Excel ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã€MTR ã‚’ä½¿ç”¨ã™ã‚‹ XLL ã¨å¼·åŠ›ãªè¨ˆç®—ã‚µãƒ¼ãƒãƒ¼ã®çµ„ã¿åˆã‚ã›ã¯ã€æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p111">Multithreaded recalculation (MTR), which was introduced in Excel 2007, enables you to create thread-safe XLL worksheet functions. You can use these functions to access multithreaded servers. Later sections describe more fully how this can dramatically increase the performance observed by the user. For Excel users who sometimes need access to a lot of processing power, the combination of an XLL that uses MTR and a powerful calculation server provides the highest-performance solution.</span></span>
  
### <a name="customizing-the-excel-user-interface"></a><span data-ttu-id="b32de-141">Excel ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</span><span class="sxs-lookup"><span data-stu-id="b32de-141">Customizing the Excel User Interface</span></span>

<span data-ttu-id="b32de-p112">Excel ã®å¤šãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€C API ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹éš›ã«ã€æœ€é©ãªé¸æŠè‚¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚VBA ã¯ã€Excel ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¤ãƒ™ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚Excel 2007 ã§å°å…¥ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¯ã€å¤–è¦³ã¨åŸºæœ¬æŠ€è¡“ã®ä¸¡é¢ã§ã€ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã¯å¤§ããç•°ãªã‚Šã¾ã™ã€‚ãƒãƒãƒ¼ã‚¸ ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æœ€é©ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p112">For many versions of Excel, the C API has not been the best choice for customizing the user interface. VBA has superior access to Excel objects and events. The user interface introduced in Excel 2007 is significantly different from earlier versions both in appearance and underlying technology. You can best customize this interface by using managed code resources.</span></span>
  
### <a name="creating-applications-that-can-be-accessed-on-the-internet"></a><span data-ttu-id="b32de-146">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ</span><span class="sxs-lookup"><span data-stu-id="b32de-146">Creating Applications that Can Be Accessed on the Internet</span></span>

<span data-ttu-id="b32de-p113">2007 Microsoft Office system ã§å°å…¥ã•ã‚ŒãŸ Excel Services ã§ã¯ã€æ¨™æº–ã® Web ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ–ãƒƒã‚¯ã¨ Excel ã®æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æœ€å–„ã®æ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚.NET Framework é–‹ç™ºè¨€èªã¨ãƒªã‚½ãƒ¼ã‚¹ã¨å…±ã«ã€ã“ã‚Œã‚‰ã®æŠ€è¡“ã¯å°†æ¥ã«æ¸¡ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ Excel å±•é–‹ã®é‡è¦ãªéƒ¨åˆ†ã«ãªã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p113">Excel Services, introduced with the 2007 Microsoft Office system, provides the best way to give users access to workbooks and Excel functionality by using standard Web browser tools. Together with .NET Framework development languages and resources, these technologies represent an important part of Excel deployment to users in the future.</span></span>
  
### <a name="controlling-excel-from-external-applications"></a><span data-ttu-id="b32de-149">å¤–éƒ¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã® Excel ã®åˆ¶å¾¡</span><span class="sxs-lookup"><span data-stu-id="b32de-149">Controlling Excel from External Applications</span></span>

<span data-ttu-id="b32de-p114">Excel ã¯ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚’ COM ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹çµŒç”±ã§å…¬é–‹ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€Excel ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¦åˆ¶å¾¡ã—ãŸã‚Šã€æ—¢å­˜ã® Excel ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ¶å¾¡ã—ãŸã‚Šã™ã‚‹ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã« COM ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚C++ ã¨ VBA ã‚’å«ã‚€ã€ã„ãã¤ã‹ã®é–‹ç™ºè¨€èªã§ COM ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ Excel ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚C# ã¨ .NET Framework ã§ã¯ã€åŒæ§˜ã« Excel ã¸ã®ãƒªãƒ¢ãƒ¼ãƒˆ ã‚¢ã‚¯ã‚»ã‚¹ã¨åˆ¶å¾¡ã‚’å¯èƒ½ã«ã™ã‚‹ Excel ã¸ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p114">Excel exposes its objects, methods, and events through the COM interface. You can, therefore, use COM to create stand-alone applications that can start and control an Excel session or control an existing Excel session. You can access the COM-exposed Excel interface within several development languages, including C++ and VBA. C# and the .NET Framework similarly provide an interface to Excel that enables remote access to and control of Excel.</span></span>
  
## <a name="asynchronous-calling-of-excel"></a><span data-ttu-id="b32de-154">Excel ã®éåŒæœŸå‘¼ã³å‡ºã—</span><span class="sxs-lookup"><span data-stu-id="b32de-154">Asynchronous Calling of Excel</span></span>

<span data-ttu-id="b32de-p115">Excel ã¯ XLL ã«åˆ¶å¾¡ã‚’ã™ã§ã«æ¸¡ã—ã¦ã„ã‚‹å ´åˆã«ã®ã¿ã€XLL ãŒ C API ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚Excel ãŒå‘¼ã³å‡ºã™ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆé–¢æ•°ã¯ã€C API ã‚’ä½¿ç”¨ã—ã¦ Excel ã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã¾ã™ã€‚Excel ãŒå‘¼ã³å‡ºã™ XLL ã‚³ãƒãƒ³ãƒ‰ã¯ã€C API ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚VBA ãã‚Œè‡ªä½“ãŒ Excel ã«ã‚ˆã£ã¦å‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ãã« VBA ãŒå‘¼ã³å‡ºã™ DLLã€XLL é–¢æ•°ã€ã‚³ãƒãƒ³ãƒ‰ã¯ã€C API ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€æ™‚é–“æŒ‡å®šã® Windows ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ XLL ã«è¨­å®šã—ã€ãã® XLL ã‹ã‚‰ C API ã‚’å‘¼ã³å‡ºã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã¾ãŸã€XLL ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒãƒƒã‚¯ ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰ C API ã‚’å‘¼ã³å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã€‚DLL ã¾ãŸã¯ XLL ã‹ã‚‰ COM ã‚’ä½¿ç”¨ã—ã¦éåŒæœŸã« Excel ã‚’å‘¼ã³å‡ºã™ã“ã¨ã¯ãŠå‹§ã‚ã§ãã¾ã›ã‚“ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p115">Excel allows XLLs to call the C API only when Excel has passed control to the XLL. A worksheet function that is called by Excel can call back into Excel by using the C API. An XLL command that is called by Excel can call the C API. DLL and XLL functions and commands that are called by VBA when VBA has itself been called by Excel can call the C API. You cannot, for example, set a timed Windows callback into your XLL and call the C API from it, and you cannot call the C API from a background thread created by your XLL. Calling Excel asynchronously by using COM from a DLL or XLL is not recommended.</span></span>
  
<span data-ttu-id="b32de-p116">ã‚¤ãƒ™ãƒ³ãƒˆã«éåŒæœŸã«å¿œç­”ã™ã‚‹ Excel ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹å ´åˆã€ã“ã‚Œã«ã¯å¤šãã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ã€Excel ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã‚’å–å¾—ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«å†è¨ˆç®—ã™ã‚‹ã‚ˆã†ã«ã—ãŸã„ã¨ã—ã¾ã™ã€‚ã‚ã‚‹ã„ã¯ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¹ãƒ¬ãƒƒãƒ‰ã§è¨ˆç®—ã‚’å®Ÿè¡Œã—ã€ãã®çµ‚äº†æ™‚ã« Excel ãŒå†è¨ˆç®—ã™ã‚‹ã‚ˆã†ã«ã—ãŸã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p116">This is very limiting because there may be applications in which you want Excel to react to an event asynchronously. For example, you might want Excel to retrieve a piece of data on the Internet and recalculate whenever that data changes. Or you might want a background thread to perform a calculation and have Excel recalculate when it is finished.</span></span>
  
<span data-ttu-id="b32de-p117">Excel ãŒå¤‰æ›´ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ãƒãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°å®Ÿç¾ã§ãã¾ã™ãŒã€ã“ã‚Œã¯ Excel ãŒé »ç¹ã«é€šå¸¸ã®å‡¦ç†ã‚’ä¸­æ–­ã™ã‚‹ã®ã§åŠ¹ç‡çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã—ã€åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚ç†æƒ³çš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€C API ã¾ãŸã¯ VBA ã‚’ä½¿ç”¨ã—ã¦ã€æ™‚é–“æŒ‡å®šã§ç¹°ã‚Šè¿”ã™ã‚³ãƒãƒ³ãƒ‰ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p117">You can do this by having Excel actively poll for changes, but this is inefficient and limiting because it involves Excel frequently interrupting its regular activity. You can set up repeated timed command using the C API or VBA, although this is not an ideal solution.</span></span>
  
<span data-ttu-id="b32de-p118">ç†æƒ³çš„ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ã‚’æ¤œå‡ºã—ã€Excel ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¦æ›´æ–°ã®å–å¾—ã¨å†è¨ˆç®—ã‚’å®Ÿè¡Œã•ã›ã‚‹ã€ã‚ˆã‚ŠåŠ¹ç‡çš„ãªå¤–éƒ¨ãƒ—ãƒ­ã‚»ã‚¹ãŒæœ›ã¾ã‚Œã¾ã™ã€‚COM ã‚’ä½¿ç”¨ã—ã¦ Excel ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä»‹ã—ã¦æ¥ç¶šã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã“ã‚Œã‚’å®Ÿç¾ã§ãã¾ã™ã€‚Excel ãŒæ˜ç¤ºçš„ã«åˆ¶å¾¡ã‚’æ¸¡ã™å ´åˆã«ã®ã¿å‘¼ã³å‡ºã™ C API ã¨åŒã˜ã‚ˆã†ãªåˆ¶é™ã¯ COM ã«ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒœãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãŸã‚Šã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã•ã‚Œã¦ã„ãŸã‚Šã€ãƒã‚¯ãƒ­ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã—ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€Excel ãŒæº–å‚™å®Œäº†çŠ¶æ…‹ã®ã¨ãã«ã¯ã„ã¤ã§ã‚‚ã€COM ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ Excel ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p118">Ideally you would want a more efficient external process to check for the change in data, and for that external process to trigger Excel to retrieve the update and perform a recalculation. You can do this by using an application that interfaces to Excel by using COM. COM is not restricted in the same manner as the C API to making calls only when Excel has explicitly passed it control. COM applications can invoke Excel methods whenever Excel is in a ready state, although these method calls might be ignored if dialog boxes are being displayed, menus are pulled down, or when a macro is executing.</span></span>
  
## <a name="c-api-and-its-relation-to-xlm"></a><span data-ttu-id="b32de-170">C API ã¨ XLM ã¨ã®é–¢ä¿‚</span><span class="sxs-lookup"><span data-stu-id="b32de-170">C API and Its Relation to XLM</span></span>

<span data-ttu-id="b32de-p119">Excel ï¿½}ï¿½Nï¿½ï¿½ (XLM) ï¿½ï¿½ï¿½ï¿½ÍAExcel ï¿½Å’ñ‹Ÿ‚ï¿½ï¿½ê‚½ï¿½Aï¿½ï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½pï¿½Å‚ï¿½ï¿½ï¿½Åï¿½ï¿½Ìƒvï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½Å‚ï¿½ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½[ï¿½Uï¿½[ï¿½ÍAï¿½Êï¿½Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½Éï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ï¿½Ê‚Èƒ}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½ÅAï¿½Æï¿½ï¿½ÌƒRï¿½}ï¿½ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½ì¬ï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½BExcel 2013 ï¿½Å‚ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ XLM ï¿½}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½Tï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½B **SUM** ï¿½ï¿½ **LOG** ï¿½È‚Ç‚Ì’Êï¿½Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½×‚Ä‚ï¿½}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½Ågï¿½pï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½Éƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½É“ï¿½ï¿½Í‚ï¿½ï¿½é‚±ï¿½Æ‚Í‚Å‚ï¿½ï¿½È‚ï¿½ï¿½ï¿½ï¿½Ìï¿½ï¿½Ú‚ï¿½}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½Å‚Ígï¿½pï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p119">The Excel macro (XLM) language was the first user-accessible programming environment provided in Excel. It enabled users to create custom commands and functions on special macro sheets that look like ordinary worksheets. XLM macro sheets are still supported in Excel 2013. You can use all the usual worksheet functions like **SUM** and **LOG** on a macro sheet, in addition to the following items that cannot be entered on a worksheet:</span></span> 
  
- <span data-ttu-id="b32de-175">ï¿½ï¿½ï¿½[ï¿½Nï¿½Xï¿½yï¿½[ï¿½Xï¿½ï¿½ï¿½ï¿½ ( **GET.CELL**ï¿½A **GET.WORKBOOK** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-175">Workspace information functions such as **GET.CELL** and **GET.WORKBOOK**.</span></span>
    
- <span data-ttu-id="b32de-176">ï¿½Êï¿½Ìƒï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½ï¿½ï¿½Ìï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\ï¿½É‚ï¿½ï¿½ï¿½Aï¿½Rï¿½}ï¿½ï¿½ï¿½hï¿½Æ“ï¿½ï¿½ï¿½ï¿½ÌŠï¿½ ( **DEFINE.NAME**ï¿½A **PASTE** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-176">Command-equivalent functions that enable automation of ordinary user operations such as **DEFINE.NAME** and **PASTE**.</span></span>
    
- <span data-ttu-id="b32de-177">ï¿½Aï¿½hï¿½Cï¿½ï¿½ï¿½ÉŠÖ˜Aï¿½ï¿½ï¿½ï¿½ï¿½ ( **REGISTER** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-177">Functions that relate to add-ins such as **REGISTER**.</span></span>
    
- <span data-ttu-id="b32de-178">ï¿½Rï¿½}ï¿½ï¿½ï¿½hï¿½Æ“ï¿½ï¿½ï¿½ï¿½ÌƒCï¿½xï¿½ï¿½ï¿½g ï¿½gï¿½ï¿½ï¿½bï¿½v ( **ON.ENRTY**ï¿½A **ON.TIME** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-178">Command-equivalent event traps such as **ON.ENRTY** and **ON.TIME**.</span></span>
    
- <span data-ttu-id="b32de-179">ï¿½}ï¿½Nï¿½ï¿½ï¿½ï¿½ï¿½Å—Lï¿½Ì‘ï¿½ï¿½ï¿½ ( **ARGUMENT**ï¿½A **VOLATILE** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-179">Macro function-specific operations such as **ARGUMENT** and **VOLATILE**.</span></span>
    
- <span data-ttu-id="b32de-180">ï¿½tï¿½ï¿½ï¿½[ï¿½ï¿½ï¿½ä‘€ï¿½ï¿½ ( **GOTO**ï¿½A **RETURN** ï¿½È‚ï¿½)ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-180">Flow-control operations such as **GOTO** and **RETURN**.</span></span>
    
<span data-ttu-id="b32de-p120">Excel ï¿½oï¿½[ï¿½Wï¿½ï¿½ï¿½ï¿½ 3 ï¿½É‚ÍAC API ï¿½Ì‹@ï¿½\ï¿½ï¿½ï¿½ï¿½ï¿½Å‚ï¿½ï¿½ï¿½ï¿½İ‚ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½AExcel ï¿½oï¿½[ï¿½Wï¿½ï¿½ï¿½ï¿½ 4 ï¿½Å‚ÍAXLM ï¿½ï¿½ï¿½ê‚ª C API ï¿½Éƒ}ï¿½bï¿½vï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½È~ï¿½ADLL ï¿½Í‚ï¿½ï¿½×‚Ä‚Ìƒï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½Aï¿½}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½Aï¿½Rï¿½}ï¿½ï¿½ï¿½hï¿½Aï¿½Cï¿½xï¿½ï¿½ï¿½g ï¿½gï¿½ï¿½ï¿½bï¿½vï¿½Ìİ’ï¿½ï¿½Ä‚Ñoï¿½ï¿½ï¿½ï¿½ï¿½Æ‚ï¿½ï¿½\ï¿½É‚È‚ï¿½Ü‚ï¿½ï¿½ï¿½ï¿½BDLL ï¿½ÍAC API ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ XLM ï¿½tï¿½ï¿½ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä‚Ñoï¿½ï¿½ï¿½ï¿½ï¿½Æ‚Í‚Å‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½Ìƒ}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½ÍAï¿½wï¿½ï¿½ï¿½v ï¿½tï¿½@ï¿½Cï¿½ï¿½ XLMacr8.hlp (ï¿½È‘Oï¿½ï¿½ Macrofun.hlp ï¿½Æ‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½Å‚ï¿½ï¿½ï¿½) ï¿½É‹Lï¿½Ú‚ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½Ìƒwï¿½ï¿½ï¿½v ï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½è‚·ï¿½ï¿½É‚ÍAï¿½u[Microsoft ï¿½_ï¿½Eï¿½ï¿½ï¿½ï¿½ï¿½[ï¿½h ï¿½Zï¿½ï¿½ï¿½^ï¿½[](https://download.microsoft.com)ï¿½vï¿½ÉˆÚ“ï¿½ï¿½ï¿½ï¿½A"XLMacr8.hlp" ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p120">A limited version of the C API existed in Excel version 3. However, in Excel version 4, the XLM language was mapped to the C API. Since then, DLLs have been able to call all worksheet functions, macro sheet information functions, and commands, and to set event traps. DLLs cannot call XLM flow control functions from within the C API. These macro-sheet functions and commands are documented in the Help file XLMacr8.hlp (formerly named Macrofun.hlp). To obtain this help file, go to the [Microsoft Download Center](https://download.microsoft.com) and search for "XLMacr8.hlp".</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b32de-187">[!ï¿½ï¿½ï¿½ï¿½] Windows Vista ï¿½ï¿½ Windows 7 ï¿½ÍAï¿½ï¿½ï¿½Ú‚É‚ï¿½ .hlp ï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½Tï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½Ä‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½Ìƒtï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½Jï¿½ï¿½ï¿½ï¿½ï¿½Æ‚Ì‚Å‚ï¿½ï¿½ï¿½ [Windows Vista ï¿½pï¿½ï¿½ Windows ï¿½wï¿½ï¿½ï¿½v ï¿½vï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½ï¿½ (WinHlp32.exe)]([](https://go.microsoft.com/fwlink/?LinkID=82148)ï¿½A[Windows 7 ï¿½pï¿½ï¿½ Windows ï¿½wï¿½ï¿½ï¿½v ï¿½vï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½ï¿½ (WinHlp32.exe)](https://www.microsoft.com/download/en/details.aspx?id=91) ï¿½ï¿½ Microsoft ï¿½ï¿½ï¿½ï¿½_ï¿½Eï¿½ï¿½ï¿½ï¿½ï¿½[ï¿½hï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-187">Windows Vista and Windows 7 do not directly support .hlp files, but you can download the [Windows Help program (WinHlp32.exe) for Windows Vista](https://go.microsoft.com/fwlink/?LinkID=82148) or the [Windows Help program (WinHlp32.exe) for Windows 7](https://www.microsoft.com/download/en/details.aspx?id=91) from Microsoft that enables them to be opened.</span></span> 
  
<span data-ttu-id="b32de-p121">DLL ï¿½ÍAï¿½Rï¿½[ï¿½ï¿½ï¿½oï¿½bï¿½Nï¿½ï¿½ **Excel4**ï¿½A **Excel4v**ï¿½A **Excel12**ï¿½A **Excel12v** (ï¿½ÅŒï¿½ï¿½ 2 ï¿½ÍAExcel 2007 ï¿½Å“ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ê‚½) ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ÄAï¿½ï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½É‘Î‰ï¿½ï¿½ï¿½ï¿½ï¿½ C API ï¿½ï¿½Ä‚Ñoï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½eï¿½ï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½É‘Î‰ï¿½ï¿½ï¿½ï¿½ï¿½ñ‹“Œ^ï¿½Ì’è”ï¿½ÍAï¿½wï¿½bï¿½_ï¿½[ ï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Å’ï¿½\`ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 1 ï¿½Æ‚ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ÌƒRï¿½[ï¿½ï¿½ï¿½oï¿½bï¿½Nï¿½É“nï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½Æ‚ï¿½ï¿½A **xlfGetCell** ï¿½É‘Î‰ï¿½ï¿½ï¿½ï¿½ï¿½ **GET.CELL**ï¿½A **xlfRegister** ï¿½É‘Î‰ï¿½ï¿½ï¿½ï¿½ï¿½ **REGISTER**ï¿½A **xlcDefineName** ï¿½É‘Î‰ï¿½ï¿½ï¿½ï¿½ï¿½ **DEFINE.NAME** ï¿½Å‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p121">DLLs call C API equivalents of these functions and commands by using the callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v** (the last two were introduced in Excel 2007). Enumerated constants that correspond to each function and command are defined in a header file and passed as one of the arguments to these callbacks. For example, **GET.CELL** is represented by **xlfGetCell**, **REGISTER** by **xlfRegister**, and **DEFINE.NAME** by **xlcDefineName**.</span></span>
  
<span data-ttu-id="b32de-p122">ï¿½ï¿½ï¿½[ï¿½Nï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½Aï¿½}ï¿½Nï¿½ï¿½ ï¿½Vï¿½[ï¿½gï¿½ï¿½ï¿½Aï¿½Rï¿½}ï¿½ï¿½ï¿½hï¿½ï¿½ñ‹Ÿ‚ï¿½ï¿½é‚±ï¿½Æ‚É‰ï¿½ï¿½ï¿½ï¿½ÄAC API ï¿½ï¿½ DLL ï¿½ï¿½ï¿½ï¿½ç‚±ï¿½ï¿½ï¿½ÌƒRï¿½[ï¿½ï¿½ï¿½oï¿½bï¿½Nï¿½ï¿½gï¿½pï¿½ï¿½ï¿½é‚±ï¿½Æ‚É‚ï¿½ï¿½ï¿½Ä‚Ì‚Ä‚Ñoï¿½ï¿½ï¿½ï¿½ï¿½Æ‚ï¿½ï¿½Å‚ï¿½ï¿½ï¿½ï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½Ì—ñ‹“‘Ì‚ï¿½ñ‹Ÿ‚ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½Æ‚ï¿½ï¿½A **xlGetName** ï¿½ÍADLL ï¿½ï¿½ Excel ï¿½ÉŠï¿½ï¿½ÆƒRï¿½}ï¿½ï¿½ï¿½hï¿½ï¿½oï¿½^ï¿½ï¿½ï¿½ï¿½ê‡ï¿½É•Kï¿½vï¿½Æ‚ï¿½ï¿½ï¿½ADLL ï¿½ï¿½ï¿½Ì‚ÌŠï¿½ï¿½Sï¿½pï¿½Xï¿½Æƒtï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½oï¿½Å‚ï¿½ï¿½ï¿½æ‚¤ï¿½É‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-p122">In addition to providing the worksheet functions and macro-sheet functions and commands, the C API provides function and command enumerations that can be called only by using these callbacks from within a DLL. For example, **xlGetName** enables the DLL to find out its own the full path and file name, which is required when you register functions and commands with Excel.</span></span> 
  
<span data-ttu-id="b32de-p123">Excel ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5 ã§ã® Visual Basic for Applications (VBA) ã‚·ãƒ¼ãƒˆã®å°å…¥ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 8 (Excel 97) ã§ã® Visual Basic Editor (VBE) ã®å°å…¥ä»¥é™ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ Excel ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹æœ€ã‚‚å®¹æ˜“ãªæ–¹æ³•ã¯ã€XLM ã®ä»£ã‚ã‚Šã« VBA ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€Excel ã®ãã‚Œä»¥é™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å°å…¥ã•ã‚ŒãŸæ–°ã—ã„æ©Ÿèƒ½ã®å¤šãã¯ã€XLM ã¾ãŸã¯ C API ã‚’ä»‹ã—ã¦ã§ã¯ãªã VBA ã‚’ä»‹ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€ã„ãã¤ã‹ã®ã‚³ãƒãƒ³ãƒ‰ã€ã‚¤ãƒ™ãƒ³ãƒˆ ãƒˆãƒ©ãƒƒãƒ—ã€æ‹¡å¼µãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒœãƒƒã‚¯ã‚¹æ©Ÿèƒ½ã¯ã€XLM ã¾ãŸã¯ C API ã‚’ä»‹ã—ã¦ã§ã¯ãªãã€VBA ã‚’ä»‹ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="b32de-p123">Since the introduction of Visual Basic for Applications (VBA) sheets in Excel version 5, and the Visual Basic Editor (VBE) in version 8 (Excel 97), the easiest way for users to customize Excel is to use VBA instead of XLM. Consequently, much of the new functionality introduced in later versions of Excel is available through VBA, but not through XLM or the C API. For example, several commands, event traps, and enhanced dialog box capabilities are available through VBA, but not through XLM or the C API.</span></span>
  
<span data-ttu-id="b32de-196">ï¿½Ú‚ï¿½ï¿½ï¿½ï¿½ÍAï¿½u[Excel ï¿½p C API ï¿½ÌVï¿½@ï¿½[](what-s-new-in-the-c-api-for-excel.md)(what-s-new-in-the-c-api-for-excel.md)ï¿½vï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="b32de-196">For more information, see [What's New in the C API for Excel](what-s-new-in-the-c-api-for-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b32de-197">é–¢é€£é …ç›®</span><span class="sxs-lookup"><span data-stu-id="b32de-197">See also</span></span>



[<span data-ttu-id="b32de-198">Excel ç”¨ C API ã®æ–°æ©Ÿèƒ½</span><span class="sxs-lookup"><span data-stu-id="b32de-198">What's New in the C API for Excel</span></span>](what-s-new-in-the-c-api-for-excel.md)
  
[<span data-ttu-id="b32de-199">C API ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•° Excel4ã€Excel12</span><span class="sxs-lookup"><span data-stu-id="b32de-199">C API Callback Functions Excel4, Excel12</span></span>](c-api-callback-functions-excel4-excel12.md)


[<span data-ttu-id="b32de-200">Excel XLL SDK ã®æ¦‚è¦</span><span class="sxs-lookup"><span data-stu-id="b32de-200">Getting Started with the Excel XLL SDK</span></span>](getting-started-with-the-excel-xll-sdk.md)

