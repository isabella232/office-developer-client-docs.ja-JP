---
title: 数式について
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251823
ms.localizationpriority: medium
ms.assetid: ec0de3e1-21dc-c5d6-2c2a-d5fef80d89bd
description: 図形のアクションを制御するには、必要な動作を定義する数式を記述します。セルの数式を編集すると、そのセルの値を変更し、結果的に特定の図形の動作を変更できます。たとえば、[Shape Transform] セクションの [Height] セルに含まれる数式を変更すると、その図形の高さを変更できます。
ms.openlocfilehash: 31585f7da6170628da7e41455c448e417b48d823
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59598893"
---
# <a name="about-formulas"></a>数式について

図形のアクションを制御するには、必要な動作を定義する数式を記述します。セルの数式を編集すると、そのセルの値を変更し、結果的に特定の図形の動作を変更できます。たとえば、[Shape Transform] セクションの [Height] セルに含まれる数式を変更すると、その図形の高さを変更できます。
  
Microsoft Visio の数式は、多くの点で一般的なスプレッドシートの数式と類似しています。Visio では、数値や簡単なセル参照なども含め、セル内の情報はすべて数式として扱われます。
  
セル内の数式は、マスター シェイプまたはスタイルの対応するセルから継承することも、ユーザーが独自に定義することもできます。数式が評価されると、その結果がセルに適した値と単位に変換されます。[シェイプシート] ウィンドウでは、セルの内容を数式または値で表示できます。
  
## <a name="elements-of-a-formula"></a>数式の要素

数式の先頭には、常に等号が自動的に挿入されます。数式には次の要素を使用できます。
  
- 数値
    
- Coordinates
    
- ブール値
    
- 演算子
    
- 関数
    
- 文字列
    
- セル参照
    
- 単位
    
## <a name="default-formulas"></a>既定の数式

図形を作成すると、その図形に関する既定の数式が作成されます。既定の数式を確認するには、単純な図形 (四角形、楕円、直線など) を描画し、その [シェイプシート] ウィンドウを開きます。[シェイプシート] ウィンドウを開くには、図形を選択して、[[開発](run-in-developer-mode-display-the-developer-tab.md)] タブの [**シェイプシートの表示**] をクリックします。
  
## <a name="inherited-formulas"></a>継承された数式

Visio では、可能である場合には数式が継承されます。インスタンスにすべての数式のローカル コピーを作成するのではなく、インスタンスは図面ステンシルのマスター シェイプから数式を継承し、図面に保存されているスタイルの定義から書式設定を継承します。この動作によって、ファイルのサイズが小さくなり、マスター シェイプの数式やスタイルの定義に対する変更を、すべてのインスタンスに反映することが可能になります。
  
セル内の黒いテキストは、継承された数式を表します。
  
## <a name="local-formulas"></a>ローカルの数式

インスタンスにローカルの数式を記述するということは、セル内の継承された数式が、ユーザーが定義する数式に置き換わるということです。この操作を行うと、マスター シェイプまたはスタイルにあるセルを今後変更しても、このインスタンスは影響を受けません。これは、ローカルの数式を含んだセルに対しては、継承がブロックされるためです。
  
関連するセルのローカルの数式は、GUARD 関数を使用して保護しない限り、スタイルを適用するとすべて削除されます。
  
青いテキストはローカルの数式を表します。これは [シェイプシート] ウィンドウで数式を編集したか、図形に変更を加えたことにより、セルの数式がリセットされたことを示します。
  
## <a name="automatic-updates-to-formulas"></a>数式の自動更新

 図面で図形を変更した場合、常に特定のセルが自動的に更新されます。これは、場合によっては入力した数式が置き換わる可能性があることを意味しています。たとえば、コーナー ハンドルをドラッグして図形のサイズを変更すると、[PinX]、[PinY]、[Width]、[Height] の各セルで数式がリセットされます。 
  
必要に応じて、GUARD 関数を使用して数式が変更されないように保護できます。
  

