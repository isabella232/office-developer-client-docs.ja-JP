---
title: 演算子について
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251824
ms.localizationpriority: medium
ms.assetid: 43128ea2-c0d9-c45f-31e6-768a80ae59b2
description: 数式で演算子を使用すると、算術演算 (加算、減算、乗算など) や論理的な比較 (より大きい、より小さい、等しいなど) を実行できます。また式をかっこで囲むことで、数式内の評価の順序を制御できます。文字列を結合 (連結) するには、アンパサンド演算子を使用します。
ms.openlocfilehash: 81829e04445652ce45b3b1ff92339b2090c2fcb9
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59619177"
---
# <a name="about-operators"></a>演算子について

数式で演算子を使用すると、算術演算 (加算、減算、乗算など) や論理的な比較 (より大きい、より小さい、等しいなど) を実行できます。また式をかっこで囲むことで、数式内の評価の順序を制御できます。文字列を結合 (連結) するには、アンパサンド演算子を使用します。
  
Microsoft Visio では、演算や関数で特定の種類のデータが必要な場合、自動的にデータの種類が変換されます。たとえば、乗算演算子は数値の引数を必要とし、アンパサンド (文字列連結) 演算子は文字列の引数を必要とします。引数を必要なデータの種類に変換できない場合、既定値が使用されます。この既定値とは、それぞれのデータの種類で "なし" に相当する値を示します。たとえば、数値ではゼロ、ブール値では FALSE、文字列では "" になります。
  
次の表は、式とその結果の例です。
  
|**Expression**|**結果**|**説明**|
|:-----|:-----|:-----|
| 2 \* 5 &amp; " cents"  <br/> | "10 cents"  <br/> | 演算子 (文字列連結) には文字列引数が必要なので、2 5 の数値結果は文字列 &amp; \* "10" に自動的に変換されます。  <br/> |
| 5 \* "2"  <br/> | 10  <br/> | 演算子 (乗算) には数値引数が必要なので、文字列 "2" は自動的に同等の数値 \* 2 に変換されます。  <br/> |
| 5 \* "ひつじ"  <br/> | 0  <br/> | 演算子 (乗算) には数値引数が必要なので、文字列 "ひつじ" は数値に変換できないので、数値と同等の値としてゼロ \* が使用されます。  <br/> |
   
## <a name="arithmetic-operators"></a>算術演算子

算術演算では、数値に対して計算を行います。プラス (+) およびマイナス (-) 演算子は、数値の符号を設定する単項演算子として単独で使用できます。パーセント (%) 演算子も単項演算子で、数値を割合として識別します。
  
|**演算子**|**操作**|**例**|**結果**|
|:-----|:-----|:-----|:-----|
| +  <br/> | 単項の正  <br/> | +37  <br/> | 37  <br/> |
| -  <br/> | 単項の負  <br/> | -37  <br/> | -37  <br/> |
| %  <br/> | 単項の割合  <br/> | 37%  <br/> | .37  <br/> |
| ^  <br/> | Exponentiation  <br/> | 5 ^ 2  <br/> | 25  <br/> |
| \*  <br/> | 乗算  <br/> | 5 \* 2  <br/> | 10  <br/> |
| /  <br/> | 部署  <br/> | 5 / 2  <br/> | 2.5  <br/> |
| +  <br/> | 追加  <br/> | 5 + 2  <br/> | 7   <br/> |
| -  <br/> | 減算  <br/> | 5 - 2  <br/> | 3  <br/> |
   
## <a name="comparison-operators"></a>比較演算子

比較演算子は、論理式の作成に使用されます。論理式は TRUE または FALSE で評価されます。
  
|**演算子**|**代替手段**|**操作**|**例**|**結果**|
|:-----|:-----|:-----|:-----|:-----|
| \>  <br/> | _GT_  <br/> | より大きい  <br/> | 5 \> 2  <br/> | TRUE  <br/> |
| \<  <br/> | _LT_  <br/> | より少ない  <br/> | 5 \< 2  <br/> | FALSE  <br/> |
| \>=  <br/> | _GE_  <br/> | 大きいまたは等しい  <br/> | 5 \> = 2  <br/> | TRUE  <br/> |
| \<=  <br/> | _LE_  <br/> | 以下  <br/> | 5 \<= 2  <br/> | FALSE  <br/> |
| =  <br/> | _EQ_  <br/> | 等しい  <br/> | 5 = 2  <br/> | FALSE  <br/> |
| \<\>  <br/> | _NE_  <br/> | 等しくない  <br/> | 5 \<\> 2  <br/> | TRUE  <br/> |
   
ほとんどの比較では、 \> 記号比較演算子 \< (、、など) が最適です。 代替演算子 _(GT、LT_ など) は、値を内部的に格納するために使用する精度の完全な 15 Visio比較を実行します。 
  
四捨五入された値や計算された値を代替演算子を使用して比較する場合、本来なら式が TRUE に評価される場合に FALSE が返されることがあります。
  
比較演算子を使用して文字列を比較する場合、文字列は最初に数値に変換されます。文字列が変換できない場合は値 0 が返されます。このため比較が安定せず、予期した結果が得られないことがあります。標準的な文字列比較を行うには、STRSAME または STRSAMEEX 関数を使用します。
  
## <a name="order-of-evaluation"></a>優先順位

数式に複数の式が含まれている場合、実行される演算子に応じた順序で、式が評価されます。次の表は、Visio での演算子の優先順位です。
  
|**Order**|**操作**|**演算子**|
|:-----|:-----|:-----|
|第 1  <br/> |正の値  <br/> |+ (単項)  <br/> |
||負の値  <br/> |- (単項)  <br/> |
||パーセント  <br/> |% (単項)  <br/> |
|秒  <br/> |Exponentiation  <br/> |^  <br/> |
|第 3  <br/> |乗算  <br/> |\*  <br/> |
||部署  <br/> |/  <br/> |
|第 4  <br/> |追加  <br/> |+  <br/> |
||減算  <br/> |-  <br/> |
|5 番目  <br/> |文字列の連結  <br/> |&amp;  <br/> |
|6 番目  <br/> |不等号 (より大きい)  <br/> |\> または GT  <br/> |
||大きいまたは等しい  <br/> |\>= または GE  <br/> |
||より少ない  <br/> |\< or LT  <br/> |
||以下  <br/> |\<= or LE  <br/> |
|7 番目  <br/> |等しい  <br/> |= または EQ  <br/> |
||等しくない  <br/> |\<\> または NE  <br/> |
   
式をかっこで囲んで優先順位を変更できます。最初にかっこ内の式が左から右の順に評価されます。たとえば、次のようになります。
  
4 + 5 \* 6 = 4 + 30 = 34
  
(4 + 5) \* 6 = 9 \* 6 = 54
  
かっこ内の式がネストされている場合、最も内側のかっこ内にある式が最初に評価されます。
  
## <a name="ampersand-operator"></a>アンパサンド演算子

アンパサンド演算子は新しい文字列を返します。アンパサンド演算子を使用して、複合された単語や句を作成できます。次の構文を使用します。
  
"string1" &amp; "string2"
  
 **例**
  
"dog" &amp; "house" が "doghouse" を返す
  

