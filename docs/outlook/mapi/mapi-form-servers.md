---
title: MAPI フォーム サーバー
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 10c71c9cebcc66542846c0631be31d6a893d82f2
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59561243"
---
# <a name="mapi-form-servers"></a>MAPI フォーム サーバー

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
ユーザーの観点から見ると、フォームは通常、メッセージまたはデータ入力フォームのプロパティ シートで、ユーザーは構造化された情報を入力できます。 ただし、メッセージ クラスに関連付けられている任意のユーザー インターフェイスを指定できます。 プログラマの観点から見て、フォームは次の要素で構成されます。
  
- 独自のメッセージ クラスと OLE 識別子を持つ MAPI メッセージの種類。
    
- フォーム サーバーを実装する実行可能ファイル。
    
- フォーム サーバーが使用する MAPI プロパティのコレクション (カスタムまたはそれ以外の場合)。 これらの一部またはすべてがメッセージング クライアントで使用できる場合があります。
    
- フォームを記述し、フォーム マネージャーによって使用される構成ファイル。
    
フォームは [IMessage オブジェクト](imessageimapiprop.md) なので、MAPI メッセージ オブジェクトと一致するプロパティと動作が示されます。 ただし、フォームにはカスタム プロパティ、コントロール、およびアプリケーション固有の表示レンダリングが含まれますので、フォームが使用する MAPI インターフェイスは、必要なインターフェイスの任意の種類を許可するのに十分汎用的です。 フォームの実際の定義はフォーム ライブラリに格納されます。このセクションで後で説明します。 
  
> [!NOTE]
> より正確に言えば、すべてのメッセージは MAPI フォームのインスタンスです。 ただし、一般的な電子メール メッセージを作成および読み取るフォームは最も一般的に使用されるフォームであるから、通常はカスタム フォームをメッセージの特別なケースと考える方が簡単です。 すべてのメッセージが実際にはフォームだけであるという事実は、MAPI システム内の他のメッセージと同じ状態のカスタム フォームを提供します。 
  
すべてのフォームには一連のプロパティがあります。その一部はフォームのユーザー インターフェイスに表示されます。 通常、プロパティはフォームのユーザー インターフェイスのフィールドに一致します。 たとえば、発注書フォームには、[アイテム]、[説明]、[価格]、[税金]、および [小計] というフィールドが含まれます。 これらのフィールドは、単に同じ名前のフォーム プロパティを視覚的にレンダリングします。 クライアントは、MAPI フォーム マネージャーによって実装される [IMAPIFormInfo::CalcFormPropSet](imapiforminfo-calcformpropset.md) メソッドを使用して、特定のメッセージ クラスでサポートされるプロパティを確認します。 
  
基本的なメッセージと同様に、MAPI フォームには、送信者、目的の受信者、メッセージの送信時など、すべての標準メッセージ プロパティを含めることができます。 フォームには、フォームに固有の任意の数のカスタム プロパティを含めることができます。 たとえば、"Bug Report" フォームには、バグの種類、バグの重大度、製品バージョンのカスタム プロパティが含まれている場合があります。
  
フォームを作成するには、フォーム サーバーを実装する必要があります。 フォーム サーバーは、メッセージング クライアントがフォーム サーバーでサポートされている種類のメッセージを表示する必要がある場合に読み込まれる実行可能ファイルです。 フォーム サーバーは、特定のメッセージを表示し、それらのメッセージとのユーザー操作を処理するために必要に応じてフォーム オブジェクトを作成します。
  
すべてのフォーム サーバーには、構成ファイルが関連付けられている。 このファイルには、フォーム マネージャーの利点を得るフォーム サーバーについて説明する情報が含まれている。 フォーム マネージャーは、フォーム サーバーをフォーム ライブラリにインストールするときにこの情報を使用します。
  
フォームのパーツの作成の詳細については、「MAPI フォーム サーバーの [開発」を参照してください](developing-mapi-form-servers.md)。
  
フォーム サーバーは、コンポーネント オブジェクト モデル (COM) に従います。 フォーム サーバーは、インプロック サーバーとしてではなく、スタンドアロンの実行可能ファイルとして実行されます。 詳細については、SDK の「COM および ActiveX オブジェクト サービス」セクションWindowsしてください。
  
一意のクラス識別子 (CLSID) は、各フォーム サーバーを識別します。 クラス識別子とそのメッセージ クラスの間には、常に 1 対 1 のマッピングがあります。 ただし、フォーム サーバーが 1 つのメッセージ クラスのメッセージのみを処理できるわけではありません。 特定のクラスのメッセージを処理するフォーム サーバーがない場合、使用するフォーム マネージャーは、メッセージ クラス階層の上位にあるメッセージ クラスのフォーム サーバーを検索する必要があります。SDK に付属する既定のフォーム マネージャー Windowsこれを行います。 このようなフォーム サーバーは、メッセージのプロパティ (スーパークラスでサポートされているプロパティ) のサブセットのみをレンダリングできる可能性がありますが、何もないよりも優れたものになります。 一致するフォーム サーバーが見つからない場合の処理は、使用するフォーム マネージャーに固有の実装の詳細です。この場合、既定のフォーム マネージャーはメッセージを開かれません。
  
詳細については、「MAPI メッセージ [クラス」を参照してください](mapi-message-classes.md)。
  
## <a name="see-also"></a>関連項目



[MAPI フォーム](mapi-forms.md)

