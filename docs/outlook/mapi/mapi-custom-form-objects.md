---
title: MAPI カスタム フォーム オブジェクト
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: ff73842326134c0e9a7a3e5a98bd0cee9a4c042c
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59595883"
---
# <a name="mapi-custom-form-objects"></a>MAPI カスタム フォーム オブジェクト
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
カスタム フォームのオブジェクトは、次の 3 つの異なるコンポーネントによって実装されます。
  
- フォーム サーバー。
    
- フォーム ライブラリ プロバイダー。
    
- フォーム ビューアー。
    
フォーム サーバーは、OLE 複合ドキュメント オブジェクト アプリケーションと機能が似ています。 フォームを実装する実行可能コンポーネントです。表示と、ユーザーが実行できる操作を制御します。 MAPI は、ユーザーがフォーム サーバーでサポートされているフォームを使用して表示されるメッセージ クラスと共にメッセージを表示する場合に、要求に応じてフォーム サーバーを起動します。 フォーム サーバーは、標準の OLE クラス ファクトリに似たフォーム ファクトリ オブジェクト、フォーム固有のイベントを処理するためのフォームアドバイスシンク、フォーム自体の 3 つのオブジェクトを実装します。 
  
フォーム ライブラリ プロバイダーは、クライアントに対して、フォームのプロパティ セット、コンテナー、および特定のクラスのメッセージをそのクラスのフォームを開くことができるサーバーにリンクするオブジェクトへのアクセスを提供します。 フォーム ライブラリ プロバイダーは、フォーム情報オブジェクト、フォーム コンテナー、およびメッセージのクラスに基づいて適切なフォーム サーバーにメッセージをバインドするためのフォーム マネージャーの 3 つのオブジェクトを実装します。
  
フォーム ビューアーは、フォルダー ビューアーでのカスタム フォームの表示をサポートするクライアントに含まれるコンポーネントです。 フォーム ビューアーは、フォーム ライブラリ プロバイダーやフォーム サーバーと同様に、独立した MAPI コンポーネントではありません。 フォーム ビューアーはフォーム サーバーを起動し、コンテキストを提供します。 フォーム ビューアーは、メッセージ サイト、ビュー コンテキスト、およびビュー固有のイベントを処理するためのアドバイス シンクの 3 つのオブジェクトを実装します。
  
次の表では、すべてのカスタム フォーム オブジェクトについて説明します。 
  
|**Form オブジェクト**|**説明**|
|:-----|:-----|
|フォーム  <br/> |特定のクラスのメッセージを表示するカスタム フォームの表示と操作を制御します。  <br/> |
|フォームのアドバイス シンク  <br/> |フォーム ビューアーからの通知を処理します。  <br/> |
|フォーム ファクトリ  <br/> |フォームのインスタンスを作成し、そのサーバーがメモリ内に残ります。  <br/> |
|フォーム コンテナー  <br/> |フォーム情報が含まれる。  <br/> |
|フォーム情報  <br/> |メッセージと他のメッセージ コンテナーが含まれます。  <br/> |
|フォーム マネージャー  <br/> |インストールされているすべてのフォームに関連するカスタム フォーム情報の統合ビューへのアクセスを提供します。 また、メッセージ クラスと対応するフォーム クラス識別子を一致します。  <br/> |
|メッセージ サイト  <br/> |クライアント内部からのフォーム オブジェクトの操作を処理し、フォーム マネージャー オブジェクトへのアクセスを提供します。  <br/> |
|コンテキストの表示  <br/> |次のメッセージと以前のメッセージをアクティブ化し、保存または印刷するフォーム コマンドをサポートします。  <br/> |
|View アアドバイス シンク  <br/> |フォーム サーバーからの通知を処理します。  <br/> |
   
次の図は、カスタム フォーム コンポーネント、実装するオブジェクトとインターフェイス、およびオブジェクトのユーザーであるコンポーネントの関係を示しています。 他のほとんどの MAPI オブジェクトとは異なり、フォーム オブジェクトは直接継承によって関連付けされない 2 つのインターフェイスを実装しています。 オブジェクトが複数の独立したインターフェイスを公開すると、1 つのインターフェイスへのポインターを持つオブジェクトのユーザーは、他のインターフェイスへのポインターを取得できます。 オブジェクトのインターフェイス実装間を移動する機能は [、IUnknown::QueryInterface メソッドの機能](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) です。 
  
**カスタム フォーム コンポーネント**
  
![カスタム フォーム コンポーネント](media/amapi_67.gif "カスタム フォーム コンポーネント")
  
## <a name="see-also"></a>関連項目

- [MAPI オブジェクトとインターフェイスの概要](mapi-object-and-interface-overview.md)

