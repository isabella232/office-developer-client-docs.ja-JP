---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
ms.localizationpriority: medium
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 1ddc9b68bef81b02b3b9e0f8593cc937348566be
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59591165"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**適用対象**: Outlook 2013 | Outlook 2016 
  
プロファイル ウィザードによって呼び出されるコールバック関数を定義し、プロバイダーのプロパティ シートまたはページが表示されているときにサービス プロバイダーがユーザー イベントに対応できます。 
  
|||
|:-----|:-----|
|ヘッダー ファイル:  <br/> |Mapiwz.h  <br/> |
|定義された関数は、次の方法で実装されます。  <br/> |サービス プロバイダー  <br/> |
|によって呼び出される定義済み関数:  <br/> |MAPI プロファイル ウィザード  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>パラメーター

_hDlg_
  
> [in][プロファイル ウィザード] ダイアログ ボックスのウィンドウ ハンドル。 
    
_wMsgID_
  
> [in]処理するウィンドウ メッセージ。 モーダル ダイアログ ボックスで予期される通常のウィンドウ メッセージに加えて、次のメッセージを受信できます。
    
WM_CLOSE 
  
> プロファイル ウィザードが完了しました。 サービス プロバイダーは、動的に割り当てられたメモリの割り当ての解放など、必要なすべてのクリーンアップを実行する必要があります。 
    
WM_COMMAND 
  
> プロバイダーのコントロールの 1 つが選択されている、または[次へ] または [戻 **る]** ボタンがクリックされています。 _wParam パラメーターの値_ は、これらのユーザー イベントが発生したかどうかを示します。 
    
WM_INITDIALOG 
  
> ユーザーが別のプロパティ ページに移動し、ダイアログ ボックスを初期化する必要があります。 プロバイダーは、プロファイル ウィザードがダイアログ ボックスに追加したコントロールを初期化する必要があります。 
    
WIZ_QUERYNUMPAGES 
  
> プロファイル ウィザードでは、プロバイダーが表示する必要があるページ数を求めるメッセージが表示されます。 プロバイダーは、TRUE または FALSE の代わりにページ数を返す必要があります。 たとえば、次の return ステートメントを使用して、3 つのページを表示する必要があります。
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> [in]ウィンドウ メッセージに関連付けられた 32 ビット のパラメーター。 指定できる値は  _、wMsgID パラメーターで指定されたメッセージによって異_ なっています。 モーダル ダイアログ ボックスの通常のウィンドウ メッセージで予期される値に加えて、次の値を受け取ることができます。 
    
WIZ_NEXT 
  
> _wMsgID に_ WM_COMMAND、ユーザーは [次へ] ボタン **をクリック** します。 
    
WIZ_PREV 
  
> _wMsgID に_ ファイルがWM_COMMAND、ユーザーは [戻る] ボタンを **クリック** します。 
    
_lParam_
  
> [in]ウィンドウ メッセージに関連付けられた 32 ビット のパラメーター。 指定できる値は  _、wMsgID パラメーターで指定されたメッセージによって異_ なっています。 
    
## <a name="return-value"></a>戻り値

**SERVICEWIZARDDLGPROC ベースの関数** によって返される値は、受信したウィンドウ メッセージに依存します。 特に、メッセージの例外の戻り値WIZ_QUERYNUMPAGESしてください。 通常の戻り値は次のとおりです。 
  
TRUE 
  
> サービス プロバイダーが受信ウィンドウ メッセージを処理しました。 
    
FALSE 
  
> サービス プロバイダーは、受信したウィンドウ メッセージを処理していない。
    
## <a name="remarks"></a>注釈

ユーザーがプロパティ ページ間を移動すると、プロバイダーは古いページのコントロールを非表示にし、次のページまたは前のページのコントロールを表示します。 ユーザーが [次へ] ボタンをクリックすると **、SERVICEWIZARDDLGPROC** ベースの関数が _wParam_ パラメーターの WM_COMMAND メッセージと WIZ_NEXTで呼び出されます。 次の手順では、ユーザーが [次へ] をクリックした時刻と、最初のプロバイダーの構成ページが表示される時間の間に発生する処理について説明します。 
  
1. プロファイル ウィザードは、ウィンドウ上にあるコントロールを非表示にします。 
    
2. プロファイル ウィザードは、プロバイダーの非表示のコントロールをページに追加します。 
    
3. プロファイル ウィザードは **SERVICEWIZARDDLGPROC** を呼び出し、プロバイダーがコントロールを初期化WM_INITDIALOGメッセージを送信します。 
    
4. プロファイル ウィザードは **SERVICEWIZARDDLGPROC** を呼び出し、メッセージをWIZ_QUERYNUMPAGESします。 プロバイダーは、表示するページ数を返します。 
    
5. プロファイル ウィザードは **SERVICEWIZARDDLGPROC** を呼び出し  _、wParam_ パラメーターが WIZ_NEXT または WIZ_PREV に設定された WM_COMMAND メッセージを送信します。 この時点で、プロバイダーは FALSE {error} を返すか、コントロールを表示し、TRUE {success} を返します。 プロファイル ウィザードがページにID_NEXT、プロバイダーの最初のページが表示されます。 このID_PREV場合は、最後のページが表示されます。 
    
6. プロファイル ウィザードはプロバイダーの **SERVICEWIZARDDLGPROC** 関数を呼び出し  _、wParam_ パラメーターが WIZ_NEXT または WIZ_PREV に設定された WM_COMMAND メッセージを送信します (ユーザーがクリックしたボタンに応じて異なります)。 プロバイダーは、コントロールを表示または非表示にし、プロファイル ウィザードに渡された **IMAPIProp** にデータを書き込み、一連のページをステップ実行します。 プロバイダーは、次または前のページが正常に表示された場合は TRUE、次のページも前のページも表示しない場合は FALSE を返す必要があります。 プロバイダーは、一連のページの外に出る際に注意し、コントロールを非表示にし、そのデータをプロファイルに書き込んで適切に対応する必要があります。 
    
7. ユーザーがプロバイダーのページ範囲の外側に移動すると、プロファイル ウィザードは、ダイアログ ボックスからプロバイダーの非表示のコントロールを削除し、次のプロバイダーを呼び出したり、最後のプロバイダーである場合は次のページを表示します。 
    

