---
title: MAPI ï¿½Ì“Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6e6c6ad9-1e07-4234-a5ef-18020d7ce468
description: 'ï¿½ÅIï¿½Xï¿½Vï¿½ï¿½: 2011ï¿½N7ï¿½ï¿½23ï¿½ï¿½'
ms.openlocfilehash: c6538f8fef7d8ccb87b6e6d9d2b9c68779ca8582
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801334"
---
# <a name="mapi-attachments"></a><span data-ttu-id="aac58-103">MAPI ï¿½Ì“Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½</span><span class="sxs-lookup"><span data-stu-id="aac58-103">MAPI Attachments</span></span>

  
  
<span data-ttu-id="aac58-104">**é©ç”¨å¯¾è±¡**: Outlook</span><span class="sxs-lookup"><span data-stu-id="aac58-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="aac58-105">ã„ãã¤ã‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ã‚¹ãƒˆã‚¢ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€OLE ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã¾ãŸã¯ãƒã‚¤ãƒŠãƒª ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ã§è¿½åŠ æƒ…å ±ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é–¢é€£ä»˜ã‘ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-105">Some message store providers enable clients to associate added information in the form of files, OLE objects, messages, or binary data with messages.</span></span> <span data-ttu-id="aac58-106">ã“ã®è¿½åŠ æƒ…å ±ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨å‘¼ã°ã‚Œã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-106">This added information is called a message's attachment.</span></span> <span data-ttu-id="aac58-107">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã€ç®¡ç†ã—ã€è‡ªåˆ†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã€ãŸã‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä¸‹ä½ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨è¦‹ãªã•ã‚Œã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-107">Because attachments are created, maintained, and accessed only through their messages, they are considered message subobjects.</span></span> <span data-ttu-id="aac58-108">ã‚¨ãƒ³ãƒˆãƒªè­˜åˆ¥å­ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ã§ã¯ãªãã€æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•°ã¨ã€æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã§é€£ç¶šã—ãŸç•ªå·ã®æ­£å¸¸ãŒã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-108">Rather than having an entry identifier for access, attachments have a sequential number known as an attachment number.</span></span> <span data-ttu-id="aac58-109">ã“ã®ç•ªå·ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…ã§ã¯ãªãã¨ã‚‚ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒ» ã‚¹ãƒˆã‚¢å†…ã®æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ„ã«è­˜åˆ¥ã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-109">This number uniquely identifies the attachment within its message, but not necessarily within the message store.</span></span> <span data-ttu-id="aac58-110">2 ç¨®é¡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•°ãŒåŒã˜åˆ¥ã®æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã¤ã“ã¨ãŒã§ãã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-110">Two different messages can have different attachments with the same attachment number.</span></span> <span data-ttu-id="aac58-111">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé–‹ã‹ã‚Œã¦ã„ã¦ã€ **PR_ATTACH_NUM** ([PidTagAttachNumber](pidtagattachnumber-canonical-property.md)) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹é™ã‚Šã«ã®ã¿æœ‰åŠ¹ã§ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-111">Attachment numbers are only valid as long as the message is open and are stored in the **PR_ATTACH_NUM** ([PidTagAttachNumber](pidtagattachnumber-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="aac58-p102">ï¿½ï¿½ï¿½×‚Ä‚Ìƒï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½Ì“Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½É‚Â‚ï¿½ï¿½Ä‚ÌŠTï¿½vï¿½ï¿½ï¿½ÉƒAï¿½Nï¿½Zï¿½Xï¿½ï¿½ï¿½ï¿½É‚ÍAï¿½Nï¿½ï¿½ï¿½Cï¿½Aï¿½ï¿½ï¿½gï¿½ÍAï¿½ï¿½ï¿½Ì“Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ìƒeï¿½[ï¿½uï¿½ï¿½ï¿½ï¿½æ“¾ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ìƒeï¿½[ï¿½uï¿½ï¿½ï¿½É‚ÍAï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ìï¿½ï¿½Aï¿½ï¿½ï¿½Rï¿½[ï¿½h ï¿½Lï¿½[ï¿½È‚Ç‚É’ï¿½ï¿½ÚƒAï¿½Nï¿½Zï¿½X ï¿½Nï¿½ï¿½ï¿½Cï¿½Aï¿½ï¿½ï¿½gï¿½ï¿½gï¿½pï¿½ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ñ‚ªŠÜ‚Ü‚ï¿½Ü‚ï¿½ï¿½Bï¿½Nï¿½ï¿½ï¿½Cï¿½Aï¿½ï¿½ï¿½gï¿½Å‚Ì“Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ìƒeï¿½[ï¿½uï¿½ï¿½ï¿½ï¿½æ“¾ï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-p102">To access summary information about all of a message's attachments, clients retrieve its attachment table. The attachment table includes information that clients can use to access an attachment directly, such as its attachment number and record key. Clients can retrieve an attachment table by:</span></span>
  
- <span data-ttu-id="aac58-p103">**IMessage::GetAttachmentTable** ï¿½ğ”­Mï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½Ú×‚É‚Â‚ï¿½ï¿½Ä‚ÍA [IMessage::GetAttachmentTable](imessage-getattachmenttable.md)ï¿½ï¿½Qï¿½Æ‚ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-p103">Calling **IMessage::GetAttachmentTable**. For more information, see [IMessage::GetAttachmentTable](imessage-getattachmenttable.md).</span></span>
    
- <span data-ttu-id="aac58-p104">**IMAPIProp::OpenProperty** ï¿½ğ”­Mï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½Ú×‚É‚Â‚ï¿½ï¿½Ä‚ÍA [IMAPIProp::OpenProperty](imapiprop-openproperty.md)ï¿½ï¿½Qï¿½Æ‚ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-p104">Calling **IMAPIProp::OpenProperty**. For more information, see [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span>
    
<span data-ttu-id="aac58-119">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ã‚¹ãƒˆã‚¢ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€ã“ã‚Œã‚‰ã®æ–¹æ³•ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-119">Message store providers are expected to support both of these approaches.</span></span> <span data-ttu-id="aac58-120">**OpenProperty**ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯ã€å‘¼ã³å‡ºã—å…ƒãŒã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ ã‚¿ã‚°ã¨ã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹è­˜åˆ¥å­ã¨**PR_MESSAGE_ATTACHMENTS** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)) ã¨ã—ã¦ IID_IMAPITable ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-120">The **OpenProperty** approach requires that the caller specify IID_IMAPITable as the interface identifier and **PR_MESSAGE_ATTACHMENTS** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)) as the property tag.</span></span> <span data-ttu-id="aac58-121">**PR_MESSAGE_ATTACHMENTS**ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ« ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¡¨ã™ãƒ†ãƒ¼ãƒ–ãƒ« ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-121">**PR_MESSAGE_ATTACHMENTS** is a table object property that represents a message's attachment table.</span></span> <span data-ttu-id="aac58-122">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ã‚¹ãƒˆã‚¢ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã”ã¨ã«**PR_MESSAGE_ATTACHMENTS**ã‚’è¨­å®šã—ã€ **IMAPIProp::GetPropList**ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰è¿”ã•ã‚Œã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ ã‚¿ã‚°ã®é…åˆ—ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-122">Message store providers are required to set **PR_MESSAGE_ATTACHMENTS** for each message and include it in the array of property tags returned from the **IMAPIProp::GetPropList** method.</span></span> <span data-ttu-id="aac58-123">è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [IMAPIProp::GetPropList](imapiprop-getproplist.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</span><span class="sxs-lookup"><span data-stu-id="aac58-123">For more information, see [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span></span>
  
 <span data-ttu-id="aac58-124">**PR_MESSAGE_ATTACHMENTS**ï¿½ï¿½gï¿½pï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-124">**PR_MESSAGE_ATTACHMENTS** can be used:</span></span> 
  
- <span data-ttu-id="aac58-125">**IMAPIProp::OpenProperty** ï¿½ï¿½Aï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Íï¿½Mï¿½Ò‚Ìƒeï¿½[ï¿½uï¿½ï¿½ï¿½ÉƒAï¿½Nï¿½Zï¿½Xï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-125">With **IMAPIProp::OpenProperty** to access an attachment or recipient table.</span></span> 
    
- <span data-ttu-id="aac58-p106">**IMAPIProp::CopyTo** ï¿½Ü‚ï¿½ï¿½Íï¿½ï¿½Oï¿½ï¿½ï¿½ï¿½Aï¿½Ü‚ï¿½ï¿½ÍƒRï¿½sï¿½[ï¿½ï¿½ï¿½ï¿½Æ‚ï¿½ï¿½ÉAï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½ï¿½Ü‚ß‚ï¿½É‚ÍA **IMAPIProp::CopyProps** ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½Ú×‚É‚Â‚ï¿½ï¿½Ä‚ÍA [IMAPIProp::CopyTo](imapiprop-copyto.md)ï¿½ï¿½[IMAPIProp::CopyProps](imapiprop-copyprops.md)ï¿½ï¿½Qï¿½Æ‚ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-p106">With **IMAPIProp::CopyTo** or **IMAPIProp::CopyProps** to exclude or include attachments when copying. For more information, see [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="aac58-128">ï¿½qï¿½Ìï¿½ï¿½ï¿½ï¿½ï¿½ [ï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½É“Kï¿½pï¿½ï¿½ï¿½é‚©ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Êï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-128">In a subobject restriction to indicate that the child restriction should apply to attachments.</span></span>
    
<span data-ttu-id="aac58-129">ï¿½Ú×‚É‚Â‚ï¿½ï¿½Ä‚ÍA [ï¿½Yï¿½tï¿½tï¿½@ï¿½Cï¿½ï¿½ï¿½Ìƒeï¿½[ï¿½uï¿½ï¿½](attachment-tables.md)ï¿½ï¿½Qï¿½Æ‚ï¿½ï¿½Ä‚ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="aac58-129">For more information, see [Attachment Tables](attachment-tables.md).</span></span>
  

