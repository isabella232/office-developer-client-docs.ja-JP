---
title: メッセージ サービスとプロファイル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: f8f081ea35241f3e57a8cf2345254d24c5032fdc
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59592054"
---
# <a name="message-services-and-profiles"></a>メッセージ サービスとプロファイル
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
一部のユーザーは、1 つ以上のサービス プロバイダーを持つ複数のメッセージング システムのサービスを必要とします。 これらの各サービス プロバイダーを個別にインストールして構成する場合は面倒で、メッセージング サーバーでは通常、すべての機能を公開するために関連するプロバイダーのグループが必要なので、MAPI にはメッセージ サービスの概念が含まれています。 メッセージ サービスは、ユーザーがサービス プロバイダーをインストールして構成するのに役立ちます。
  
メッセージ サービスを作成するために、開発者はメッセージ サービス エントリ ポイント プログラムを書き込み、サービス内の各プロバイダーの構成とセットアップ プログラムを処理して、次の操作を行います。
  
- サービスに各プロバイダーをインストールします。
    
- レジストリおよび初期化ファイル エントリを作成します。
    
- MAPI 構成ファイル Mapisvc.inf にエントリを作成します。
    
Mapisvc.inf ファイルには、コンピューターにインストールされているすべてのメッセージ サービスとサービス プロバイダーの構成に関連する情報が含まれている。 階層セクションで構成され、各レベルは次のレベルにリンクされます。 上部には、次の 3 つのセクションがあります。 
  
- メッセージ サービスのヘルプ ファイルの一覧。
    
- 最も重要な、または既定のメッセージ サービスの一覧。
    
- コンピューター上のすべてのサービスの一覧。
    
次のレベルには、各メッセージ サービスのセクションが含まれるし、最後のレベルには、サービス内の各サービス プロバイダーのセクションが含まれている。 MAPI では、サービス プロバイダーとメッセージ サービスの開発者が Mapisvc.inf に特定のエントリを追加する必要があります。開発者は、独自の裁量で他のエントリを追加できます。 Mapisvc.inf のほとんどの情報は、1 つ以上のプロファイル 、ユーザーの優先メッセージ サービスセットの構成情報のコレクションで終わります。 コンピューターには複数のユーザーが存在し、1 人のユーザーが複数の基本設定を持つ可能性があるため、多くのプロファイルがコンピューター上に存在する可能性があります。 各プロファイルには、異なるメッセージ サービスのセットが記述されています。 複数のプロファイルを使用すると、たとえば、1 セットのメッセージ サービスを使用して自宅で作業し、別のセットを持つオフィスで作業できます。
  
プロファイルは、構成サポートを提供するクライアント アプリケーションによって、メッセージ サービスのインストール時またはログオン時に作成されます。 MAPI には、コントロール パネルアイテムとプロファイル ウィザードの 2 つのクライアント アプリケーションがあります。 コントロール パネルアイテムはフルサービス構成アプリケーションであり、ユーザーはプロファイルを作成、削除、編集、コピーしたり、プロファイル内のエントリを変更することができます。 プロファイル ウィザードは、メッセージ サービスをプロファイルに可能な限り簡単に追加するように設計された簡単なアプリケーションです。 プロファイル ウィザードは、プロパティ ページと呼ばれる一連のダイアログ ボックスで構成され、サービスのインストールと構成のプロセスをユーザーに促します。 最も重要な設定の値のみを求めるメッセージがユーザーに表示されます。その他の設定はすべて既定値を継承します。 プロファイルが作成されると、ユーザーは変更を加えできません。 
  
コントロール パネルアイテムは常にコントロール パネルから呼び出されるのに対し、プロファイル ウィザードが呼び出される原因となるさまざまなシナリオがあります。 クライアント アプリケーションは、プロファイル ウィザードを呼び出して、まだ作成されていないログオン時に既定のプロファイルを作成できます。 コードを再実装してプロファイルを追加するのではなく、コントロール パネルアイテムまたは別のクライアント アプリケーションは、プロファイル ウィザードで既に機能を利用できます。 メッセージ サービスは、そのエントリ ポイント関数で、サービスを既定のプロファイルに追加する必要があるときにプロファイル ウィザードを呼び出すことができます。 プロファイル ウィザードを使用するメッセージ サービスは、追加のエントリ ポイント関数と標準のダイアログ ボックス プロシージャWindowsする必要があります。 プロファイル ウィザードは、エントリ ポイント関数を呼び出してサービスの構成ダイアログ ボックスを取得し、ダイアログ ボックスプロシージャは、このダイアログ ボックスが使用されているときに生成されるメッセージを処理します。 
  
プロファイルは、Mapisvc.inf ファイルと同様の方法で整理されます。 プロファイルには、階層セクションがリンクされています。サービス プロバイダーは、最下位レベルのセクションを所有し、メッセージ サービスは中央レベルのセクションを所有し、MAPI は最高レベルのセクションを所有します。 各セクションは、MAPIUID と呼ばれる一意の [識別子で識別されます](mapiuid.md)。 MAPI セクションには、すべてのメッセージ サービス プロファイル セクションの識別子や、他の各セクションへのリンクなど、MAPI 内部の情報が含まれる。 各メッセージ サービス セクションには、プロバイダー セクションへのリンクが格納され、各プロバイダー セクションにはサービス セクションへのリンクが格納されます。 
  
次の図は、2 つの一般的なプロファイルの内容を示しています。 Sam には、自宅用とオフィス用の 2 つのプロファイルがあります。 ホーム プロファイルには、3 つのメッセージ サービスが含まれる。 Message Service X は、アドレス帳管理のための単一のプロバイダー サービスです。 Message Services Y と Z には、アドレス帳プロバイダー、メッセージ ストア プロバイダー、トランスポート プロバイダーの 3 つのプロバイダーがあります。 Sam のワーク プロファイルには、アドレス帳プロバイダー、メッセージ ストア プロバイダー、およびトランスポート プロバイダーを持つ 2 つの異なるメッセージ サービスが含まれています。 
  
**プロファイルの例**
  
![プロファイルの例](media/amapi_56.gif "プロファイルの例")
  
次の図は、2 つのメッセージ サービスを含むプロファイルを示しています。 メッセージ サービスに属するサービス プロバイダーをインストールおよび構成するためのコードは、プロバイダーのコードと同じ DLL に存在します。 このコードは、ログオン時にプロファイルから情報を読み取ってサービス プロバイダーを構成し、可能な場合は必要に応じて、不足している情報をユーザーに求めるメッセージを表示します。 クライアントから、プロバイダーの構成設定を表示または変更する要求も、この一般的なコードによって処理されます。
  
**サービス プロバイダーのインストールおよび構成**
  
![サービス プロバイダーのインストールおよび構成](media/amapi_55.gif "サービス プロバイダーのインストールおよび構成")
  
## <a name="see-also"></a>関連項目

- [MAPIUID](mapiuid.md)
- [MAPI プログラミングの概要](mapi-programming-overview.md)

