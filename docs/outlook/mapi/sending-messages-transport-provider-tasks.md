---
title: ï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½Ì‘ï¿½ï¿½M ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½Xï¿½|ï¿½[ï¿½g ï¿½vï¿½ï¿½ï¿½oï¿½Cï¿½_ï¿½[ï¿½Ìƒ^ï¿½Xï¿½N
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bd722f48-b166-4670-8dba-897ac50caf37
description: 'ï¿½ÅIï¿½Xï¿½Vï¿½ï¿½: 2011ï¿½N7ï¿½ï¿½23ï¿½ï¿½'
ms.openlocfilehash: 4625d9d09b067d064dac7ca67b7c79ebb818bcce
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19803874"
---
# <a name="sending-messages-transport-provider-tasks"></a><span data-ttu-id="1a686-103">ï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½Ì‘ï¿½ï¿½M: ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½Xï¿½|ï¿½[ï¿½g ï¿½vï¿½ï¿½ï¿½oï¿½Cï¿½_ï¿½[ï¿½Ìƒ^ï¿½Xï¿½N</span><span class="sxs-lookup"><span data-stu-id="1a686-103">Sending Messages: Transport Provider Tasks</span></span>

  
  
<span data-ttu-id="1a686-104">**é©ç”¨ã•ã‚Œã¾ã™**: Outlook</span><span class="sxs-lookup"><span data-stu-id="1a686-104">**Applies to**: Outlook</span></span> 
  
 <span data-ttu-id="1a686-105">**ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½Xï¿½|ï¿½[ï¿½g ï¿½vï¿½ï¿½ï¿½oï¿½Cï¿½_ï¿½[ï¿½Aï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½ğ‘—Mï¿½ï¿½ï¿½ï¿½É‚ï¿½**</span><span class="sxs-lookup"><span data-stu-id="1a686-105">**To transmit a message, transport providers**</span></span>
  
- <span data-ttu-id="1a686-106">ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã¾ãŸã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã‚ˆã†ã¨ã—ã¦ãã ã•ã„ã€‚ å¾Œã¯ã€true ã‚’æŒ‡å®šã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®**ã‚Œãªã„**([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-106">Set the message's **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property to TRUE after the transport provider has either sent the message or attempted to send the message.</span></span> <span data-ttu-id="1a686-107">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€å¤±æ•—ã—ãŸå ´åˆã€ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€é…ä¿¡ä¸èƒ½ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹[IMAPISupport::StatusRecips](imapisupport-statusrecips.md)ã‚’å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-107">If an attempt to send a message fails, transport providers should call [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) to generate a nondelivery report.</span></span> <span data-ttu-id="1a686-108">**PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ TRUE ã«è¨­å®šã•ã‚Œã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚ŒãŸå ´åˆã€å¤±æ•—ã—ãŸå—ä¿¡è€…ã‚’å«ã‚€[ADRLIST](adrlist.md)æ§‹é€ ã‚’ä½œæˆã—ã¾ã™ã€‚ã”ã¨ã«ã€ **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã€é…ä¿¡ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã®ã«ã¯**StatusRecips**ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-108">If the message is sent successfully and the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property is set to TRUE, create an [ADRLIST](adrlist.md) structure containing the successful recipients, setting the **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) property for each, and call **StatusRecips** to generate a delivery report.</span></span> <span data-ttu-id="1a686-109">é…ä¿¡ã—ã€é…ä¿¡ä¸èƒ½ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€æ¬¡ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„: [MAPI ãƒ¬ãƒãƒ¼ãƒˆ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸](mapi-report-messages.md)ã€[ãƒ¬ãƒãƒ¼ãƒˆ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãŸã‚ã«å¿…è¦ãª](required-report-message-properties.md)[ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ¬ãƒãƒ¼ãƒˆ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£](optional-report-message-properties.md)ã€ãŠã‚ˆã³[é€ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é…ä¿¡ãƒ¬ãƒãƒ¼ãƒˆ](sending-message-delivery-reports.md)ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-109">For more information about creating delivery and non-delivery reports, see the following topics: [MAPI Report Messages](mapi-report-messages.md), [Required Report Message Properties](required-report-message-properties.md), [Optional Report Message Properties](optional-report-message-properties.md), and [Sending Message Delivery Reports](sending-message-delivery-reports.md).</span></span>
    
- <span data-ttu-id="1a686-110">ãƒ­ã‚°ã‚ªãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® id ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®**PR_SENDER**ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-110">Set the message's **PR_SENDER** group of properties to the identity of the user that has logged on.</span></span> <span data-ttu-id="1a686-111">ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™: **PR_SENDER_ADDRTYPE** ([ ã€ **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))ã€ **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))ã€ **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md))ã€ãŠã‚ˆã³**PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md))ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-111">This group includes: **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)), **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)), **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md)), **PR_SENDER_ADDRTYPE** ([PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md)), and **PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md)).</span></span>
    
- <span data-ttu-id="1a686-p103">ï¿½Â”\ï¿½Å‚ï¿½ï¿½ï¿½ÎAï¿½ï¿½ï¿½Oï¿½Iï¿½ï¿½ï¿½ï¿½ï¿½Ä‚ï¿½ï¿½éƒ†ï¿½[ï¿½Uï¿½[ï¿½ï¿½ idï¿½Aï¿½Ü‚ï¿½ï¿½Í‘ã—ï¿½lï¿½ï¿½ï¿½Lï¿½ï¿½ï¿½Èƒï¿½ï¿½[ï¿½Uï¿½[ï¿½É‚ÍAï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½ï¿½ **PR_SENT_REPRESENTING**ï¿½Ìƒvï¿½ï¿½ï¿½pï¿½eï¿½Bï¿½ï¿½İ’è‚µï¿½Ü‚ï¿½ï¿½B **PR_SENT_REPRESENTING**ï¿½vï¿½ï¿½ï¿½pï¿½eï¿½Bï¿½ÍAï¿½ï¿½ï¿½Ìƒï¿½ï¿½[ï¿½Uï¿½[ï¿½Ì‘ã—ï¿½Æ‚ï¿½ï¿½ÄAï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½Ì‘ï¿½ï¿½Mï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½A1 ï¿½Â‚Ìƒï¿½ï¿½[ï¿½Uï¿½[ï¿½ï¿½ï¿½gï¿½pï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½Ìƒvï¿½ï¿½ï¿½pï¿½eï¿½Bï¿½ï¿½Tï¿½|ï¿½[ï¿½gï¿½ï¿½ï¿½Ä‚ï¿½ï¿½È‚ï¿½ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½Xï¿½|ï¿½[ï¿½g ï¿½vï¿½ï¿½ï¿½oï¿½Cï¿½_ï¿½[ï¿½ğ–³ï¿½ï¿½ï¿½ï¿½Ä‘ï¿½ï¿½Mï¿½ï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½É‚ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="1a686-p103">Set the message's **PR_SENT_REPRESENTING** properties, if possible, to either the identity of the user that has logged on or to a valid delegate identity. The **PR_SENT_REPRESENTING** properties are used to implement the sending of messages by one user on behalf of another user. Transport providers that do not support these properties should ignore them on outbound messages.</span></span> 
    
- <span data-ttu-id="1a686-115">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) ã‚’ç¤ºã™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«[IMessage::SubmitMessage](imessage-submitmessage.md)ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã«è¨­å®šã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-115">Set the message's **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property to indicate when the client called [IMessage::SubmitMessage](imessage-submitmessage.md).</span></span>
    
- <span data-ttu-id="1a686-116">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ã‚¹ãƒˆã‚¢ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦é€ä¿¡ã•ã‚ŒãŸã“ã¨ã‚’ãƒãƒ¼ã‚¯ã™ã‚‹ã¨ãã®æ—¥æ™‚ã‚’ç¤ºã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®**PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-116">Set the message's **PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) property to indicate the date and time that the message store provider marked the message as having been sent.</span></span> 
    
<span data-ttu-id="1a686-117">ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Ü‚Èƒï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½ï¿½ï¿½O ï¿½Vï¿½Xï¿½eï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Â‚ï¿½ï¿½Ìï¿½Mï¿½Ò‚Éƒï¿½ï¿½bï¿½Zï¿½[ï¿½Wï¿½ï¿½ï¿½ï¿½ï¿½Mï¿½ï¿½ï¿½ï¿½ï¿½ÆAï¿½ï¿½ï¿½Mï¿½ï¿½ï¿½ê‚½ï¿½eï¿½Rï¿½sï¿½[ï¿½É‚ÍAï¿½ï¿½ï¿½Ü‚ï¿½ï¿½Ü‚È‘ï¿½ï¿½Mï¿½ï¿½ id ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½B</span><span class="sxs-lookup"><span data-stu-id="1a686-117">When a message is sent to a variety of recipients with several messaging systems, each transmitted copy will have a different sender identity.</span></span> 
  
<span data-ttu-id="1a686-118">ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¾ãŸã¯å¯†çµåˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒ» ã‚¹ãƒˆã‚¢ãŠã‚ˆã³ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆã§ã¯ã€å·®å‡ºäººãŠã‚ˆã³è¿”ä¿¡å…ˆæƒ…å ±ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã‚‚ã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-118">The transport provider or tightly coupled message store and transport is also responsible for setting originator and reply-to information.</span></span> <span data-ttu-id="1a686-119">ç™ºä¿¡è€…æƒ…å ±ã¯ã€ **PR_ORIGINATOR**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ PR_REPLY ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§è¿”ä¿¡ã™ã‚‹æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-119">Originator information is stored in the **PR_ORIGINATOR** properties and reply-to information is stored in the PR_REPLY properties.</span></span> <span data-ttu-id="1a686-120">ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã§ãã¾ã™ã€‚ãŸã ã—ã€ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯è¨±å¯ã‚’ç„¡è¦–ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¨­å®šã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚</span><span class="sxs-lookup"><span data-stu-id="1a686-120">The client can set these properties; however, the transport provider is allowed to ignore and overwrite the client's settings.</span></span> 
  

