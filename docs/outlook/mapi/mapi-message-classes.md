---
title: MAPI メッセージ クラス
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: a6e78051b095643b49bc8386364904618105467a
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59579601"
---
# <a name="mapi-message-classes"></a>MAPI メッセージ クラス

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
すべてのメッセージには、メッセージの種類 **、目的、または** コンテンツを識別する、PR_MESSAGE_CLASS [(PidTagMessageClass)](pidtagmessageclass-canonical-property.md)というメッセージ クラス プロパティがあります。 **PR_MESSAGE_CLASS** は、すべての新しいメッセージで必須のプロパティです。 メッセージのクラスは、ユーザーにメッセージを表示するために使用されるフォームと、受信メッセージを配置するフォルダーを決定します。 
  
メッセージ クラスは、ASCII 文字 32 ~ 127 を含む大文字と小文字を区別する文字列で、ピリオドで区切りますが、ピリオドで終わることはできません。 各文字列はサブクラス化のレベルを表し、許可されるレベルの数に制限はありません。 
  
たとえば、クライアント アプリケーションが送受信するほとんどのメッセージは **、IPM** メッセージ クラスに分類されます。これは、すべての対人メッセージ (つまり、コンピューターによってプログラムによって読み取るのではなく、人間のユーザーが読み取るメッセージ) を表す広範なカテゴリです。 メッセージ ストア プロバイダーは、IPM サブクラスを作成して IPM メッセージを **より正確に記述** します。 **IPM サブクラスは****、IPM** メッセージ クラスのプロパティを継承します。 IPM クラスの **サブクラスの名前は、IPM** などの IPM 識別子に他の文字列を連結することで **指定されます。メモ** メッセージと **IPM を説明するために注意してください。連絡先メッセージ** を説明する連絡先。 
  
IPM メッセージの表示と管理を処理するために、クライアントは MAPI が提供する標準フォームを使用できます。 新しいメッセージ クラスの表示と管理を処理するには、クライアント アプリケーション開発者として次の 2 つのオプションがあります。
  
1. 標準クライアントが使用できる MAPI 定義フォーム インターフェイスのセットを使用して、新しいフォームを作成できます。
    
2. 完全なスタンドアロン アプリケーションを実装することで、独自のクライアントを作成できます。 
    
クライアントは、すべての **送信メッセージの PR_MESSAGE_CLASS** プロパティを **IPM** または **IPC** のいずれかのサブクラスに設定する必要があります。メッセージ ストア プロバイダーは、このプロパティを設定する最終的な責任を負います。 したがって、クライアントがメッセージ クラスを設定せずにメッセージを送信する場合、メッセージ ストア プロバイダーはメッセージを適切な種類のクライアントに対して適切な既定値に設定します。 対人間メッセージング クライアントの既定のメッセージ クラスは **IPM です**。プロセス間通信クライアントの既定のメッセージ クラスは **IPC です**。 
  
メッセージ クラスの長さは 255 文字です。 ただし、レポートで使用されるメッセージ クラスをサポートするために、メッセージ クラスは 127 文字を超えることはできません。 レポート メッセージ クラスは、元のメッセージのクラスに基づいており、プレフィックスと接尾辞の 2 つが追加されています。 プレフィックス REPORT は、メッセージがレポートであり、サフィックスは、DR (配信レポート)、NDR (配信不能レポート)、IPNRN (読み取りレポート)、または IPNNRN (非読み取りレポート) の種類を示します。 これらの長さの制限は文字で指定されます。2 バイト文字セットを使用するプラットフォームでは、実際のバイト数が多くなる可能性があります。 
  
クライアントがメッセージ クラスの許容制限を超える文字列を割り当てしようとすると、メッセージ ストア プロバイダーは [IMAPIProp::SetProps](imapiprop-setprops.md) メソッドの実装から MAPI_E_INVALID_PARAMETER を返す必要があります。 
  
## <a name="see-also"></a>関連項目



[MAPI メッセージ](mapi-messages.md)

