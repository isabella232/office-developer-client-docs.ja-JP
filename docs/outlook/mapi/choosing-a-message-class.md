---
title: メッセージ クラスの選択
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: cc7d2f6dc251a280738d2857e46a5d898fde3017
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59556841"
---
# <a name="choosing-a-message-class"></a>メッセージ クラスの選択

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
「MAPI メッセージ [クラス」](mapi-message-classes.md)で説明したように、メッセージ クラスは、カスタム メッセージの種類と、フォーム サーバー自体の間のリレーションシップを拡張して確立するために重要です。 幸いなことに、メッセージ クラス文字列の選択はかなり簡単です。 メッセージ クラスのメッセージ クラス文字列は任意の文字列ですが、次の規則を使用する必要があります。
  
- 文字列は、プロパティ ([PidTagMessageClass](pidtagmessageclass-canonical-property.md) **)** プロパティのドキュメントで説明PR_MESSAGE_CLASS規則をすべて満たす必要があります。 重要な点として、文字列は ANSI 文字で構成され、長さ 256 文字未満である必要があります。
    
- フォーム サーバーが既存のフォーム サーバーから派生している場合、または既存のフォーム サーバーの拡張機能である場合は、フォームの基になるフォーム サーバーのメッセージ クラス文字列にピリオドと別の単語を追加して、メッセージ クラス文字列を形成する必要があります。 たとえば、会議のスケジュールを変更するフォームを実装する場合、フォームは会議のスケジュールを設定するための既存のフォームに基づいて行います。 会議スケジュール フォームのメッセージ クラス文字列が "IPM" の場合。会議」の場合、メッセージ クラスの文字列は "IPM" になります。Meeting.Reschedule」
    
- フォームが既存のフォームに基づいていない場合でも、メッセージ クラス文字列は "IPM" で始まる必要があります。 または "IPC" フォームがユーザーまたは別のアプリケーションによって受信される対象かどうかに応じて、プレフィックスを指定します。 "IPM" 通常、ユーザーの受信トレイで終わる対人メッセージと "IPC" を指定します。 通常、ユーザーの受信トレイに配信されないプロセス間通信メッセージを指定します。
    
- メッセージ クラスが人間が読み取り可能な場合、メッセージ クラス文字列は "IPM" で始まる必要があります。 メッセージ クラスは、通常、テキスト形式、HTML 形式、またはリッチ テキスト形式 (RTF) データを含むプロパティを使用する場合、人間が読み取り可能と見なされます。 フォームでプロパティ ([PidTagBody](pidtagbody-canonical-property.md) **)** PR_BODY使用する場合は、ほぼ確実に "IPM" を使用する必要があります。 メッセージ クラスの文字列。 たとえば、発注書のフォームを実装している場合に、組織が発注書をマネージャーによって承認する必要がある場合、メッセージ クラス文字列は "IPM" になります。Purchase_Order」 パブリック フォルダーまたはパブリック フォルダー アプリケーションで使用するように設計されたフォームは、実際には任意のユーザーの電子メール アドレスにアドレス指定されていない場合でも、ユーザーが読み取るので、通常は対人的であると見なされます。 パブリック フォルダー メッセージ クラスの一般的なプレフィックスは"IPM" です。Post」 
    
- メッセージ クラスがユーザーではなく別のアプリケーションによって受信される場合、メッセージ クラス文字列は "IPC" で始まる必要があります。 たとえば、ユーザーが自動的にメーリングリストを購読できるフォームを実装している場合、メッセージ クラス文字列は "IPC" になります。[サブスクライブ]
    
- メッセージ クラスの文字列は、ピリオドで終わる必要があります。
    
メッセージ クラスの文字列は、次のような **MessageClass** エントリのフォーム構成ファイルの **[Description]** セクションに置く必要があります。 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
適切なメッセージ クラス文字列を選択したら、そのクラス識別子を生成する必要があります。 クラス識別子は、クラス識別子に含まれる **GUID** の作成コマンドを使用してVisual Studio。 クラス識別子は、次のような **MessageClass** エントリと共に、フォーム構成ファイルの **CLSID** エントリに入れる必要があります。 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
もちろん、クラス識別子はほぼ確実に異なります。 詳細については、「フォーム構成ファイルの [作成」を参照してください](creating-a-form-configuration-file.md)。
  
フォームがユーザーのコンピューターにインストールされている場合、セットアップ プログラムや他のプログラムに関係ないインストール プロセスでは、クラス識別子のレジストリの **HKEY_CLASSES_ROOT\CLSID\** セクションにレジストリ エントリを作成する必要があります。 このエントリは、メッセージ クラス文字列に設定する必要があります。 たとえば、上記のクラス識別子の例では、次のようなレジストリ エントリを作成します。 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
詳細については、「ライブラリへの [フォームのインストール」を参照してください](installing-a-form-into-a-library.md)。
  
## <a name="see-also"></a>関連項目



[MAPI フォーム サーバーの開発](developing-mapi-form-servers.md)

