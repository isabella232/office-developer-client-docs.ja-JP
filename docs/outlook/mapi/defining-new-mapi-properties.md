---
title: 新しい MAPI プロパティの定義
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: b0f28efea6e7ba05dc399565ee866cf2e34572bc
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59584634"
---
# <a name="defining-new-mapi-properties"></a>新しい MAPI プロパティの定義

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
クライアントとサービス プロバイダーが使用するために MAPI によって提供される豊富なプロパティにもかかわらず、MAPI を使用すると、必要に応じて新しいプロパティを作成できます。 新しいパブリック プロパティを定義するための有効なシナリオには、新しいメッセージ クラスをサポートするプロパティを作成するクライアントと、一意のメッセージング システム機能を公開するための新しいプロパティを作成するサービス プロバイダーがあります。
  
通常、サービス プロバイダーが既存の MAPI オブジェクトまたはメッセージ クラスの新しいプロパティを定義するには無効です。 MAPI を使用する主な利点の 1 つは、多数のメッセージング システム要素の標準識別子と形式が設定され、ユーザーがサービス プロバイダーをシームレスに組み合わせ、一致できる点です。 標準以外のプロパティを使用するサービス プロバイダーは、他のサービス プロバイダーと同様に機能しません。 
  
クライアントは、次の方法で新しいメッセージ クラスのコンテンツ プロパティを作成できます。
  
- メッセージ クラス固有のコンテンツ プロパティに指定範囲内のプロパティ識別子を使用する。
    
    - Or -
    
- 名前付きプロパティの使用。 
    
最初のオプションが望ましいのは、すべてのサービス プロバイダーが名前付きプロパティをサポートしている場合ではないのでです。 MAPI では、クライアントが新しいメッセージ クラス固有のコンテンツ プロパティに使用する 2 つの個別の範囲を定義します。
  
- 0x6800プロパティ0x7BFFを設定する方法
    
- 0x7C00、0x7FFFのプロパティを使用する方法
    
プロパティ識別子は、異なるベンダーまたはユーザーによって定義されたプロパティ間の競合を防ぐのに役立つ定義済みの範囲に含む必要があります。 ただし、これらの範囲のプロパティのユーザーは、プロパティの動作を前提とすることはできません。 新しいメッセージ クラスを作成するすべてのクライアントは、これらの範囲にアクセスできます。識別子  _xxxx_ を持つプロパティは、1 つのメッセージ クラスに対する 1 つの動作と、別のメッセージ クラスの別の動作を意味します。 
  
名前付きプロパティは、特定のプロパティがメッセージ クラスに固有のプロパティを保証するために使用されます。 名前付きプロパティ識別子は、指定した範囲0x8000開始します。 クライアントは 1 つ以上の名前を定義し、メッセージ ストアの [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) メソッドを呼び出して、識別子を各名前に関連付ける。 名前付きプロパティは、オブジェクトの所有者が名前付きプロパティをサポートしている場合にのみ、クライアントまたはサービス プロバイダーが任意のオブジェクトの新しいプロパティを定義するために使用できます。 これらのプロパティのユーザーは **、GetIDsFromNames** と関連 **する IMAPIProp** メソッド [GetNamesFromIDs](imapiprop-getnamesfromids.md)を呼び出して、名前とその識別子の間をマップします。
  
すべてのプロパティ (新規または既存) では、定義済みのプロパティの種類のセットを使用する必要があります。 新しいプロパティの種類を追加することはできません。既存の型を変更または削除することはできません。 1 文字または 16 ビットの整数プロパティなどの単純で小さいプロパティは、任意の適切な型に格納できます。 たとえば、整数は **ULONG** として格納し、文字列は次 **のように格納** PT_STRING8。 
  
カウントされた **バイトPT_BINARY** を示すために、この型を使用します。 このプロパティの種類は、オブジェクトに格納できるデータの種類を拡張する場合に便利です。 バイトは順序に基づいて送信され、データの意味に関する前提は作成されません。 クライアント アプリケーションがそのようなプロパティからデータを読み取る場合、データは保存方法から変更されません。 クライアントは、CPU 間でデータを移動するときに必要なバイト スワップを実行する必要があります。 
  
## <a name="see-also"></a>関連項目



[MAPI のプロパティの概要](mapi-property-overview.md)

