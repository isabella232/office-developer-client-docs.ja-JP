---
title: MAPI サブシステムでのトランスポート プロバイダーの役割
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 0cfc1fd71e70fbc3555e63551cb3e48c708b98bc
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59609279"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a>MAPI サブシステムでのトランスポート プロバイダーの役割
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
トランスポート プロバイダーの動的リンク ライブラリ (DLL) は、MAPI スプーラーとメッセージの送受信を担当するメッセージング システムの一部との間のインターフェイスを提供します。 MAPI スプーラーとトランスポート プロバイダーは、メッセージの送信またはメッセージの受信の責任を処理するために一緒に作業します。 MAPI スプーラーは、トランスポート プロバイダー DLL を最初に使用するときに読み込み、不要になったときに解放します。 複数のトランスポート プロバイダーを同じシステムにインストールできますが、MAPI は必要なスプーラーを 1 つ提供します。
  
通常、クライアント アプリケーションはトランスポート プロバイダーと直接通信しない。 クライアントはストア プロバイダーを介してメッセージを送信し、MAPI スプーラーは送信メッセージを適切なトランスポート プロバイダーに送信し、受信メッセージを適切なメッセージ ストアに配信します。 MAPI スプーラーは、その作業を実行し、フォアグラウンド アプリケーションがアイドル状態のときにトランスポート プロバイダーへの呼び出しを行います。 必要に応じて、トランスポート プロバイダーが最初にログオンするときにダイアログ ボックスを表示した後、送信キューと受信キューをフラッシュするためにクライアントから呼び出されない限り、トランスポート プロバイダーはバックグラウンドで動作します。 
  
トランスポート プロバイダーは、MAPI メッセージング システムで次の責任を負います。
  
- MAPI スプーラーがメッセージの宛先アドレスに応じて適切なトランスポート プロバイダーにメッセージを送信できるよう、MAPI スプーラーで受け入れ可能なアドレスの種類を登録します。 1 つのトランスポート プロバイダーは、複数のアドレスの種類を登録できます。 トランスポート プロバイダーは、MAPI スプーラーに特定の受信者のアドレスを登録することもできます。 これらのアドレスの 1 つにアドレス指定されたメッセージは、MAPI スプーラーにアドレスを登録したトランスポート プロバイダーに送信されます。 詳細については、「トランスポート プロバイダー [と MAPI スプーラー運用モデル」を参照してください](transport-provider-and-mapi-spooler-operational-model.md)。
    
- MAPI スプーラーに受信メッセージを配信します。 メッセージング システムの性質に応じて、トランスポート プロバイダーは、新しいメッセージが到着すると MAPI スプーラーに直接通知するか、MAPI スプーラーがトランスポート プロバイダーを定期的にポーリングして新しいメッセージを確認する要求を行います。
    
- MAPI メッセージ のプロパティを、メッセージング システムにネイティブなメッセージ プロパティに変換します。 たとえば、トランスポート プロバイダーは、送信メッセージ内の送信者と受信者のアドレスを、メッセージング システムで受け入れられるフォームに変換する必要があります。 一部のメッセージング システムでは、すべての MAPI メッセージ プロパティがサポートされていません。 メッセージング システムにメッセージを配信するときに MAPI メッセージのプロパティを保持する方法の詳細については、「メッセージ トランスポート プロバイダーの開発TNEF-Enabled [参照してください](developing-a-tnef-enabled-transport-provider.md)。
    
- トランスポート プロバイダーに固有のメッセージと受信者のオプションを登録します。
    
- メッセージング システムで必要な資格情報の検証を実行します。
    
- MAPI スプーラーによって渡されたメッセージ オブジェクトを使用して、送信メッセージにアクセスします。
    
- 基になるメッセージング システムで必要に応じてメッセージ形式を変換します。
    
- これらの受信者の **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) プロパティを設定して、トランスポート プロバイダーが処理の責任を受け入れる送信メッセージの受信者を MAPI スプーラーに通知します。
    
- 受信メッセージを処理する必要がある場合は、MAPI スプーラーに通知します。
    
- メッセージ オブジェクトを使用して、受信メッセージ データを MAPI スプーラーに渡します。
    
- 受信メッセージに必要なすべての MAPI メッセージ プロパティに値を割り当てる。
    
- 必要に応じて、配信後に基になるメッセージング システムからメッセージを削除します。
    
- MAPI スプーラーとクライアント アプリケーションの状態情報を提供します。
    
次の図は、MAPI アーキテクチャの他のコンポーネントに関するトランスポート プロバイダーの役割を示しています。
  
**メッセージング システムのトランスポート プロバイダー ロール**
  
![メッセージング システムのトランスポート プロバイダー ロール](media/xp01.gif "メッセージング システムのトランスポート プロバイダー ロール")
  

