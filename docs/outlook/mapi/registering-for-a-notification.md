---
title: 通知の登録
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 63b572f6869f36a1de4b6e85962befd998e93549
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59624385"
---
# <a name="registering-for-a-notification"></a>通知の登録

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
クライアントは、初期化プロセスの一環としてアドレス帳またはメッセージ ストア通知に登録できます。
  
MAPI は、アドレス帳プロバイダーがサポートするかどうかに関係なく、アドレス帳の通知をサポートします。 メッセージ ストアでの通知のサポートは、特定のメッセージ ストア プロバイダーによって異なります。 特定のメッセージ ストア プロバイダーが通知をサポートするかどうかを確認するには、PR_STORE_SUPPORT_MASK **(** [PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) プロパティを確認します。 メッセージ ストアで通知がサポートされている場合、STORE_NOTIFY_OKビットが設定されます。 
  
アドバイス ソース オブジェクトの Advise メソッドを呼び出して通知に **登録** します。 多くのオブジェクトは **Advise** を実装し、クライアントはさまざまな方法でこれらのオブジェクトに登録できます。 
  
 **通知に登録するには**
  
1. MAPI アアドバイス シンク オブジェクトを作成し、その参照カウントを増やします。
    
2. 必要に応じて [、HrThisThreadAdviseSink](hrthisthreadadvisesink.md) を呼び出して、元のアアドバイス シンクをラップするアアドバイス シンク オブジェクトを作成し、元のアドバイス シンクを解放します。 
    
3. 登録を完了するには、次 **のいずれかの Advise** メソッドを呼び出します。 
    
  - [IMAPISession::通知](imapisession-advise.md)を呼び出して、セッション通知またはアドレス帳またはメッセージ ストア オブジェクトの通知に登録します。 
    
  - [IAddrBook::Advise を](iaddrbook-advise.md)呼び出して、アドレス帳通知またはメッセージング ユーザー、コンテナー、または配布リストの通知に登録します。 
    
  - [IABLogon::Advise](iablogon-advise.md)を呼び出して、メッセージング ユーザー、コンテナー、または配布リストの通知をアドレス帳プロバイダーに直接登録します。 
    
  - [IMsgStore::Advise を](imsgstore-advise.md)呼び出して、メッセージ ストア通知またはフォルダーまたはメッセージの通知に登録します。 
    
  - [IMSLogon::Advise を](imslogon-advise.md)呼び出して、フォルダーまたはメッセージの通知をメッセージ ストア プロバイダーに直接登録します。 
    
  - [IMAPITable::Advise を呼び出して、](imapitable-advise.md)テーブル通知に登録します。 
    
4. Advise から返される接続番号を **キャッシュします**。
    
5. ラップされたアアドバイス シンクを使用する場合は、リリースします。 ラップされたアアドバイス シンクが登録された後、そのシンクは不要です。
    
呼び出し ** IMAPISession::Advise ** を使用すると、セッション全体または個々のオブジェクトに対するさまざまな通知に対して重大なエラー通知を登録できます。 共有セッションを使用している別のクライアントが [IMAPISession::Logoff](imapisession-logoff.md) メソッドを呼び出す場合、セッションは共有セッションにログオンしているクライアントに重大なエラー通知を送信します。 セッション通知に登録するには、エントリ識別子パラメーターに NULL を渡します。 個々のオブジェクトの通知に登録するには、オブジェクトのエントリ識別子を渡します。 **IMAPISession** メソッドは、エントリ識別子の **MAPIUID** 部分によって決定される適切なサービス プロバイダーに呼び出しを転送します。 **IMAPISession::Advise を** 呼び出して、オブジェクト通知に登録する方が、サービス プロバイダーの Advise メソッドを呼び出すよりも **簡単** です。 
  
アドレス帳への登録は、セッションへの登録に似ています。 アドレス帳から重大なエラー通知を登録するには、エントリ識別子に NULL を渡します。 特定のアドレス帳オブジェクトに通知を登録するには、適切なエントリ識別子と、対象のイベントまたはイベントを指定します。 アドレス帳プロバイダーの多くは、個々のオブジェクトに対する通知をサポートしていない点に注意してください。 むしろ、コンテンツテーブルと階層テーブルに対するテーブル通知をサポートします。 
  
アドバイスの呼び出しから正常に戻った直後に[、HrAllocAdviseSink](hrallocadvisesink.md)を使用して実装または作成するアドバイス シンクを解放してください。 これは、サービス プロバイダーが、 **アドバイス** の呼び出し後 **、Unadvise** 呼び出しが行われた前にアアドバイス シンクを解放できる可能性があるためです。 アドバイス ソースにアアドバイス シンクへのポインターを指定し、このアアドバイス シンクで参照カウントを増やしたら、長期的な使用がない限り、それを解放する方が賢明です。 
  
> [!NOTE]
> 有効なアドバイザリ登録を表すすべての接続番号は **、Unadvise** 呼び出しが行われたまで解放されません。 
  

