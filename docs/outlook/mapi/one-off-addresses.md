---
title: 一時アドレス
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: 9224c694-b26f-42c7-9404-ee2dd832cfbb
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 1fccf0f3e72cb2619566e074cde3dbb52c539ef2
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59583982"
---
# <a name="one-off-addresses"></a>一時アドレス

**適用対象**: Outlook 2013 | Outlook 2016 
  
1 回のアドレスは、セッションのアドレス帳コンテナーに対応するエントリを持つ受信者である 1 回の受信者にメッセージを送信するために使用されます。 クライアントは、アドレス帳に新しいエントリを追加したり、新しい受信者を送信メッセージの受信者リストに追加したりすると、1 回きりアドレスを作成できます。 1 回のアドレスは、変更可能な任意のコンテナーに追加できます。
  
1 回のアドレスを作成するために、クライアントは編集コントロールを含む特別なテンプレートを使用して、1 回きりアドレスを構成する情報を入力します。 1 回のアドレス (他の種類のアドレスなど) は、定義済みの形式を使用します。 1 回限りアドレス形式は、MAPI によって次のように定義されます。
  
`Display name[Address type:Email address]`
  
この形式には 6 つのコンポーネントと、文字の引用に関する規則があります。 コンポーネントについては、次の表で説明します。
  
|**コンポーネント**|**使用法**|**説明**|
|:-----|:-----|:-----|
|表示名  <br/> |オプション  <br/> |存在しない場合 **、IAddrBook::ResolveName は** 電子メール アドレスの表示部分を表示名として使用します。 空白が含まれる場合があります。 詳細については [、「IAddrBook::ResolveName」を参照してください](iaddrbook-resolvename.md)。  <br/> |
|[  <br/> |必須かどうか  <br/> |型とアドレスの情報の開始を示します。  <br/> |
|]  <br/> |必須かどうか  <br/> |型とアドレスの情報の末尾を示します。 空白以外の文字が続く場合、エントリはカスタム受信者として扱われます。  <br/> |
|アドレスの種類  <br/> |必須かどうか  <br/> |アドレスの種類。は、特定のアドレス形式にマップされます。 詳細については、「MAPI アドレスの [種類」を参照してください](mapi-address-types.md)。  <br/> |
|:  <br/> |必須かどうか  <br/> |アドレスの種類と電子メール アドレスを分離します。  <br/> |
|メール アドレス  <br/> |必須かどうか  <br/> |��M�҂̃A�h���X�ł��B 空白が含まれる場合があります。  <br/> |
   
MAPI では、特定の引用符付き文字セットを使用して、アドレスにコンマ (,,)、左かっこ ([)、コロン (:)) などの特殊文字を含めることができます。改行や改行などの型指定できない文字や、他の 16 進数に相当する文字があります。 引用文字は円記号 ( です \) 。 したがって、クライアントまたはプロバイダーがアドレスに円記号を挿入する必要がある場合は、引用文字 (" ") を使用して、バックスラッシュを事前に設定する必要 \\ があります。
  
クライアントとサービス プロバイダーは、固定されていない型指定可能なフィールドで、この引用手法を使用できます。 たとえば、次のエントリは、表示名として Bill Lee、アドレスの種類として MSPEER、電子メール アドレスとして \\ billll\in に変換されます。
  
`Bill Lee[MSPEER:\\\\billl\in]`

特殊な型指定できない文字を挿入するために、クライアントとサービス プロバイダーは、16 進数に相当する数値を表す引用符文字の後に x と 2 の 16 進数字を使用します。 たとえば、アドレスにキャリッジ リターン (\0d) を 16 進数で表す型指定できない文字がある場合、クライアントは次のように入力します。
  
`Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]`

**IAddrBook::ResolveName** は、ほとんどの SMTP アドレスを自動的に解析し、次の形式のアドレスを探します。 
  
`XXX@YYY.ZZZ`

可能なすべての RFC822 形式が処理されるとは限りありませんが、ほとんどのユーザーにとってこの自動解析は適切です。 **ResolveName** には、ユーザーがメッセージに SMTP アドレスを直接入力し、そのメッセージをインターネット ユーザーに送信するためのこの機能が含まれています。 アドレスの XXX、YYY、および ZZZ コンポーネントには、1 つ以上の文字を指定できます。 AT 記号 (@) は XXX、YYY、または ZZZ アドレス コンポーネントに含めず、YYY コンポーネントにはピリオドを含めません。 次の文字は SMTP アドレスの特殊文字なので、MAPI は自動的にこれらの文字を含む表示名を 1 回のアドレスに変換します。 
  
- \>\>
    
- @
    
- \<\>
    
- .
    
すべての 1 回のアドレスには、対応する 1 回分のエントリ識別子が割り当てられます。 この割り当てを行う場合、クライアントは **IAddrBook::CreateOneOff** を呼び出し、トランスポート プロバイダーは **IMAPISupport::CreateOneOff を呼び出します**。 詳細については [、「IAddrBook::CreateOneOff」](iaddrbook-createoneoff.md) および [「IMAPISupport::CreateOneOff」を参照してください](imapisupport-createoneoff.md)。 受信メッセージを処理する場合、トランスポート プロバイダーは、ゲートウェイ アドレスと、トランスポートの関連付けられたアドレス帳プロバイダーでは処理できないアドレスの 1 回のエントリ識別子を作成します。 トランスポート プロバイダーは、メッセージ内の各アドレスの種類をチェックして、トランスポートに関連付けられたアドレス帳プロバイダーが処理できるかどうかを判断します。 できない場合、トランスポート プロバイダーは **IMAPISupport::CreateOneOff** を呼び出して、アドレスを 1 回のエントリ識別子に関連付ける。 
  
1 回のエントリ識別子には、次の順序で次の情報が含まれます。
  
1. **MAPIUID**
    
2. バージョン
    
3. フラグ
    
4. 表示名
    
5. アドレスの種類
    
6. メール アドレス
    
**IAddrBook::CreateOneOff** と **IMAPISupport::CreateOneOff** の呼び出しでは、クライアントとトランスポート プロバイダーは、1 回のアドレスで表される受信者が書式設定されたテキストまたは埋め込み OLE オブジェクトを処理できるかどうかを示すフラグを設定できます。 受信者が書式設定されたテキストおよび OLE オブジェクトを処理できると示すために、クライアントとトランスポート プロバイダーは  _ulFlags_ パラメーターに MAPI_SEND_NO_RICH_INFOフラグを設定します。 MAPI は、1 回の受信者のPR_SEND_RICH_INFO **(** [PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) プロパティを FALSE に設定します。 このフラグを設定しない場合、1 回 **限** PR_SEND_RICH_INFOアドレスが SMTP アドレスとして解釈されない限り、MAPI は TRUE に設定されます。 この 1 つのケースでは **、既定PR_SEND_RICH_INFO** FALSE になります。 
  
## <a name="see-also"></a>関連項目

- [IAddrBook::ResolveName](iaddrbook-resolvename.md)

