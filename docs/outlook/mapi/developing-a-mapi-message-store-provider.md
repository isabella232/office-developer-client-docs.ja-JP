---
title: MAPI メッセージ ストア プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412612"
---
# <a name="developing-a-mapi-message-store-provider"></a>MAPI メッセージ ストア プロバイダーの開発
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
他の MAPI サービス プロバイダーと同様に、メッセージ ストアは、MAPI クライアント アプリケーションと MAPI スプーラーに基になるストレージ メカニズムのサービスを示す動的リンク ライブラリ (DLL) です。 メッセージ ストア プロバイダーは、MAPI クライアントと MAPI スプーラーが使用できるフォルダーとメッセージの階層セットとして、基になる記憶域メカニズムを提示します。
  
次の図は、MAPI メッセージ ストアの基本的なアーキテクチャを示しています。
  
**メッセージ ストアのアーキテクチャ**
  
![メッセージ ストアのアーキテクチャ](media/storearc.gif "メッセージ ストアのアーキテクチャ")
  
メッセージ ストア プロバイダーは、任意の種類の基になるストレージ メカニズムを使用して実装できます。 ただし、パフォーマンスの問題に注意する必要があります。 さらに、基になる記憶域メカニズムは、MAPI オブジェクトの階層的なコレクションとして表示する必要があります。 これらの要件は、メッセージ ストアが通常、データベース内のオブジェクトの階層的な格納をサポートし、プログラミング インターフェイスまたは定義されたファイル構造を持つ既存のデータベース製品を使用して実装されるという意味です。 たとえば、Microsoft Office Access、SQL Oracle データベースを基になるストレージ メカニズムとして使用できます。 一部のデータベース製品には、MAPI 機能の実装を容易にする機能セットが備え付けられているので、データベース製品の選択は、メッセージ ストア プロバイダーがサポートする必要がある機能の影響を受ける可能性があります。
  
既存のデータベースを基になるストレージ メカニズムとして使用すると、独自の階層ストレージ メカニズムを実装するよりも、MAPI クライアントに MAPI オブジェクトを MAPI オブジェクトとして提示する方が簡単なので、作業が節約されます。 これにより、独自の階層ストレージ メカニズムを実装する場合よりも高いレベルで MAPI 操作を処理できます。 たとえば、特定の件名行を含むメッセージを検索すると、階層的なストレージ メカニズムを検索するための複雑なルーチンを実装するのではなく、適切なデータベース クエリを作成して送信する作業が非常に簡単になります。
  
メッセージ ストア プロバイダーは、MAPI クライアントと MAPI スプーラーと通信して、フォルダーとオブジェクトに対して操作を実行します。 メッセージ ストア プロバイダーは、これらの操作を基になる記憶域メカニズムの下位レベルの操作に変換します。 MAPI スプーラーは、通常、メッセージの送受信中にメッセージ ストア プロバイダーと通信します。 MAPI クライアントは通常、メッセージ ストア プロバイダーと通信してフォルダー階層を操作し、メッセージの読み取り、編集、削除、送信を行います。
  
MAPI スプーラーと MAPI クライアントの両方がメッセージ ストア プロバイダーと通信して新しいメッセージを作成します。 クライアント アプリケーションは、ユーザーがメッセージを作成するときにこれを行います。 MAPI スプーラーは、受信メッセージを受信するときにこれを行います。 いずれの場合も、新しいメッセージは通常、メッセージ ストアの受信トレイ フォルダーに作成されます (メッセージ ストアがある場合)。
  
メッセージ ストア プロバイダーは、MAPI テーブル、フォルダー、メッセージ、およびプロパティを多用します。 これらのオブジェクトの実装の詳細については[、「MAPI](mapi-tables.md)テーブル[、MAPI フォルダー、MAPI](mapi-folders.md)[メッセージ、MAPI](mapi-messages.md)プロパティの概要[」に記載されています](mapi-property-overview.md)。 メッセージ ストア プロバイダーを実装する前に、その資料について理解する必要があります。
  
メッセージ ストア プロバイダーには、ユーザーの既定のメッセージ ストアとして機能できるプロバイダーとできないメッセージ ストア プロバイダーの 2 種類があります。 既定のメッセージ ストアは、クライアント アプリケーションと MAPI スプーラーがメッセージの受信やフォルダーの作成など、任意のメッセージング タスクを実行できるメッセージ ストアです。 既定のメッセージ ストア プロバイダーは、すべてのメッセージ ストア プロバイダーに必要な最小数よりも多くの機能をサポートする必要があります。
  
## <a name="see-also"></a>関連項目

- [MAPI の概念](mapi-concepts.md)

