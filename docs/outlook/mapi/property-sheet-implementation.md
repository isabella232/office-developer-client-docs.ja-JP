---
title: プロパティ シートの実装
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 8037845cce7a3c24f2904a380bbf3fac8c8868a6
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59599229"
---
# <a name="property-sheet-implementation"></a>プロパティ シートの実装

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
プロパティ シートは、オブジェクトのプロパティを表示するためのダイアログ ボックスです。 プロパティは読み取り専用で、ユーザーがそれらを表示するか、読み取り/書き込みのみを有効にし、ユーザーが変更を加えるのを有効にできます。 プロパティ シートには、ページと呼ばれる 1 つ以上の重なり合う子ウィンドウが含まれます。 各ページには、関連するプロパティのグループを設定するコントロール ウィンドウが含まれる。 ユーザーは、対応するページをプロパティ シートの前景に移動するタブを選択して、ページ間を移動します。
  
サービス プロバイダーは、メッセージ サービスの構成に関連する最小限のプロパティ セットを表示するプロパティ シートを実装する必要があります。 これらのメッセージ サービスのプロパティを変更できる場合は、コントロール パネルなどのクライアント アプリケーションのユーザーが変更を加えるか、プログラムによって変更を実装できます。 他の種類のプロパティを表示および編集するためのプロパティ シートの実装はオプションです。 
  
通常、次の状況でプロパティ シートを表示する必要があります。
  
- クライアントが状態オブジェクトの [IMAPIStatus::SettingsDialog メソッドを呼び出す](imapistatus-settingsdialog.md) 場合。 
    
- MAPI がプロバイダー オブジェクトのログオン メソッドを呼び出す場合。
    
- MAPI がプロバイダーのメッセージ サービスのエントリ ポイント関数を呼び出す場合。
    
トランスポート プロバイダーは、メッセージ オプションに関連するプロパティを表示するためのプロパティ シートも実装し、アドレス帳プロバイダーは、メッセージング ユーザーと配布リスト、高度な検索条件、および新しいユーザーを入力するためのテンプレートに関する詳細情報を表示および編集するためのプロパティ シートを実装します。
  
次の 3 つの方法のいずれかを使用して、プロパティ シートを作成できます。
  
- ダイアログ ボックスと同じ方法で手動で実行します。
    
- SDK のプロパティ シート共通コントロールを使用Windowsします。
    
- MAPI 表示テーブルを使用します。
    
プロバイダーは、最後のオプションを選択する必要があります (表示テーブルを使用してプロパティ シートを作成します)。 これは、ユーザー インターフェイスを操作する必要が無いので、最もWindowsです。 
  
メッセージ サービスのプロパティの表示テーブルから構築されたプロパティ シートを実装するには、次の手順を使用します。
  
1. [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md)を呼び出して、現在のプロファイルでセクションを開きます。 [MAPIUID または NULL を](mapiuid.md)渡して、プロバイダーのプロファイル セクションを開きます。 
    
2. [CreateIProp を呼び](createiprop.md)出してプロパティ データ オブジェクトを作成します。 
    
3. プロファイル セクションの [IMAPIProp::CopyTo](imapiprop-copyto.md) メソッドを呼び出して、セクションのすべてのプロパティをプロパティ データ オブジェクトにコピーします。 
    
4. プロパティ シートに表示するコントロールを記述し[、BuildDisplayTable](builddisplaytable.md)関数を呼び出す 1 つ以上の[DTPAGE](dtpage.md)構造を構築するか、カスタム コードを実装して、表示テーブルを作成します。 
    
5. [IMAPISupport::D oConfigPropsheet を](imapisupport-doconfigpropsheet.md)呼び出して、コピーされたプロパティを持つプロパティ シートを表示します。 プロパティ データ オブジェクトへのポインターを  _lpConfigData_ パラメーターとして渡し、表示テーブルへのポインターを  _lpDisplayTable パラメーターとして渡_ します。 このプロパティ シートの既定のアクセス モードを上書きする場合は、読み取り専用プロパティを表す表示テーブルの各コントロールに DT_EDITABLE フラグを設定しません。 
    
6. プロパティ シートですべての変更が行われた場合は、プロパティ データ オブジェクトの **IMAPIProp::CopyTo** メソッドを呼び出して、変更したプロパティをプロファイル セクションにコピーし直します。 
    
表示テーブルの概要については、「表示テーブル」 [を参照してください](display-tables.md)。 
  
表示テーブルの詳細については、「表示テーブルの [実装」を参照してください](display-table-implementation.md)。 
  
コントロールの実装の詳細については、「コントロール オブジェクトの [実装」を参照してください](control-object-implementation.md)。
  
表示テーブルリスト ボックスでユーザーが選択したコントロールのインデックスを取得するには、ユーザーが **[OK]** または [適用] をクリックするまで待 **ちます**。 この時点で、選択したアイテムのエントリ識別子は [、DTBLLBX](dtbllbx.md)構造体の **ulPRSetProperty** メンバーによって指定されたプロパティの値として [IMAPIProp : IUnknown](imapipropiunknown.md)インターフェイスに書き戻されます。 
  
リスト ボックスからアイテムを追加または削除できる必要がある場合は、表示テーブルを使用し [、IMAPISupport::D oConfigPropsheet](imapisupport-doconfigpropsheet.md) メソッドは機能しません。 代わりに、Win32 プロパティ シート API を使用してプロパティ シートを実装し、そのファイルに含comdlg32.dllしてください。 
  
## <a name="see-also"></a>関連項目



[MAPI サービス プロバイダー](mapi-service-providers.md)

