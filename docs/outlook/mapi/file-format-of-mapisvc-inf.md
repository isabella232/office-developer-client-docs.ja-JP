---
title: MapiSvc.inf のファイル形式
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
api_type:
- COM
ms.assetid: b48eda17-83a8-4dc4-85c8-4ca827d13d25
description: '最終更新日: 2011 年 7 月 23 日'
ms.localizationpriority: high
ms.openlocfilehash: b6711b1a77b7741602acf5f96755339682ae0d45
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59576290"
---
# <a name="file-format-of-mapisvcinf"></a>MapiSvc.inf のファイル形式

**適用対象**: Outlook 2013 | Outlook 2016 
  
MapiSvc.inf ファイルは、MAPI メッセージ サービスの構成情報に関する中央データベースの役割を果たします。 MapiSvc.inf には、ワークステーションにインストールされた各メッセージ サービスに関する情報、各メッセージ サービスに属するサービス プロバイダーに関する情報、および MAPI サブシステムに関する情報が格納されています。 MapiSvc.inf は、プロファイルについての主要な情報源です。 つまり、新しいプロファイルの作成時または既存のプロファイルの変更時に、各メッセージ サービスまたは各サービス プロバイダーの関連情報は MapiSvc.inf からコピーされるということです。 
  
MapiSvc.inf は、リンクされた階層的なセクションに分割されています。
  
1. すべてのプロファイルに適用される情報を格納しているセクション。 このセクションには、3 つの部分があります。
    
   - **[Services]** セクションには、それに続くメッセージ サービスの各セクションへのリンクが示されています。 
    
   - **[Help File Mappings]** セクションには、メッセージ サービスが提供する .HLP ファイルに関する情報が格納されています。 
    
   - **[Default Services]** セクションには、既定のインストールを構成するメッセージ サービスのリストが示されています。 
    
2. 個別のメッセージ サービスに適用される情報を格納しているセクション。 これに該当するセクションのエントリには、それに続くサービス プロバイダー セクションへのリンクが示されています。
    
3. メッセージ サービスの個別のサービス プロバイダーに適用される情報を格納しているセクション。
    
次の図は、一般的な MapiSvc.inf ファイルの構造を示しています。 3 つのメッセージ サービス AB、MsgService、および MS があります。 各メッセージ サービスの等号の右側にある名前は、サービスの表示名です。 それぞれのメッセージ サービスはファイル内の別の場所に独自のセクションを持ち、そのセクションは 1 つ以上のサービス プロバイダー セクションにリンクされています。 メッセージ サービスに属するサービス プロバイダーごとに、1 つのサービス プロバイダー セクションがあります。 AB および MS メッセージ サービスは単一のプロバイダー サービスですが、3 つのサービス プロバイダーは MsgService サービスに属しています。
  
**MapiSvc.inf ファイルの構造**
  
![MapiSvc.inf ファイルの構造](media/amapi_30.gif "MapiSvc.inf ファイルの構造")
  
MAPI は MAPI サブシステムのエントリを格納する MapiSvc.inf ファイルの骨組みバージョンを提供します。 メッセージ サービスの各実装者は、そのサービスと、そのサービスに属するサービス プロバイダーの両方に適合するエントリを追加します。 一部のエントリは必須ですが、それ以外のエントリは省略可能です。 たとえば、MAPI はメッセージ サービスのサービス プロバイダーごとに名前とパスを指定することを必要とします。 この情報がないと、それらを読み込めなくなります。
  
自分のメッセージ サービスのセクション内またはサービス プロバイダーのセクションに必須および省略可能の情報を追加できます。 自分のメッセージ サービスについて説明する情報を配置する場所は、サービスのサービス プロバイダー数によって決まります。 この情報はサービスの各サービス プロバイダーに適用されるため、すべてのプロバイダーがアクセスできるようにする必要があります。 メッセージ サービスのセクションに保存することをお勧めしますが、サービス プロバイダーのすべてのセクションに保存してもかまいません。 情報の保存を 1 回にすることで、不要な複製と複数のコピーの同期を維持する必要性をなくします。
  
メッセージ サービスが単一のプロバイダー サービスの場合は、サービスのセクションではなく、サービス プロバイダーのセクションにすべてのメッセージ サービスの情報を保存します。 サービス プロバイダー セクションのアクセスは、メッセージ サービス セクションのアクセスよりも高速で直接的になります。 
  
パブリックの構成データのみを MapiSvc.inf ファイルに保存します。 プライベートな情報や十分な保護が必要な情報 (パスワードなどの資格情報) は、このファイルに含めてはいけません。 この種の情報は完全に保存しないようにするか、セキュリティで保護されたプロパティとしてプロファイルで保持するようにします。 セキュリティで保護されたプロパティには、暗号化のような組み込みの保護機能があります。
  
## <a name="reference"></a>参照

MAPI がプロバイダー DLL をブロックする場合のエラーをトラブルシューティングする方法の詳細については、「[How to allow MAPI to load unregistered Provider DLLs](https://support.microsoft.com/topic/how-to-allow-mapi-to-load-unregistered-provider-dlls-18d9a1cd-d3d7-fa10-473e-5dfd62d38b0d)」 (未登録のプロバイダー DLL を MAPI で読み込めるようにする方法) を参照してください。

