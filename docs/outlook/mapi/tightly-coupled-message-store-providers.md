---
title: 緊密に結合されたメッセージ ストア プロバイダー
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413228"
---
# <a name="tightly-coupled-message-store-providers"></a>緊密に結合されたメッセージ ストア プロバイダー

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
メッセージ ストア プロバイダーは、トランスポート プロバイダーと緊密に結合できます。 MAPI サービス プロバイダーの緊密な結合とは、ストア プロバイダーとトランスポート プロバイダーが通信してメッセージの送受信プロセスをより効率的に行う 2 つのプロバイダーを実装する方法を意味します。 これを行う利点は、MAPI スプーラーではなく、2 つのサービス プロバイダーが相互に直接やり取りできる場合に、パフォーマンスが向上する可能性がある点です。 メッセージ ストア プロバイダーをトランスポート プロバイダーに緊密に結合するには、トランスポート プロバイダーは、メッセージ ストア プロバイダーのエントリ識別子を MAPI 状態テーブルのトランスポート プロバイダーの行の **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) プロパティに配置する必要があります。 これにより、MAPI スプーラーはストア プロバイダーをトランスポート プロバイダーに接続できます。
  
メッセージ ストア プロバイダーを他のサービス プロバイダーと緊密に結合する必要はありません。 メッセージ ストア プロバイダーと緊密に結合する最も一般的なサービス プロバイダーは、トランスポート プロバイダーです。 これは通常、MAPI スプーラーを使用せずにメッセージの送受信を行う目的で行われます。 たとえば、ユーザーが送信メッセージを送信すると、結合されたメッセージ ストア プロバイダーとトランスポート プロバイダーが直接送信できます。 結合されたサービス プロバイダーは、まず、処理する新しいメッセージが存在する MAPI スプーラーに通知し、MAPI スプーラーがメッセージ ストア プロバイダーからトランスポート プロバイダーにメッセージを転送するプロセスを開始するのを待つ必要があります。 これは、ユーザーのコンピューターとサーバー間のネットワーク トラフィックを最小限に抑えることによって、サーバー ベースのメッセージ ストアを使用する場合に特に利点があります。
  
一般に、サービス プロバイダーを緊密に結合する手順は指定されていません。 ただし、次のガイドラインを使用する必要があります。
  
- サービス プロバイダーを緊密に結合する理由がパフォーマンスである場合は、結合が MAPI サブシステムの一部を、それらのパーツが通常関与するプロセスから取り出すことに注意してください。 これは、結合されたサービス プロバイダー内の個々のパーツが、通常は使用されていない MAPI サブシステムの部分との相互作用をシミュレートする方法で相互に対話する必要があることを意味します。
    
- 緊密に結合されたサービス プロバイダーが他の MAPI コンポーネントとやり取りする場合でも、密に結合されていない場合とまったく同じ方法で操作する必要があります。 たとえば、ユーザーが既定のメッセージ ストアとして結合されたメッセージ ストア プロバイダーとトランスポート プロバイダーを使用しているが、別のトランスポート プロバイダーを使用してメッセージを送信している場合は、ユーザーが道路上のコンピューターを使用してリモート トランスポート プロバイダーに切り替える場合に発生します。密結合されたサービス プロバイダーのメッセージ ストア部分は、スタンドアロン メッセージ ストア プロバイダーである場合と同様に、MAPI スプーラーとやり取りする必要があります。
    
## <a name="see-also"></a>関連項目



[MAPI メッセージ ストア プロバイダーの開発](developing-a-mapi-message-store-provider.md)

