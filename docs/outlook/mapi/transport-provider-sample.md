---
title: トランスポート プロバイダーのサンプル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: e40bb5049c20923de1ba9cce9cf05e3e90f4aa34
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59549856"
---
# <a name="transport-provider-sample"></a>トランスポート プロバイダーのサンプル

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
このサンプルでは、ファイルとディレクトリを使用してメッセージの送受信を行います。 各送信メッセージにテキスト行を追加する非常に単純なプリプロセッサを実装して登録します。 サンプルは、トランスポート ニュートラル カプセル化形式 (TNEF) とテキスト間でメッセージ コンテンツを分割する方法を示しています。 また、すべての構成オプション (プロパティ シート、ウィザード、プログラムによる構成) とメッセージ オプションもサポートしています。 リモート トランスポート インターフェイスはサポートされていません。 
  
このサンプルは、メッセージング[API (MAPI) Outlookサンプルからダウンロードできます](https://go.microsoft.com/fwlink/?LinkId=129740)。
  
|||
|:-----|:-----|
|実行可能ファイル:  <br/> |mrxp32.dll  <br/> |
|ソース コード ディレクトリ:  <br/> |SampleTransportProvider\MRXP  <br/> |
|言語:  <br/> |C++  <br/> |
|プラットフォーム:  <br/> |Visual Studio Vista、Windows Server 2008、Windows XP SP2、および Windows Server 2003 SP1 用にコンパイルする 200 Windows 8  <br/> |
   
## <a name="supported-features"></a>サポートされている機能

このサンプルでは、次の機能がサポートされています。
  
- 新しいメッセージの送信、受信、ポーリングなどの基本的な機能。
    
- 対話型およびプログラムによる構成。
    
- **プロパティの設定を除く IMAPIStatus** インターフェイス。 詳細については [、「IMAPIStatus : IMAPIProp インターフェイス」を参照](imapistatusimapiprop.md) してください。 
    
- スレッドの安全性。
    
- テキスト ファイルへのイベント ログ。 ファイルは、指定したサイズに自動的に制限されます。 すべてのトランスポート セッションで同じファイルが使用されます。
    
## <a name="unsupported-features"></a>サポートされていない機能

このサンプルでは、受信メッセージの非同期検出はサポートされていません。
  
 **サンプル トランスポート プロバイダーをインストールするには**
  
1. サンプル トランスポート プロバイダーをダウンロードするには、「MAPI サンプル[のダウンロードOutlookを参照してください](downloading-the-outlook-mapi-samples.md)。
    
2. MAPI サンプルに保存したフォルダー Outlook探します。 **OutlookMAPISamples- zip フォルダー \<version number\> を右クリック** し、[すべて抽出]**をクリックします**。
    
3. [ **参照] を** クリックし、サンプルを保存する場所を選択し、[抽出] を **クリックします**。
    
4. 2008 Visual Studioを実行します。
    
5. [Visual Studio 2008 で、[ファイル] を **クリック** し、[開く]**を選択し**、[Project/**ソリューション] をクリックします**。
    
6. サンプルを保存した場所を参照し **、[mrxp32.vcproj]** をクリックし、[開く] を **クリックします**。
    
7. [ビルド] **メニューの [** 構成マネージャー] **をクリックします**。
    
8. [構成 **マネージャー]** ダイアログ ボックスで **、mrxp32** 行に移動し、[構成]列で [リリース] を選択し、[閉じる] を **クリックします**。
    
9. [ **ビルド**] メニューで、[ **ソリューションのビルド**] をクリックします。
    
10. [ファイルに **名前を付けて保存]** ダイアログ ボックスで、[保存] を **クリックします**。
    
11. サンプルを保存したフォルダーで、インストール バッチ ファイルを右クリックし、[管理者として実行] **をクリックします**。
    
12. [**ユーザー アカウント制御**] ダイアログ ボックスで、[**続行**] をクリックします。
    
    > [!NOTE]
    > **install.bat** を既定.dll Microsoft Officeインストール フォルダー C:\Program Files\Microsoft Office\Office12 にコピーします。\. 別の場所にOffice製品をインストールしている場合は、[編集] をinstall.bat **クリック****します**。 ファイルが [ファイル] ウィンドウメモ帳。 既定のインストール パスを、コンピューターで使用されるインストール パスに置き換える。 
  
 **トランスポート プロバイダーを設定するには、Outlook**
  
1. [アカウント]**ウィンドウの**[ツール] メニュー Outlook、[アカウント]**をクリック設定。**
    
2. [アカウント **の設定設定]** ダイアログ ボックスの [電子メール] タブ **で**、[新規] を **クリックします**。
    
3. [メール **サービスの選択] で** [ **その** 他] をクリックし **、[MRXP サンプル トランスポート**] を選択し、[次へ] を **クリックします**。
    
4. **[MRXP トランスポート構成] ダイアログ ボックス** に「ユーザー表示名 **」と入力します**。
    
5. [ **受信トレイへのパス (UNC 共有) でフォルダー** パスを入力します。 これは、ローカル フォルダーへのパスにすることもできます。 
    
    > [!IMPORTANT]
    > このパスが存在する必要があります。 
  
6. [**OK**] をクリックします。
    
7. [メール アカウント **の追加] ダイアログ ボックスで****、[OK] をクリックします**。 [完了 **] をクリック** し、[閉じる] **をクリックします**。
    
8. MRXP アカウントの使用を開始するには、サーバーを終了して再起動Outlook。
    
 **トランスポート プロバイダーサンプルを使用してメッセージを送信するには、次のOutlook**
  
1. [ファイル] **メニューの** [新規] を **クリック** し、[メール メッセージ] **をクリックします**。
    
2. [宛先 **] ボックス** に、[MRXP: ] という形式を使用して受信者 **の名前を \<ADDRESS\> 入力します**。 アドレスは、受信者の受信トレイへの UNC 共有またはローカル フォルダー パスです。
    
    > [!NOTE]
    > アドレスにコロンまたは円記号がある場合は、各コロンまたは円記号の前に円記号を挿入する必要があります。 たとえば、[MRXP:C:\Mail\myDir] にメールを送信するには、 を入力する必要があります  `[MRXP:C\:\\Mail\\myDir]` 。 
  
    > [!IMPORTANT]
    > 受信者のアドレスが存在する必要があります。 
  
3. [アカウント **] を** クリックし **、[MRXP サンプル トランスポート] をクリックします**。
    
4. メッセージを入力し、[送信] を **クリックします**。 メッセージは MRXP トランスポート プロバイダーを使用して送信されます。
    
 **トランスポート プロバイダーのサンプルを使用してメッセージを受信するには、次のOutlook**
  
1. [ファイル] **メニューの** [新規] を **クリック** し、[メール メッセージ] **をクリックします**。
    
2. メッセージを入力します。
    
3. [名前を **Microsoft Office]** ボタンをクリックし、[名前を付けて保存] をクリックし、[名前を付けて保存] をクリックして、セットアップ時に指定した受信トレイ フォルダーにファイルを保存します。 
    
4. [名前を **付けて保存** ] ダイアログ ボックスで、受信トレイとして設定した UNC 共有またはローカル フォルダーを参照します。 
    
5. [名前を **付けて保存] ボックス** の一覧で、[**メッセージOutlook] をクリックします**。
    
6. ファイルの名前を入力し、[保存] を **クリックします**。
    
7. ファイルは共有フォルダーに保存されます。 MRXP トランスポート プロバイダーは、受信トレイにメッセージを配信Outlook。
    

