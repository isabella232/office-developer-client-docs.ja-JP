---
title: エントリ識別子の作成
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.localizationpriority: medium
api_type:
- COM
ms.assetid: bc2a9116-948e-4da3-96b8-26d73bcd63c4
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: a68ac05659d6116bb40ea136aa40b49110d4226a
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59611025"
---
# <a name="constructing-entry-identifiers"></a>エントリ識別子の作成

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
エントリ識別子は [ENTRYID 構造で構築](entryid.md) されます。 **ENTRYID 構造体は**、エントリ識別子の属性と実際のエントリ識別子を記述するフラグで構成されます。 
  
## <a name="entryid-structure"></a>ENTRYID 構造

**ENTRYID 構造は** 次のように定義されます。 
  
```cpp
typedef struct
{
    BYTE        abFlags[4];
    BYTE        ab[MAPI_DIM];
}  ENTRYID, FAR *LPENTRYID;
 
```

MAPI_DIMは、MapiDefs.h ヘッダー ファイルで定義されている定数です。 
  
4 バイトの **abFlags** メンバーの最初のバイトは、エントリ識別子の種類と使用について説明し、次の値を持つ場合があります。 
  
- MAPI_NOTRECI — メッセージの受信者としてエントリ識別子を使用できないことを示します。
    
- MAPI_NOTRESERVED — 他のユーザーがエントリ識別子にアクセスできないことを示します。
    
- MAPI_NOW — エントリ識別子を他の時間に使用できないことを示します。
    
- MAPI_SHORTTERM — エントリ識別子が短期的な値を示します。 エントリ識別子の他の使用が許可されていない限り、このバイト内の他のすべての値を設定する必要があります。
    
- MAPI_THISSESSION — エントリ識別子を他のセッションで使用できないことを示します。
    
- MAPI_NOTRESERVED — エントリ識別子を他のサービス プロバイダーが他のオブジェクトに使用できるかどうかを示します。
    
アドレス帳とメッセージ ストア プロバイダーによって作成されるエントリ識別子の ab メンバーは、サービス プロバイダーを識別する 16 バイト[の MAPIUID](mapiuid.md)構造と、オブジェクトを識別する部分の 2 つの部分で構成されます。 **MAPIUID は** 、グローバル一意識別子 (GUID) を含む構造体です。 GUID はバイトオーダーに依存しない識別子で、GUID の作成 * ツールMicrosoft Visual Studio *使用* して作成できます。 
  
サービス プロバイダーは [、IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md)メソッドへの呼び出しで、ログオン プロセス中に **MAPIUID** 構造を MAPI に登録します。 クライアントが **OpenEntry** メソッドを呼び出してオブジェクトにアクセスすると、MAPI は **MAPIUID** 構造を使用して、そのアクセスを提供できるサービス プロバイダーを特定します。 サービス プロバイダーは、DLL のすべてのバージョンで同じ **MAPIUID** 構造を使用する必要があります。 これにより、新しいバージョンのクライアントは、以前のバージョンで送信および保存されたメッセージに応答できます。 
  
16 バイト **の** **MAPIUID** の後の ab メンバーの残りの部分には、特定のオブジェクトを識別するためのサービス プロバイダー固有のバイナリ データが含まれています。 エントリ識別子のこの部分に固定サイズはありません。 理由の範囲内で、任意のサイズを指定できます。 サービス プロバイダーには、通常、エントリ識別子のこの部分に次の情報が含まれます。 
  
- バージョン情報 : サービス プロバイダーがエントリ識別子の形式をバージョンからバージョンに変更する場合が一般的なので、バージョン情報を保存すると、エントリ識別子を解読する方法をすばやく判断できます。
    
- 位置情報 - 位置情報は、サービス プロバイダーにエントリ識別子で表されるオブジェクトを見つける方法を示す指標を提供するデータです。 たとえば、サービス プロバイダーは、オブジェクトが格納されたデータ ファイルの最後の場所のディスク オフセットを格納できます。 この種類の情報は時間の流中に変化する可能性があるため、サービス プロバイダーは、エントリ識別子内のオブジェクトを検索するための複数の方法を提供する必要があります。
    
サービス プロバイダーはエントリ識別子をリサイクルすることができますが、この方法は避ける必要があります。 エントリ識別子を再利用する必要がある場合、サービス プロバイダーは、最初の使用と再利用の間に経過する期間を可能な限り長くする必要があります。 また、エントリ識別子は、同じ種類の別のオブジェクトに再割り当てする必要があります。 つまり、特定のエントリ識別子を最初にメッセージに関連付け、次にフォルダーに関連付けない必要があります。
  
## <a name="see-also"></a>関連項目



[MAPI エントリ識別子](mapi-entry-identifiers.md)

