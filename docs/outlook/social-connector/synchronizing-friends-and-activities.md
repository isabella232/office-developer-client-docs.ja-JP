---
title: 友だちとアクティビティの同期
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: 6e91b765-a207-4d8c-8763-5d643ca4d0c0
description: ソーシャル Outlook (OSC) は、連絡先カードまたはユーザー ウィンドウ内のユーザーに関するソーシャル ネットワークからの情報Outlookサポートしています。 SharePointプレゼンス情報SharePointサポートするサーバー、SharePoint Office、Lync クライアント、およびすべてのクライアント アプリケーションが連絡先カードをサポートします。
ms.openlocfilehash: f86441e18697de26fe41cc7b680c85abb28ec27f
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59604076"
---
# <a name="synchronizing-friends-and-activities"></a>友だちとアクティビティの同期

ソーシャル Outlook (OSC) は、連絡先カードまたはユーザー ウィンドウ内のユーザーに関するソーシャル ネットワークからの情報Outlookサポートしています。 SharePointプレゼンス情報SharePointサポートするサーバー、SharePoint Office、Lync クライアント、およびすべてのクライアント アプリケーションが連絡先カードをサポートします。
  
連絡先カードは、Officeアプリケーションのコラボレーション シナリオで使用して、共同作業を行うユーザーの詳細を確認できます。 これらのシナリオの例としては、Word でのドキュメントのOutlook、ドキュメントの共同編集が含まれます。 連絡先カードの **[新しい** 情報] タブをクリックすると、そのユーザーに関する情報が表示されます。 
  
[Outlook] ウィンドウには、選択したユーザーアイテムの送信者または受信者になOutlook情報が表示されます。 ユーザー ウィンドウまたは Outlook エクスプローラーの別のアイテムで別のユーザーを選択するか、インスペクターで Outlook アイテムを開くたびに、Outlook Social Connector (OSC) は People Pane を更新します。 
  
連絡先カードまたはユーザー ウィンドウで選択したユーザーの現在の情報を表示するには、OSC は OSC プロバイダーと何らかの形式のキャッシュを使用してこのような情報を同期します。 この同期は、クライアント コンピューターにインストールされている OSC プロバイダー、OSC プロバイダーを介してログオンしたソーシャル ネットワーク、およびこれらのソーシャル ネットワークの各 OSC プロバイダーがサポートする同期モードによって異なります。
  
OSC では、友人、友人以外、友人以外のアクティビティの同期を、キャッシュ同期、オンデマンド同期、ハイブリッド同期など、さまざまな方法でサポートしています。 これらの同期モードの主な違いは、OSC がユーザーの既定の Outlook ストアのフォルダーにあるか、ユーザーのコンピューター上のメモリにあるかなど、データを格納する場所です。 このトピックで説明した各ケースでは、データが更新される前に、データがフォルダーまたはメモリに残る既定の最小時間があります。 場合によっては、グループ ポリシーによって最小時間をカスタマイズできます。 OSC の動作を制御するグループ ポリシーの詳細については、「グループ ポリシーを使用してソーシャル コネクタを管理するOutlook方法」[を参照してください](https://support.microsoft.com/default.aspx?scid=kb%3Ben-US%3B2020103)。
  
選択したユーザーがソーシャル ネットワークのメンバーではない場合、OSC は連絡先カードまたはユーザー ウィンドウに、そのユーザーのユーザーまたはアクティビティ情報を表示しない点に注意してください。
  
## <a name="cached-synchronization"></a>キャッシュされた同期

OSC プロバイダーは、ソーシャル ネットワーク上のフレンドの情報を、ユーザーの既定の Outlook ストア上の特定のフォルダーに格納し、指定した時間の経過後に定期的にキャッシュを更新できます。 フォルダー内の情報をキャッシュすると、ソーシャル ネットワークへのトラフィックを減らす利点があります。
  
> [!NOTE]
> ソーシャル コネクタ 2013 Outlook、OSC はアクティビティのキャッシュ同期をサポートしなくなりました。 
  
### <a name="cached-synchronization-of-friends"></a>友人のキャッシュ同期

OSC プロバイダーが友人のキャッシュ同期をサポートしている場合、OSC はソーシャル ネットワーク上のログオンしているユーザーの友人の情報をキャッシュします。 この情報は、ユーザーの既定Outlookのソーシャル ネットワークに固有の連絡先フォルダーにキャッシュOutlookされます。 連絡先フォルダー名は [、ISocialProvider::SocialNetworkName](isocialprovider-socialnetworkname.md) プロパティを使用して OSC が取得するソーシャル ネットワークの名前に基づいて行います。 
  
キャッシュされた同期では、OSC はログオンしているユーザーの友人についての情報のみをソーシャル ネットワークに保存します。 OSC は、友人以外の情報にはアクセスしない。
  
ソーシャル ネットワークからの友人の情報の連絡先フォルダーを更新する OSC の既定の間隔は、1 日に 1 回 (または 1440 分に 1 回) です。 この更新間隔は、このトピックの冒頭で説明したように、グループ ポリシーによって設定できます。
  
更新中にエラーが発生した場合、OSC は機能 XML の **contactSyncRestartInterval** 要素で指定された間隔で **再試行** します。 この再試行間隔の既定値は 30 分で、グループ ポリシーで設定できます。 
  
ユーザーが連絡先カードを開き、[新しい情報] タブを選択すると、[新しい情報] タブ **が** 更新されます。 同様に、ユーザー Outlookユーザーがユーザー ウィンドウでアイテムを再選択するかOutlookユーザー ウィンドウでユーザーを再選択すると、ユーザー ウィンドウが更新されます。 キャッシュ更新間隔の有効期限が切れていない場合、OSC はキャッシュにアクセスして、選択したユーザーの情報を取得します。 これにより、OSC プロバイダーの機能拡張を使用してソーシャル ネットワークにアクセスするオーバーヘッドを回避できます。 更新間隔の有効期限が切れている場合、OSC は [ISocialPerson::GetFriendsAndColleagues](isocialperson-getfriendsandcolleagues.md) メソッドを呼び出して、ログオンしているユーザーの現在のフレンドの情報を取得し、連絡先フォルダー内のキャッシュを更新します。 
  
OSC プロバイダーは、機能 XML で次の要素を指定することで、友人のキャッシュされた同期をサポートすると OSC **に通知** します。 
  
- **getFriends**  = **true**
    
- **cacheFriends**  = **true**
    
- **dynamicContactsLookup**  = **false**
    
## <a name="on-demand-synchronization"></a>オンデマンド同期

ユーザーが連絡先カードの[新しいアイテム] タブを選択するか、Outlook の [ユーザー ウィンドウ] で別の Outlook アイテムまたは別のユーザーを選択すると、OSC によって連絡先カードまたはユーザー ウィンドウがそれぞれ更新されます。 OSC プロバイダーがユーザーまたはアクティビティのオンデマンド同期をサポートしている場合、OSC はメモリ内のキャッシュと同期し、連絡先カードまたはユーザー ウィンドウの名前、タイトル、画像、アクティビティ ストリームなどの詳細を更新します。 オンデマンド同期の場合、キャッシュされた同期とは異なり、OSC は、そのユーザーがソーシャル ネットワーク上のログオン ユーザーの友人または非友人かどうかに関係なく、そのユーザーの情報を更新します。 
  
オンデマンドのユーザー (またはアクティビティ) データはメモリにのみ格納されます。 Office クライアント アプリケーションがシャットダウンした場合、またはユーザーが連絡先カードまたはユーザー ウィンドウの更新を行い、データが更新間隔よりも長い間メモリ内に残っている場合、メモリ内データは消去されます。 ソーシャル ネットワークからの更新は、常にユーザーが連絡先カードまたはユーザー ウィンドウを更新することで開始されます (たとえば、ユーザー ウィンドウで別のユーザーを選択したり、Outlook エクスプローラー ウィンドウで別のアイテムを選択したりします)。 

ただし、この逆は常に true とは限りません。連絡先カードまたはユーザー ウィンドウの更新ごとに、必ずしもソーシャル ネットワークからの更新が発生するわけではありません。 ユーザーが連絡先カードまたはユーザー ウィンドウを更新し、ユーザー (またはアクティビティ) データが更新間隔よりも長くメモリ内に残っている場合、OSC は [ISocialSession2::GetPeopleDetails](isocialsession2-getpeopledetails.md) ( [または ISocialSession2::GetActivitiesEx)](isocialsession2-getactivitiesex.md)を呼び出して、ソーシャル ネットワークからメモリ内の情報を更新します。 メモリ内のフレンド情報とフレンド以外の情報の許可期間は 24 時間で、アクティビティの場合は 30 分です。 
  
キャッシュ同期とオンデマンド同期の重要な違いの 1 つは、オンデマンド同期によって、ネットワーク上の友人と友人以外の両方の人とアクティビティの情報を取得できる点です。 選択したユーザーがフレンド以外の場合、OSC は、次のいずれかの要件が満たされている場合、そのユーザーの情報とアクティビティを更新します。 
  
- ユーザーはソーシャル ネットワーク上のユーザーであり、プロファイルとアクティビティ情報のパブリック表示を許可します。
    
- そのユーザーは、そのソーシャル ネットワーク上のログオンユーザーと同じネットワーク内にいます (たとえば、大学の同窓生の同じネットワーク内)。
    
ユーザーとアクティビティのオンデマンド同期により、OSC コア エンジンからプロバイダーへの呼び出しが増加します。 ソーシャル ネットワークは、オンデマンド同期の帯域幅要件の増加を処理できる必要があります。
  
### <a name="specifying-xml-elements-for-on-demand-synchronization"></a>オンデマンド同期用の XML 要素の指定

OSC プロバイダーは、機能 XML で次の要素を指定することにより、友人と友人以外のオンデマンド同期をサポートすると OSC **に通知** します。 
  
- **getFriends**  = **true**
    
- **cacheFriends**  = **false**
    
- **dynamicContactsLookup**  = **true**
    
OSC プロバイダーは、機能 XML で次の要素を指定することにより、アクティビティのオンデマンド同期をサポートすると OSC **に通知** します。 
  
- **getActivities**  = **true**
    
- **cacheActivities**  = **false**
    
- **dynamicActivitiesLookupEx**  = **true**
    
## <a name="hybrid-synchronization"></a>ハイブリッド同期

OSC プロバイダーは、友人と友人以外のハイブリッド同期をサポートできます。 これにより、OSC コア エンジンと OSC プロバイダー間の呼び出し、フレンドのオンデマンド同期のためのソーシャル ネットワークへの呼び出し、および友人のデータの通貨を最適化できます。 データがフォルダーまたはメモリ内に残る最小時間 (該当する場合) は、キャッシュまたはオンデマンド同期モードの制限と同じです。
  
> [!NOTE]
> ソーシャル コネクタ 2013 Outlookから、OSC は、アクティビティのオンデマンド同期のみをサポートし、アクティビティのハイブリッド同期をサポートしなくなりました。 
  
### <a name="hybrid-synchronization-of-friends-and-non-friends"></a>友人と友人以外のハイブリッド同期

OSC プロバイダーが友人と友人以外のハイブリッド同期をサポートしている場合、OSC は次の処理を実行します。 
  
- OSC は、ログオンしているユーザーの友人の情報をソーシャル ネットワーク固有の連絡先フォルダーに格納します。
    
- OSC は、ログオンしているユーザーの友人以外の情報をメモリに格納します。
    
OSC プロバイダーは、機能 XML で次の要素を指定することで、友人と友人以外のハイブリッド同期をサポートすると OSC **に通知** します。 
  
- **getFriends**  = **true**
    
- **cacheFriends**  = **true**
    
- **dynamicContactsLookup**  = **true**
    
## <a name="synchronization-intervals"></a>同期間隔

次の表は、サポートされている同期モードに応じて、対応するキャッシュ (フォルダーまたはメモリ) とソーシャル ネットワークとの間の友人と友人以外の情報の同期間隔を要約しています。 ハイブリッド同期モードの場合は、友人のキャッシュ モードの行と、フレンド以外のオンデマンド モードの行を参照してください。
  
|**ユーザーの同期モード**|**更新間隔が設定されている場所**|**更新前の既定の最小時間**|**グループ ポリシーの上書き**|
|:-----|:-----|:-----|:-----|
|Cached  <br/> |OSC 内で設定する  <br/> |1440 分 (24 時間)  <br/> |Windows値 **NetContactSyncInterval** <br/> |
|Cached  <br/> |機能 XML **の contactSyncRestartInterval** **要素**  <br/> |**contactSyncRestartInterval が** 設定されていない場合は 30 分  <br/> |Windowsの値 **contactSyncRestartInterval** <br/> |
|オンデマンド  <br/> |OSC 内で設定する  <br/> |1440 分 (24 時間)  <br/> |Windowsレジストリ値 **OnlineSearchExpiryTime** <br/> |
   
次の表は、サポートされている同期モードに応じて、対応するキャッシュ (フォルダーまたはメモリ) とソーシャル ネットワークとの間の友人と友人以外のアクティビティの同期間隔をまとめたものです。 
  
|**アクティビティの同期モード**|**更新間隔が設定されている場所**|**更新前の既定の最小時間**|**グループ ポリシーの上書き**|
|:-----|:-----|:-----|:-----|
|オンデマンド  <br/> |OSC 内で設定する  <br/> |30 分  <br/> |Windowsレジストリ値 **OnlineSearchExpiryTime** <br/> |
   
次の情報は、2 つのWindowsレジストリ値に適用されます。
  
- キー:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\Outlook\SocialConnector`
    
- 値: 1 ~ 10080 の DWORD 値
    
## <a name="see-also"></a>関連項目

- [機能 XML の例](capabilities-xml-example.md)  
- [機能の XML](xml-for-capabilities.md)
- [OSC XML スキーマを使用したプロバイダーの開発](developing-a-provider-with-the-osc-xml-schema.md)  
- [グループ ポリシーを使用Outlookソーシャル コネクタを管理する方法](https://support.microsoft.com/default.aspx?scid=kb%3Ben-US%3B2020103)

