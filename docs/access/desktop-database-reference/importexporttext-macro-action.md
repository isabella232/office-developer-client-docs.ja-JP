---
title: ImportExportText マクロ アクション
TOCTitle: ImportExportText macro action
ms:assetid: 366fa095-6f09-7c22-e734-bfa585cfe79e
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192475(v=office.15)
ms:contentKeyID: 48544171
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm168097
f1_categories:
- Office.Version=v15
ms.localizationpriority: medium
ms.openlocfilehash: ce2e04ce40a6cea6db285b6df93097e2553695c4
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59594175"
---
# <a name="importexporttext-macro-action"></a>ImportExportText マクロ アクション

**適用先**: Access 2013、Office 2013

**ImportExportText** アクションを使用すると、現在の Microsoft Access データベース (.mdb または .accdb) または Access プロジェクト (.adp) とテキスト ファイルの間でテキストをインポートまたはエクスポートできます。 また、テキスト ファイルのデータを現在の Access データベースにリンクすることもできます。 リンクされたテキスト ファイルを使えば、ワード プロセッシング プログラムからデータに完全にアクセスできる状態で、Access でテキスト データを表示することができます。 HTML ファイルのテーブルまたはリストからインポート、エクスポート、およびリンクを行 \*.html。

> [!NOTE]
> テキスト ファイルまたは HTML ファイルのデータにリンクする場合、Access ではデータが読み取り専用になります。 このアクションは、データベースが信頼されていない場合には許可されません。 

## <a name="setting"></a>Setting

**ImportExportText** アクションの引数は次のとおりです。

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>アクションの引数</p></th>
<th><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Transfer Type/転送の種類</strong></p></td>
<td><p>変換の種類を指定します。 区切りテキスト ファイル、固定長テキスト ファイル、または HTML ファイル間でデータをインポート、エクスポート、リンクすることができます。 また、データを Microsoft Word 差し込みデータ ファイルにエクスポートすることもできるため、Word の差し込み印刷機能を使用して、定型書簡および宛名ラベルなどの差し込み文書を作成できます。 [マクロ ビルダー] ウィンドウの [<strong>アクションの引数</strong>] セクションにある [<strong>変換の種類</strong>] ボックスで、[<strong>区切り記号付きインポート</strong>]、[<strong>固定長インポート</strong>]、[<strong>HTML インポート</strong>]、[<strong>区切り記号付きエクスポート</strong>]、[<strong>固定長エクスポート</strong>]、[<strong>HTML エクスポート</strong>]、[<strong>Word 差し込みデータ エクスポート</strong>]、[<strong>区切り記号付きリンク</strong>]、[<strong>固定長リンク</strong>]、または [<strong>HTML リンク</strong>] を選択します。 既定値は [<strong>区切り記号付きインポート</strong>] です。</p><p><strong>注</strong>: <STRONG></STRONG>Access プロジェクト<STRONG></STRONG>(.adp) では、<STRONG></STRONG>区切られたインポート、固定幅のインポート、区切り文字のエクスポート、固定幅のエクスポート、<STRONG>または Windows Merge</STRONG>転送の種類の Word のエクスポートだけがサポートされています。 <STRONG></STRONG></p></td>
</tr>
<tr class="even">
<td><p><strong>Specification Name/定義名</strong></p></td>
<td><p>テキスト ファイルをインポートまたはリンクする方法を決定するオプション セットの定義名を指定します。固定幅テキスト ファイルの場合、引数を指定するか、インポートまたはリンクするテキスト ファイルと同じフォルダーにある schema.ini ファイルを使用する必要があります。</p>
<p>テキスト ファイルをインポートまたはリンクするための定義を作成するには、次の操作を行います。</p>
<ol>
<li><p>[<strong>外部データの取り込み</strong>] ダイアログ ボックスで、[<strong>ファイル名</strong>] ボックスにソース テキスト ファイルのパスを入力します。</p></li>
<li><p>データの格納に必要なオプション (インポート、追加、またはリンク) をクリックし、[<strong>OK</strong>] をクリックします。</p></li>
<li><p>[<strong>テキスト インポート ウィザード</strong>] ダイアログ ボックスの [<strong>設定</strong>] をクリックします。</p></li>
<li><p>この定義に必要なオプションを指定し、[<strong>名前を付けて保存</strong>] をクリックします。</p></li>
<li><p>この定義の名前を入力し、[<strong>OK</strong>] をクリックします。</p></li>
<li><p>定義のダイアログ ボックスで [<strong>定義</strong>] をクリックすると、既存の定義を管理できます。</p></li>
<li><p>[<strong>OK</strong>] をクリックして定義のダイアログ ボックスを閉じます。</p></li>
</ol>
<p></p>
<p>次に、この引数に設定済みの定義名を入力すると、その定義に対応する形式のテキスト ファイルをインポートまたはエクスポートできます。 区切り記号付きテキスト ファイルは、この引数に定義名を入力しなくても、インポート、エクスポート、またはリンクができます。 この場合、ウィザードのダイアログ ボックスの既定値が使用されます。 差し込みデータ ファイルの場合はあらかじめ定義された書式が使用されるため、この引数に定義名を入力しなくてもエクスポートできます。 HTML ファイルでもインポート定義およびエクスポート定義を使用できますが、適用されるのは、データ型の書式定義の部分だけです。</p></td>
</tr>
<tr class="odd">
<td><p><strong>Table Name/テーブル名</strong></p></td>
<td><p>テキスト データのインポート先、エクスポート元、またはリンク先となる Access のテーブル名を指定します。 また、データのエクスポート元として Access のクエリ名を入力することもできます。 この引数は省略できません。 [<strong>変換の種類</strong>] ボックスで [<strong>区切り記号付きインポート</strong>]、[<strong>固定長インポート</strong>]、または [<strong>HTML インポート</strong>] をクリックすると、テーブルが既に存在する場合は、テキスト データがこのテーブルに追加されます。 テーブルが存在しない場合は、新しいテーブルが作成、指定したテキスト データがインポートされます。 <strong>ImportExportText</strong> アクションを使用する場合、エクスポートするデータを SQL ステートメントを使って指定することはできません。 SQL ステートメントを使うのではなく、クエリを作成してから、<strong>Table Name/テーブル名</strong>引数にそのクエリの名前を指定する必要があります。</p></td>
</tr>
<tr class="even">
<td><p><strong>File Name/ファイル名</strong></p></td>
<td><p>インポート、エクスポート先、またはリンク先のテキスト ファイルの名前。 ファイル名が既存のワークシートの名前と同じ場合、既存のワークシートが置き換えられます。 この引数は省略できません。 Access からデータをエクスポートすると、新しいテキスト ファイルが作成されます。 ファイル名が既存のテキスト ファイルの名前と同じ場合、Access によって既存のテキスト ファイルが置き換わります。 HTML ファイル内の特定のテーブルまたはリストをインポートまたはリンクする場合は、HTML Table Name 引数 <strong>を使用</strong> できます。</p></td>
</tr>
<tr class="odd">
<td><p><strong>Has Field Names/フィールド名の設定</strong></p></td>
<td><p>テキスト ファイルの先頭行をフィールド名とするかどうかを指定します。 [<strong>はい</strong>] を選択した場合は、テキスト データをインポートまたはリンクするときに、先頭行の名前が Access のテーブルのフィールド名として使用されます。 [<strong>いいえ</strong>] を選択した場合は、先頭行が通常のデータ行として処理されます。 既定値は [<strong>いいえ</strong>] です。<br/><br/>この引数は、先頭行に必ずフィールド名を含む Word の差し込みデータ ファイルに対しては無効です。 この引数に [<strong>はい</strong>] を指定した場合、Access のテーブルまたは選択クエリを区切り記号付きテキスト ファイルや固定幅テキスト ファイルにエクスポートすると、テーブルまたは選択クエリのフィールド名がテキスト ファイルの先頭行に挿入されます。<br/><br/>この引数に [<strong>はい</strong>] を指定して、固定幅テキスト ファイルをインポートまたはリンクする場合は、インポート定義またはエクスポート定義で設定されたフィールド区切り記号を使用して、先頭行のフィールド名を区切る必要があります。 この引数で [<strong>はい</strong>] を指定して、固定幅テキスト ファイルにエクスポートする場合は、この区切り記号で区切られたフィールド名が、テキスト ファイルの先頭行に挿入されます。</p></td>
</tr>
<tr class="even">
<td><p><strong>HTML Table Name/HTML テーブル名</strong></p></td>
<td><p>インポートまたはリンクする HTML ファイル内のテーブルまたはリストの名前。 この引数は、[転送の種類] 引数が <strong>[HTML</strong> のインポート] または [リンク HTML] に設定されていない限り、無視されます。 この引数を空白のままにすると、HTML ファイル内の最初のテーブルまたはリストがインポートまたはリンクされます。 <br/><br/>HTML ファイル内のテーブル名またはリスト名は、CAPTION タグがある場合は CAPTION タグで指定されたテキスト &lt; &gt; によって &lt; 決 &gt; まります。 &lt;CAPTION&gt; タグが存在しない場合、この名前は &lt;TITLE&gt; タグで指定されたテキストによって決まります。 複数のテーブルまたはリストに同じ名前がある場合、Access は各名前の末尾に番号を追加して区別します。たとえば、Employees1 と Employees2 などです。</p></td>
</tr>
<tr class="odd">
<td><p><strong>コード ページ</strong></p></td>
<td><p>コード ページで使用する文字セットの名前を指定します。</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>注釈

Access の選択クエリのデータをテキスト ファイルにエクスポートできます。クエリの結果セットもテーブルと同じようにエクスポートされます。

既存の Access のテーブルに追加するテキスト データは、テーブルの構造との互換性が必要です。

- テキストの各フィールドのデータ型は、テーブルの対応するフィールドのデータ型と同じにする必要があります。

- フィールドは同じ順序にする必要があります (ただし、**Has Field Names/フィールド名の設定** 引数を [**はい**] に設定した場合は、テキストのフィールド名とテーブルのフィールド名を同じにする必要があります)。

このアクションの動作は、[**外部データ**] タブの [**インポート**] または [**エクスポート**] で [**テキスト ファイル**] をクリックした場合の動作と同じです。**ImportExportText** アクションの引数は、[**テキスト ファイル**] コマンドで開始するウィザードのオプションに対応しています。

> [!TIP]
> インポート定義およびエクスポート定義には、テキスト ファイルをインポート、エクスポート、またはリンクするのに必要な情報が保存されます。保存した定義は、同じ形式のテキスト ファイルをインポート、エクスポート、またはリンクする際に使用できます。たとえば、毎週の売上高をメインフレーム コンピューターから取り出してテキスト ファイルに変換するとします。このような変換の定義を作成して保存しておくと、この定義を使っていつでも Access データベースにデータを追加できます。

> [!NOTE]
> リンクしたテキスト ファイルに対してクエリを実行するか、フィルターを適用する場合は、大文字と小文字が区別されます。

Visual Basic for Applications (VBA) モジュールで **ImportExportText** アクションを実行するには、**DoCmd** オブジェクトの **TransferText** メソッドを使用します。

