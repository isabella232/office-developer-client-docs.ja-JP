---
title: Format 関数 (カスタム web アプリケーションのアクセス) 用のカスタムの数値書式
manager: kelbow
ms.date: 08/18/2017
ms.audience: Developer
ms.assetid: 97efe972-d873-47d7-be81-8ae3461870c4
description: ユーザー定義の数値書式を作成して数値の表示方法を制御する方法について説明します。
ms.localizationpriority: high
ms.openlocfilehash: c9b7c1b828be0efecb9194657a7e8b321b024e5a
ms.sourcegitcommit: a1d9041c20256616c9c183f7d1049142a7ac6991
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59573321"
---
# <a name="custom-numeric-formats-for-the-format-function-access-custom-web-app"></a>Format 関数 (カスタム web アプリケーションのアクセス) 用のカスタムの数値書式

ユーザー定義の数値の書式を作成することで、数値の表示方法を制御する方法について説明します。
  
> [!IMPORTANT]
> マイクロソフトを作成して、sharepoint web アプリケーションのアクセスを使用して不要になったをお勧めします。代わりに、web およびモバイル デバイス用のコードのないビジネス ソリューションを構築する[マイクロソフトの PowerApps](https://powerapps.microsoft.com/en-us/)を使用して検討してください。 

ユーザー定義の数値書式を作成して数値の表示方法を変更できます。ユーザー定義の数値書式は、セミコロン (;) で区切られた 1 ～ 3 つのセクションを持つことができます。[Format 関数 (Access カスタム Web アプリ)](format-function-access-custom-web-app.md) 関数の Style 引数に事前定義されたいずれかの数値書式が含まれる場合、1 つのセクションのみを使用できます。 
  
## <a name="format-specifications"></a>書式指定
<a name="bk_addresources"> </a>

次の表は、ユーザー定義の数値書式の作成に使用できる文字をリストしています。
  
|**書式指定**|**説明**|
|:-----|:-----|
|なし  <br/> |書式設定されていない数値が表示されます。  <br/> |
|**0** (0 文字)  <br/> |桁のプレースホルダーです。数字または 0 を表示します。式に、書式指定文字列で 0 が指定されている場所に数字がある場合は、該当する数字がその桁に表示されます。それ以外の場合は、その場所に 0 を表示します。  <br/> 数値の整数部または小数部の桁数が、書式指定式内の 0 の桁数に満たない場合は、その桁位置には 0 を表示します。数値の小数部の桁数が、書式指定式の小数部で指定されている 0 の数より多い場合は、0 の数と同じ桁数に数値が丸められます。数値の整数部の桁数が、書式指定式の整数部の 0 の数より多い場合は、桁をそのまま表示します。  <br/> |
|#  <br/> |桁のプレースホルダーです。数字を表示するか、何も表示しません。書式指定文字列で # 文字が指定されている場所に該当する桁が、式の結果にある場合は、該当する数字が表示されます。それ以外の場合は、その場所には何も表示されません。  <br/> この記号は 0 桁プレースホルダーとまったく同様の機能を持ちます。ただし、数値の桁数が、書式指定式の整数部および小数部にある # 記号よりも少ない場合でも、先頭および末尾に 0 が表示されません。  <br/> |
|. (ドット文字)  <br/> |小数点のプレースホルダーです。小数点のプレースホルダーにより、整数部および小数部に表示する桁数が決まります。書式指定式でこの記号の左に # 記号だけがある場合、1 未満の数値の先頭は小数点区切り記号になります。小数値の先頭に 0 を表示するには、整数部の最初の桁のプレースホルダーとして 0 を使用します。ロケールによっては、桁区切り記号としてコンマが使用されます。書式指定結果で小数点のプレースホルダーとして実際に使用される記号は、システムで認識される数値書式によって異なります。したがって、コンマが桁区切り記号として使用されるロケールのユーザーであっても、書式では桁区切り記号としてピリオドを使用する必要があります。書式設定された文字列はロケールの正しい書式で表示されます。  <br/> |
|%  <br/> |パーセントのプレースホルダーです。式に 100 を掛けます。書式指定文字列の表示位置にパーセント記号 (%) が挿入されます。  <br/> |
|, (コンマ文字)  <br/> |桁区切り記号です。桁区切り記号は、整数部に 4 桁以上ある数値の百の位と千の位を区切ります。書式にある桁区切り記号が桁のプレースホルダー (0 または #) で囲まれている場合は、桁区切り記号の標準使用が指定されます。  <br/> 小数部の指定の有無にかかわらず、小数点のすぐ左に桁区切り記号がある、または文字列の右端にある場合は、"数値を 1,000 で割って、必要に応じて丸める" ことを意味します。1,000 より小さく、500 以上の数値は 1 と表示され、500 より小さい数値は 0 と表示されます。この位置に 2 つの隣接する区切り記号がある場合は百万の因数でスケーリングし、桁区切り記号が 1 つ増えるごとにさらに 1,000 の因数でスケーリングします。  <br/> 小数点のすぐ左以外の位置、または文字列の右端の位置に複数の隣接する区切り記号がある場合は、通常の桁区切り記号を指定したものとして処理されます。ロケールによっては、桁区切り記号としてピリオドが使用されます。書式指定された出力で、実際に桁区切り記号として使用される記号は、システムで認識される数値書式によって異なります。したがって、桁区切り記号としてピリオドが使用されるロケールのユーザーであっても、書式で桁区切り記号としてコンマを使用する必要があります。書式設定された文字列は、ロケールの正しい形式で表示されます。  <br/> たとえば、次の 3 つの書式文字列を考えてみます。  <br/> "#,0." は、桁区切り記号を使用して、1 億を文字列 "100,000,000" として書式設定します。  <br/> "#0,." は、1,000 の因数によるスケーリングを使用して、1 億を文字列 "100000" として書式設定します。  <br/> "#,0,." は、桁区切り記号と 1,000 の因数によるスケーリングを使用して、1 億を文字列 "100,000" として書式設定します。  <br/> |
|: (コロン文字)  <br/> |時刻区切り文字。一部のロケールでは、時刻区切り文字を表す目的で他の文字が使用されることがあります。時刻の値が書式設定されるときに、時刻区切り文字によって時、分、および秒が区切られます。書式設定された出力で時刻区切り文字として使用される実際の文字は、システム設定によって決まります。  <br/> |
|/ (スラッシュ)  <br/> |日付の区切り記号。ロケールによっては、他の文字が日付の区切り記号として表示される場合があります。日付値の書式が設定されている場合、日付、月、および年は、日付の区切り記号によって区切られます。書式設定された出力で、日付の区切り文字として実際に使用される文字は、システム設定によって決まります。  <br/> |
|**E-、E+、e-、e+** <br/> |指数形式。書式指定式で、E-、E+、e-、または e+ の左に少なくとも 1 つの桁プレースホルダー (0 または #) がある場合、数値は、数値と指数部の間に E または e を挿入して指数形式で表示されます。左にある桁プレースホルダーの数で、指数の桁数が決まります。負の指数にマイナス記号を挿入するには、E- または e- を使用します。負の指数にマイナス記号を入れて、正の指数にプラス記号を入れるには、E+ または e+ を使用します。正しい書式を得るには、この記号の右に桁プレースホルダーを挿入する必要があります。  <br/> |
|**- + $ ( )** <br/> |リテラル文字です。これらの文字は書式文字列に入力したとおりに表示されます。これ以外の文字をリテラルとして表示するには、その文字の前に円記号 (\)) を付けるか、または二重引用符記号 (" ") で囲みます。  <br/> |
|\ (円記号)  <br/> |書式指定文字列内の次の文字を表示します。特殊な意味を持つ文字をリテラル文字として表示するには、その文字の前に円記号 (\)) を付けます。円記号自体は表示されません。円記号を使用するのは、その文字を二重引用符記号で囲むことと同じです。円記号自体を表示するには、円記号を 2 つ (\\) 使用します。<br/> リテラル文字として表示できない文字には次のような文字があります。日付書式文字および時刻書式文字 (a、c、d、h、m、n、p、q、s、t、w、y、/、および :)、数値書式文字 (#、0、%、E、e、コンマ、およびピリオド)、および文字列書式文字 (@、&amp;、\<, \>、および !)。  <br/> |
|"ABC"  <br/> |二重引用符 (" ") で囲まれた文字列を表示します。コード内の style 引数に文字列を含めるには、Chr(34) を使ってテキストを囲みます (34 は引用符 (") を表す文字コードです)。  <br/> |
   
次の表には、数値のサンプルの書式指定式が含まれています (これらのすべての例では、システムのロケールが English-U.S. であることを想定しています)。最初の列には Format 関数の書式文字列が含まれています。別の列には、書式設定されたデータに列見出しの値がある場合の結果の出力が含まれています。
  
|**書式設定 (スタイル)**|**"5" の書式設定**|**"-5" の書式設定**|**"0.5" の書式設定**|**"0" の書式設定**|
|:-----|:-----|:-----|:-----|:-----|
|長さ 0 の文字列 ("")  <br/> |5  <br/> |-5  <br/> |0.5  <br/> |0  <br/> |
|0  <br/> |5  <br/> |-5  <br/> |1  <br/> |0  <br/> |
|0.00  <br/> |5.00  <br/> |-5.00  <br/> |0.50  <br/> |0.00  <br/> |
|#,##0  <br/> |5  <br/> |-5  <br/> |1  <br/> |0  <br/> |
|$#,##0;($#,##0)  <br/> |$5  <br/> |($5)  <br/> |$1  <br/> |$0  <br/> |
|$#,##0.00;($#,##0.00)  <br/> |$5.00  <br/> |($5.00)  <br/> |$0.50  <br/> |$0.00  <br/> |
|0%  <br/> |500%  <br/> |-500%  <br/> |50%  <br/> |0%  <br/> |
|0.00%  <br/> |500.00%  <br/> |-500.00%  <br/> |50.00%  <br/> |0.00%  <br/> |
|0.00E+00  <br/> |5.00E+00  <br/> |-5.00E+00  <br/> |5.00E-01  <br/> |0.00E+00  <br/> |
|0.00E-00  <br/> |5.00E00  <br/> |-5.00E00  <br/> |5.00E-01  <br/> |0.00E00  <br/> |
|"$#,##0;;\Z\e\r\o"  <br/> |$5  <br/> |$-5  <br/> |$1  <br/> |ゼロ  <br/> |
   
## <a name="remarks"></a>解説
<a name="bk_addresources"> </a>

間に何も入れずに複数のセミコロンを含めた場合、欠けているセクションは正の値の書式を使用して表示されます。
  
## <a name="see-also"></a>関連項目

- [Format 関数 (Access カスタム Web アプリ)](format-function-access-custom-web-app.md) 
- [Format 関数 (カスタム web アプリケーションのアクセス) のユーザー設定の日付と時刻の書式を設定します。](custom-date-and-time-formats-for-the-format-function-access-custom-web-app.md)
  

